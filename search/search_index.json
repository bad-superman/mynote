{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs help</code> - Print this help message.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"wiki/%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84wiki%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/","title":"\u642d\u5efa\u81ea\u5df1\u7684wiki\u77e5\u8bc6\u7ba1\u7406\u7cfb\u7edf","text":"<p>\u6700\u8fd1\u5728\u7f51\u4e0a\u770b\u5230\u4f7f\u7528mkdoc + git\u53ef\u4ee5\u642d\u5efa\u81ea\u5df1wiki\uff0c\u8bd5\u4e86\u8bd5\u53ef\u4ee5\uff0c\u8fd8\u514d\u8d39\uff0c\u4f60\u8bf4\u8bf4\u6c14\u4eba\u4e0d \u5e02\u9762\u4e0a\u4e5f\u6709\u5f88\u591a\u5176\u4ed6\u5f00\u6e90\u7684wiki\u7cfb\u7edf 1. \u5927\u540d\u9f0e\u9f0e\u7684MediaWiki 2. \u5c0f\u5de7\u6613\u7528\u7684DokuWiki 3. \u56fd\u5185\u5f00\u6e90\u7684minDoc 4. Gitbook 5. Docsify 6. Hexo 7. MkDocs </p> <p>\u5c0f\u7f16\u9009\u62e9\u4f7f\u7528\u7684\u662fMkDocs\uff0c\u56e0\u4e3a\u5b83\u90e8\u7f72\u548c\u4f7f\u7528\u90fd\u975e\u5e38\u7684\u7b80\u4fbf\uff0c\u7279\u522b\u9002\u5408\u4f5c\u4e3a\u4e2a\u4ebawiki\u77e5\u8bc6\u7ba1\u7406\u7cfb\u7edf\u3002\u7b80\u5355\u7684\u8bf4MkDocs\u5c31\u662f\u5c06Markdown\u6587\u4ef6\u8f6c\u6362\u6210\u9759\u6001\u7684HTML\u7f51\u7ad9\uff0c\u7136\u540e\u65e2\u53ef\u4ee5\u5728\u672c\u5730\u76f4\u63a5\u8bbf\u95ee\uff0c\u4e5f\u53ef\u4ee5\u6258\u7ba1\u5230\u670d\u52a1\u5668\u6216\u8005GitHub\u3002</p> <p>\u5b9e\u6218\u5f00\u59cb</p>"},{"location":"wiki/%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84wiki%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/#1mkdocs","title":"1.\u5b89\u88c5MkDocs","text":"<p>\u4f7f\u7528pip\u5b89\u88c5</p> <pre><code>pip install --upgrade pip\npip install mkdocs\n</code></pre> <p>\u9a8c\u8bc1\u662f\u5426\u5b89\u88c5\u6210\u529f</p> <pre><code>mkdocs --version\n</code></pre>"},{"location":"wiki/%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84wiki%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/#2wiki","title":"2.\u521b\u5efa\u4e00\u4e2awiki","text":"<pre><code>mkdocs new my-wiki\ncd my-wiki\n</code></pre> <p>\u521b\u5efa\u6210\u529f\u540e\uff0c\u5982\u4e0b\u56fe   docs\u6587\u4ef6\u5939\u4e0b\u653e\u7740\u6211\u4eec\u81ea\u5df1\u5199\u7684MarkDown\u6587\u7ae0\uff0c\u9ed8\u8ba4\u751f\u6210index.md  mkdocs.yml\u662fwiki\u7f51\u7ad9\u7684\u914d\u7f6e\u6587\u4ef6\uff08\u4e3b\u9898\u3001\u76ee\u5f55\u3001\u8bed\u8a00\u7b49\uff09  </p>"},{"location":"wiki/%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84wiki%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/#3wiki","title":"3.\u9884\u89c8wiki","text":"<ul> <li>\u9996\u5148\u542f\u52a8mkdocs\u670d\u52a1</li> </ul> <pre><code>mkdocs serve\n</code></pre> <ul> <li>\u7136\u540e\u6253\u5f00\u6d4f\u89c8\u5668\u8f93\u5165127.0.0.1:8000\u8bbf\u95eewiki \u5982\u679c\u4ee5\u4e0a\u6b65\u9aa4\u90fd\u6267\u884c\u6210\u529f\uff0c\u4f60\u5c06\u770b\u5230\u5982\u4e0b\u754c\u9762\uff1a </li> </ul>"},{"location":"wiki/%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84wiki%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/#4","title":"4.\u66f4\u6362\u4e3b\u9898","text":"<p>mkdocs\u6709\u591a\u4e2a\u4e3b\u9898\u53ef\u4f9b\u9009\u62e9\uff0c\u4ee5\u6ee1\u8db3\u4e0d\u7528\u7528\u6237\u7684\u559c\u597d\uff0c\u5728\u6b64\u5c0f\u7f16\u5411\u5927\u5bb6\u63a8\u8350Material\u4e3b\u9898\u3002</p> <ul> <li>\u5b89\u88c5Material\u4e3b\u9898</li> </ul> <pre><code>pip install mkdocs-material\n</code></pre> <ul> <li>\u914d\u7f6ewiki\u4f7f\u7528Material\u4e3b\u9898</li> </ul> <pre><code>theme:\n  name: 'material'\n</code></pre>"},{"location":"wiki/%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84wiki%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/#5wikigithub","title":"5.\u5c06\u4f60\u7684wiki\u7ad9\u70b9\u6258\u7ba1\u5230GitHub","text":"<ul> <li>\u521b\u5efa\u4e00\u4e2a\u65b0\u4ed3\u5e93\u3002 \u6bd4\u5982: https://github.com/user_name/repository_name  </li> <li>\u521d\u59cb\u5316\u4f60\u7684\u672c\u5730\u4ed3\u5e93\uff08wiki\uff09, \u6dfb\u52a0\u8fdc\u7a0b\u4ed3\u5e93\uff0c\u63d0\u4ea4\u672c\u5730\u4fee\u6539\u5e76\u63a8\u9001\u5230\u8fdc\u7a0b\u4ed3\u5e93  </li> </ul> <pre><code>cd my-wiki\ngit init\ngit add remote https://github.com/user_name/repository_name\ngit add .\ngit commit -m \"first commit\"\ngit push origin master\n</code></pre> <ul> <li>\u90e8\u7f72\u4f60\u7684wiki\u7ad9\u70b9</li> </ul> <pre><code>mkdocs gh-deploy\n</code></pre> <p>\u73b0\u5728\u4f60\u7684wiki\u7ad9\u70b9\uff08HTML\u6587\u4ef6\uff09\u5728gh-pages\u5206\u652f\uff0c\u4f60\u7684wiki\u7ad9\u70b9\uff08markdown\u6587\u4ef6\uff09\u5728master\u5206\u652f\u3002  </p> <p>\u8be5\u547d\u4ee4\u6267\u884c\u4e86\u4e24\u4e2a\u52a8\u4f5c\uff1a 1. \u5c06Mardown\u6587\u4ef6\u8f6c\u4e3a\u9759\u6001HTML\u7f51\u9875\u6587\u4ef6 2. \u5c06\u6240\u6709\u7684\u9759\u6001HTML\u7f51\u9875\u6587\u4ef6\u90fd\u63a8\u9001\u5230\u8fdc\u7a0b\u4ed3\u5e93\u7684gh-pages\u5206\u652f  </p> <p>GitHub\u4f1a\u81ea\u52a8\u7ba1\u7406gh-pages\u5206\u652f\u7684\u9759\u6001\u7f51\u9875\uff0c\u5c31\u76f8\u5f53\u4e8e\u4e00\u4e2a\u9759\u6001\u7f51\u7ad9\u670d\u52a1\u5668\u3002</p> <ul> <li>\u901a\u8fc7\u4ee5\u4e0b\u7f51\u5740\u8bbf\u95ee\u4f60\u7684wiki</li> </ul> <pre><code>https://user_name.github.io/repository_name\n</code></pre>"},{"location":"wiki/Golang/Render/","title":"Render","text":""},{"location":"wiki/Golang/Render/#render","title":"Render\u4e91\u5e73\u53f0","text":"<p>render</p> <ul> <li>\u4e91\u670d\u52a1\u3001\u4e91\u90e8\u7f72</li> <li>\u6709\u514d\u8d39\u7248</li> </ul>"},{"location":"wiki/Golang/gin/","title":"Gin","text":""},{"location":"wiki/Golang/gin/#gin-web-fromwork","title":"Gin Web Fromwork","text":"<p>\u6587\u6863</p>"},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/","title":"\u2708\ufe0f Go\u6cdb\u578b\u4e3b\u8981\u7528\u6cd5","text":"<p>Go \u8bed\u8a00\u5728 1.18 \u7248\u672c\u6b63\u5f0f\u5f15\u5165\u4e86\u6cdb\u578b\u3002\u4ee5\u4e0b\u662f Go \u6cdb\u578b\u7684\u4e3b\u8981\u7528\u6cd5\uff1a</p>"},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#1","title":"1. \u57fa\u672c\u8bed\u6cd5","text":""},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#_1","title":"\u7c7b\u578b\u53c2\u6570","text":"<pre><code>// \u6cdb\u578b\u51fd\u6570\nfunc Print[T any](value T) {\n    fmt.Println(value)\n}\n\n// \u4f7f\u7528\nPrint[int](42)\nPrint(\"hello\")  // \u7c7b\u578b\u63a8\u65ad\n</code></pre>"},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#2","title":"2. \u7c7b\u578b\u7ea6\u675f","text":""},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#_2","title":"\u4f7f\u7528\u63a5\u53e3\u4f5c\u4e3a\u7ea6\u675f","text":"<pre><code>// \u5b9a\u4e49\u7ea6\u675f\ntype Number interface {\n    int | int64 | float32 | float64\n}\n\n// \u4f7f\u7528\u7ea6\u675f\nfunc Add[T Number](a, b T) T {\n    return a + b\n}\n\n// \u4e5f\u53ef\u4ee5\u4f7f\u7528\u9884\u5b9a\u4e49\u7ea6\u675f\nfunc Max[T constraints.Ordered](a, b T) T {\n    if a &gt; b {\n        return a\n    }\n    return b\n}\n</code></pre>"},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#3","title":"3. \u6cdb\u578b\u7c7b\u578b","text":""},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#_3","title":"\u6cdb\u578b\u7ed3\u6784\u4f53","text":"<pre><code>// \u6808\u7684\u5b9e\u73b0\ntype Stack[T any] struct {\n    items []T\n}\n\nfunc (s *Stack[T]) Push(item T) {\n    s.items = append(s.items, item)\n}\n\nfunc (s *Stack[T]) Pop() T {\n    if len(s.items) == 0 {\n        var zero T\n        return zero\n    }\n    item := s.items[len(s.items)-1]\n    s.items = s.items[:len(s.items)-1]\n    return item\n}\n\n// \u4f7f\u7528\nvar stack Stack[int]\nstack.Push(10)\nval := stack.Pop()\n</code></pre>"},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#4","title":"4. \u5e38\u7528\u7684\u5185\u7f6e\u7ea6\u675f","text":"<pre><code>import \"golang.org/x/exp/constraints\"\n\n// constraints \u5305\u63d0\u4f9b\u4e86\u5e38\u7528\u7ea6\u675f\nfunc Min[T constraints.Ordered](a, b T) T {\n    if a &lt; b {\n        return a\n    }\n    return b\n}\n\n// comparable \u7ea6\u675f\uff08\u53ef\u7528\u4e8e == \u548c != \u64cd\u4f5c\uff09\nfunc Contains[T comparable](slice []T, target T) bool {\n    for _, v := range slice {\n        if v == target {\n            return true\n        }\n    }\n    return false\n}\n</code></pre>"},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#5","title":"5. \u65b9\u6cd5\u7ea6\u675f","text":"<pre><code>// \u63a5\u53e3\u7ea6\u675f\u53ef\u4ee5\u5305\u542b\u65b9\u6cd5\ntype Stringer interface {\n    String() string\n}\n\nfunc PrintString[T Stringer](value T) {\n    fmt.Println(value.String())\n}\n</code></pre>"},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#6","title":"6. ~ \u7b26\u53f7\uff08\u5e95\u5c42\u7c7b\u578b\u7ea6\u675f\uff09","text":"<pre><code>type MyInt int\n\ntype Int interface {\n    ~int | ~int32 | ~int64  // ~ \u8868\u793a\u5305\u62ec\u5e95\u5c42\u7c7b\u578b\u4e3a int \u7684\u7c7b\u578b\n}\n\nfunc Process[T Int](value T) {\n    // \u53ef\u4ee5\u63a5\u53d7 MyInt \u7c7b\u578b\n}\n</code></pre>"},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#7","title":"7. \u591a\u4e2a\u7c7b\u578b\u53c2\u6570","text":"<pre><code>// \u591a\u4e2a\u7c7b\u578b\u53c2\u6570\nfunc Pair[K comparable, V any](key K, value V) map[K]V {\n    return map[K]V{key: value}\n}\n\n// \u4f7f\u7528\nresult := Pair[string, int](\"age\", 25)\n</code></pre>"},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#8","title":"8. \u5b9e\u9645\u5e94\u7528\u793a\u4f8b","text":""},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#_4","title":"\u6570\u636e\u5904\u7406","text":"<pre><code>// \u8fc7\u6ee4\u5207\u7247\nfunc Filter[T any](slice []T, predicate func(T) bool) []T {\n    var result []T\n    for _, v := range slice {\n        if predicate(v) {\n            result = append(result, v)\n        }\n    }\n    return result\n}\n\n// \u4f7f\u7528\nnumbers := []int{1, 2, 3, 4, 5}\neven := Filter(numbers, func(n int) bool {\n    return n%2 == 0\n})\n</code></pre>"},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#_5","title":"\u6cdb\u578b\u5bb9\u5668","text":"<pre><code>// \u6cdb\u578b\u94fe\u8868\u8282\u70b9\ntype Node[T any] struct {\n    Value T\n    Next  *Node[T]\n}\n\n// \u961f\u5217\ntype Queue[T any] struct {\n    head, tail *Node[T]\n}\n\nfunc (q *Queue[T]) Enqueue(value T) {\n    node := &amp;Node[T]{Value: value}\n    if q.tail == nil {\n        q.head = node\n        q.tail = node\n    } else {\n        q.tail.Next = node\n        q.tail = node\n    }\n}\n</code></pre>"},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#9","title":"9. \u6ce8\u610f\u4e8b\u9879","text":"<ol> <li> <p>\u6027\u80fd\uff1aGo \u6cdb\u578b\u5728\u7f16\u8bd1\u65f6\u8fdb\u884c\u5355\u6001\u5316\uff0c\u6027\u80fd\u63a5\u8fd1\u624b\u52a8\u5b9e\u73b0\u7684\u7c7b\u578b\u7279\u5b9a\u7248\u672c</p> </li> <li> <p>\u9650\u5236\uff1a</p> <ul> <li> <p>\u4e0d\u80fd\u6709\u6cdb\u578b\u65b9\u6cd5\uff08\u53ea\u80fd\u6709\u6cdb\u578b\u7c7b\u578b\u7684\u65b9\u6cd5\uff09</p> </li> <li> <p>\u7c7b\u578b\u53c2\u6570\u4e0d\u80fd\u7528\u4e8e\u65b9\u6cd5\u63a5\u6536\u5668</p> </li> <li> <p>\u4e0d\u80fd\u58f0\u660e\u65b0\u7684\u7c7b\u578b\u53c2\u6570\u4f5c\u4e3a\u65b9\u6cd5\u53c2\u6570</p> </li> </ul> </li> </ol>"},{"location":"wiki/Golang/%E2%9C%88%EF%B8%8F%20Go%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#10","title":"10. \u5b9e\u7528\u6280\u5de7","text":"<pre><code>// \u7c7b\u578b\u63a8\u65ad\u7b80\u5316\u8c03\u7528\nfunc ConvertSlice[T1, T2 any](slice []T1, converter func(T1) T2) []T2 {\n    result := make([]T2, len(slice))\n    for i, v := range slice {\n        result[i] = converter(v)\n    }\n    return result\n}\n\n// \u7ec4\u5408\u7ea6\u675f\ntype Numeric interface {\n    constraints.Integer | constraints.Float\n}\n\nfunc Sum[T Numeric](slice []T) T {\n    var sum T\n    for _, v := range slice {\n        sum += v\n    }\n    return sum\n}\n</code></pre>"},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/","title":"\u65e0\u6807\u9898\u7b14\u8bb0","text":"<p>Go \u8bed\u8a00\u5728 1.18 \u7248\u672c\u6b63\u5f0f\u5f15\u5165\u4e86\u6cdb\u578b\u3002\u4ee5\u4e0b\u662f Go \u6cdb\u578b\u7684\u4e3b\u8981\u7528\u6cd5\uff1a</p>"},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#1","title":"1. \u57fa\u672c\u8bed\u6cd5","text":""},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#_1","title":"\u7c7b\u578b\u53c2\u6570","text":"<pre><code>// \u6cdb\u578b\u51fd\u6570\nfunc Print[T any](value T) {\n    fmt.Println(value)\n}\n\n// \u4f7f\u7528\nPrint[int](42)\nPrint(\"hello\")  // \u7c7b\u578b\u63a8\u65ad\n</code></pre>"},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#2","title":"2. \u7c7b\u578b\u7ea6\u675f","text":""},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#_2","title":"\u4f7f\u7528\u63a5\u53e3\u4f5c\u4e3a\u7ea6\u675f","text":"<pre><code>// \u5b9a\u4e49\u7ea6\u675f\ntype Number interface {\n    int | int64 | float32 | float64\n}\n\n// \u4f7f\u7528\u7ea6\u675f\nfunc Add[T Number](a, b T) T {\n    return a + b\n}\n\n// \u4e5f\u53ef\u4ee5\u4f7f\u7528\u9884\u5b9a\u4e49\u7ea6\u675f\nfunc Max[T constraints.Ordered](a, b T) T {\n    if a &gt; b {\n        return a\n    }\n    return b\n}\n</code></pre>"},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#3","title":"3. \u6cdb\u578b\u7c7b\u578b","text":""},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#_3","title":"\u6cdb\u578b\u7ed3\u6784\u4f53","text":"<pre><code>// \u6808\u7684\u5b9e\u73b0\ntype Stack[T any] struct {\n    items []T\n}\n\nfunc (s *Stack[T]) Push(item T) {\n    s.items = append(s.items, item)\n}\n\nfunc (s *Stack[T]) Pop() T {\n    if len(s.items) == 0 {\n        var zero T\n        return zero\n    }\n    item := s.items[len(s.items)-1]\n    s.items = s.items[:len(s.items)-1]\n    return item\n}\n\n// \u4f7f\u7528\nvar stack Stack[int]\nstack.Push(10)\nval := stack.Pop()\n</code></pre>"},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#4","title":"4. \u5e38\u7528\u7684\u5185\u7f6e\u7ea6\u675f","text":"<pre><code>import \"golang.org/x/exp/constraints\"\n\n// constraints \u5305\u63d0\u4f9b\u4e86\u5e38\u7528\u7ea6\u675f\nfunc Min[T constraints.Ordered](a, b T) T {\n    if a &lt; b {\n        return a\n    }\n    return b\n}\n\n// comparable \u7ea6\u675f\uff08\u53ef\u7528\u4e8e == \u548c != \u64cd\u4f5c\uff09\nfunc Contains[T comparable](slice []T, target T) bool {\n    for _, v := range slice {\n        if v == target {\n            return true\n        }\n    }\n    return false\n}\n</code></pre>"},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#5","title":"5. \u65b9\u6cd5\u7ea6\u675f","text":"<pre><code>// \u63a5\u53e3\u7ea6\u675f\u53ef\u4ee5\u5305\u542b\u65b9\u6cd5\ntype Stringer interface {\n    String() string\n}\n\nfunc PrintString[T Stringer](value T) {\n    fmt.Println(value.String())\n}\n</code></pre>"},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#6","title":"6. ~ \u7b26\u53f7\uff08\u5e95\u5c42\u7c7b\u578b\u7ea6\u675f\uff09","text":"<pre><code>type MyInt int\n\ntype Int interface {\n    ~int | ~int32 | ~int64  // ~ \u8868\u793a\u5305\u62ec\u5e95\u5c42\u7c7b\u578b\u4e3a int \u7684\u7c7b\u578b\n}\n\nfunc Process[T Int](value T) {\n    // \u53ef\u4ee5\u63a5\u53d7 MyInt \u7c7b\u578b\n}\n</code></pre>"},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#7","title":"7. \u591a\u4e2a\u7c7b\u578b\u53c2\u6570","text":"<pre><code>// \u591a\u4e2a\u7c7b\u578b\u53c2\u6570\nfunc Pair[K comparable, V any](key K, value V) map[K]V {\n    return map[K]V{key: value}\n}\n\n// \u4f7f\u7528\nresult := Pair[string, int](\"age\", 25)\n</code></pre>"},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#8","title":"8. \u5b9e\u9645\u5e94\u7528\u793a\u4f8b","text":""},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#_4","title":"\u6570\u636e\u5904\u7406","text":"<pre><code>// \u8fc7\u6ee4\u5207\u7247\nfunc Filter[T any](slice []T, predicate func(T) bool) []T {\n    var result []T\n    for _, v := range slice {\n        if predicate(v) {\n            result = append(result, v)\n        }\n    }\n    return result\n}\n\n// \u4f7f\u7528\nnumbers := []int{1, 2, 3, 4, 5}\neven := Filter(numbers, func(n int) bool {\n    return n%2 == 0\n})\n</code></pre>"},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#_5","title":"\u6cdb\u578b\u5bb9\u5668","text":"<pre><code>// \u6cdb\u578b\u94fe\u8868\u8282\u70b9\ntype Node[T any] struct {\n    Value T\n    Next  *Node[T]\n}\n\n// \u961f\u5217\ntype Queue[T any] struct {\n    head, tail *Node[T]\n}\n\nfunc (q *Queue[T]) Enqueue(value T) {\n    node := &amp;Node[T]{Value: value}\n    if q.tail == nil {\n        q.head = node\n        q.tail = node\n    } else {\n        q.tail.Next = node\n        q.tail = node\n    }\n}\n</code></pre>"},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#9","title":"9. \u6ce8\u610f\u4e8b\u9879","text":"<ol> <li> <p>\u6027\u80fd\uff1aGo \u6cdb\u578b\u5728\u7f16\u8bd1\u65f6\u8fdb\u884c\u5355\u6001\u5316\uff0c\u6027\u80fd\u63a5\u8fd1\u624b\u52a8\u5b9e\u73b0\u7684\u7c7b\u578b\u7279\u5b9a\u7248\u672c</p> </li> <li> <p>\u9650\u5236\uff1a</p> <ul> <li> <p>\u4e0d\u80fd\u6709\u6cdb\u578b\u65b9\u6cd5\uff08\u53ea\u80fd\u6709\u6cdb\u578b\u7c7b\u578b\u7684\u65b9\u6cd5\uff09</p> </li> <li> <p>\u7c7b\u578b\u53c2\u6570\u4e0d\u80fd\u7528\u4e8e\u65b9\u6cd5\u63a5\u6536\u5668</p> </li> <li> <p>\u4e0d\u80fd\u58f0\u660e\u65b0\u7684\u7c7b\u578b\u53c2\u6570\u4f5c\u4e3a\u65b9\u6cd5\u53c2\u6570</p> </li> </ul> </li> </ol>"},{"location":"wiki/Golang/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#10","title":"10. \u5b9e\u7528\u6280\u5de7","text":"<pre><code>// \u7c7b\u578b\u63a8\u65ad\u7b80\u5316\u8c03\u7528\nfunc ConvertSlice[T1, T2 any](slice []T1, converter func(T1) T2) []T2 {\n    result := make([]T2, len(slice))\n    for i, v := range slice {\n        result[i] = converter(v)\n    }\n    return result\n}\n\n// \u7ec4\u5408\u7ea6\u675f\ntype Numeric interface {\n    constraints.Integer | constraints.Float\n}\n\nfunc Sum[T Numeric](slice []T) T {\n    var sum T\n    for _, v := range slice {\n        sum += v\n    }\n    return sum\n}\n</code></pre>"},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/","title":"\u6cdb\u578b\u4e3b\u8981\u7528\u6cd5","text":"<p>Go \u8bed\u8a00\u5728 1.18 \u7248\u672c\u6b63\u5f0f\u5f15\u5165\u4e86\u6cdb\u578b\u3002\u4ee5\u4e0b\u662f Go \u6cdb\u578b\u7684\u4e3b\u8981\u7528\u6cd5\uff1a</p>"},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#1","title":"1. \u57fa\u672c\u8bed\u6cd5","text":""},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#_1","title":"\u7c7b\u578b\u53c2\u6570","text":"<pre><code>// \u6cdb\u578b\u51fd\u6570\nfunc Print[T any](value T) {\n    fmt.Println(value)\n}\n\n// \u4f7f\u7528\nPrint[int](42)\nPrint(\"hello\")  // \u7c7b\u578b\u63a8\u65ad\n</code></pre>"},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#2","title":"2. \u7c7b\u578b\u7ea6\u675f","text":""},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#_2","title":"\u4f7f\u7528\u63a5\u53e3\u4f5c\u4e3a\u7ea6\u675f","text":"<pre><code>// \u5b9a\u4e49\u7ea6\u675f\ntype Number interface {\n    int | int64 | float32 | float64\n}\n\n// \u4f7f\u7528\u7ea6\u675f\nfunc Add[T Number](a, b T) T {\n    return a + b\n}\n\n// \u4e5f\u53ef\u4ee5\u4f7f\u7528\u9884\u5b9a\u4e49\u7ea6\u675f\nfunc Max[T constraints.Ordered](a, b T) T {\n    if a &gt; b {\n        return a\n    }\n    return b\n}\n</code></pre>"},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#3","title":"3. \u6cdb\u578b\u7c7b\u578b","text":""},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#_3","title":"\u6cdb\u578b\u7ed3\u6784\u4f53","text":"<pre><code>// \u6808\u7684\u5b9e\u73b0\ntype Stack[T any] struct {\n    items []T\n}\n\nfunc (s *Stack[T]) Push(item T) {\n    s.items = append(s.items, item)\n}\n\nfunc (s *Stack[T]) Pop() T {\n    if len(s.items) == 0 {\n        var zero T\n        return zero\n    }\n    item := s.items[len(s.items)-1]\n    s.items = s.items[:len(s.items)-1]\n    return item\n}\n\n// \u4f7f\u7528\nvar stack Stack[int]\nstack.Push(10)\nval := stack.Pop()\n</code></pre>"},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#4","title":"4. \u5e38\u7528\u7684\u5185\u7f6e\u7ea6\u675f","text":"<pre><code>import \"golang.org/x/exp/constraints\"\n\n// constraints \u5305\u63d0\u4f9b\u4e86\u5e38\u7528\u7ea6\u675f\nfunc Min[T constraints.Ordered](a, b T) T {\n    if a &lt; b {\n        return a\n    }\n    return b\n}\n\n// comparable \u7ea6\u675f\uff08\u53ef\u7528\u4e8e == \u548c != \u64cd\u4f5c\uff09\nfunc Contains[T comparable](slice []T, target T) bool {\n    for _, v := range slice {\n        if v == target {\n            return true\n        }\n    }\n    return false\n}\n</code></pre>"},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#5","title":"5. \u65b9\u6cd5\u7ea6\u675f","text":"<pre><code>// \u63a5\u53e3\u7ea6\u675f\u53ef\u4ee5\u5305\u542b\u65b9\u6cd5\ntype Stringer interface {\n    String() string\n}\n\nfunc PrintString[T Stringer](value T) {\n    fmt.Println(value.String())\n}\n</code></pre>"},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#6","title":"6. ~ \u7b26\u53f7\uff08\u5e95\u5c42\u7c7b\u578b\u7ea6\u675f\uff09","text":"<pre><code>type MyInt int\n\ntype Int interface {\n    ~int | ~int32 | ~int64  // ~ \u8868\u793a\u5305\u62ec\u5e95\u5c42\u7c7b\u578b\u4e3a int \u7684\u7c7b\u578b\n}\n\nfunc Process[T Int](value T) {\n    // \u53ef\u4ee5\u63a5\u53d7 MyInt \u7c7b\u578b\n}\n</code></pre>"},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#7","title":"7. \u591a\u4e2a\u7c7b\u578b\u53c2\u6570","text":"<pre><code>// \u591a\u4e2a\u7c7b\u578b\u53c2\u6570\nfunc Pair[K comparable, V any](key K, value V) map[K]V {\n    return map[K]V{key: value}\n}\n\n// \u4f7f\u7528\nresult := Pair[string, int](\"age\", 25)\n</code></pre>"},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#8","title":"8. \u5b9e\u9645\u5e94\u7528\u793a\u4f8b","text":""},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#_4","title":"\u6570\u636e\u5904\u7406","text":"<pre><code>// \u8fc7\u6ee4\u5207\u7247\nfunc Filter[T any](slice []T, predicate func(T) bool) []T {\n    var result []T\n    for _, v := range slice {\n        if predicate(v) {\n            result = append(result, v)\n        }\n    }\n    return result\n}\n\n// \u4f7f\u7528\nnumbers := []int{1, 2, 3, 4, 5}\neven := Filter(numbers, func(n int) bool {\n    return n%2 == 0\n})\n</code></pre>"},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#_5","title":"\u6cdb\u578b\u5bb9\u5668","text":"<pre><code>// \u6cdb\u578b\u94fe\u8868\u8282\u70b9\ntype Node[T any] struct {\n    Value T\n    Next  *Node[T]\n}\n\n// \u961f\u5217\ntype Queue[T any] struct {\n    head, tail *Node[T]\n}\n\nfunc (q *Queue[T]) Enqueue(value T) {\n    node := &amp;Node[T]{Value: value}\n    if q.tail == nil {\n        q.head = node\n        q.tail = node\n    } else {\n        q.tail.Next = node\n        q.tail = node\n    }\n}\n</code></pre>"},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#9","title":"9. \u6ce8\u610f\u4e8b\u9879","text":"<ol> <li> <p>\u6027\u80fd\uff1aGo \u6cdb\u578b\u5728\u7f16\u8bd1\u65f6\u8fdb\u884c\u5355\u6001\u5316\uff0c\u6027\u80fd\u63a5\u8fd1\u624b\u52a8\u5b9e\u73b0\u7684\u7c7b\u578b\u7279\u5b9a\u7248\u672c</p> </li> <li> <p>\u9650\u5236\uff1a</p> <ul> <li> <p>\u4e0d\u80fd\u6709\u6cdb\u578b\u65b9\u6cd5\uff08\u53ea\u80fd\u6709\u6cdb\u578b\u7c7b\u578b\u7684\u65b9\u6cd5\uff09</p> </li> <li> <p>\u7c7b\u578b\u53c2\u6570\u4e0d\u80fd\u7528\u4e8e\u65b9\u6cd5\u63a5\u6536\u5668</p> </li> <li> <p>\u4e0d\u80fd\u58f0\u660e\u65b0\u7684\u7c7b\u578b\u53c2\u6570\u4f5c\u4e3a\u65b9\u6cd5\u53c2\u6570</p> </li> </ul> </li> </ol>"},{"location":"wiki/Golang/%E6%B3%9B%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%94%A8%E6%B3%95/#10","title":"10. \u5b9e\u7528\u6280\u5de7","text":"<pre><code>// \u7c7b\u578b\u63a8\u65ad\u7b80\u5316\u8c03\u7528\nfunc ConvertSlice[T1, T2 any](slice []T1, converter func(T1) T2) []T2 {\n    result := make([]T2, len(slice))\n    for i, v := range slice {\n        result[i] = converter(v)\n    }\n    return result\n}\n\n// \u7ec4\u5408\u7ea6\u675f\ntype Numeric interface {\n    constraints.Integer | constraints.Float\n}\n\nfunc Sum[T Numeric](slice []T) T {\n    var sum T\n    for _, v := range slice {\n        sum += v\n    }\n    return sum\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/","title":"\ud83d\udce6 \u5b8c\u6574\u7684 <code>.proto</code> \u6587\u4ef6\u6700\u4f73\u5b9e\u8df5\u6a21\u677f","text":"<p>\u4ee5\u4e0b\u662f\u7ecf\u8fc7\u751f\u4ea7\u9a8c\u8bc1\u7684\u3001\u7b26\u5408\u73b0\u4ee3 gRPC/Protobuf \u5f00\u53d1\u6700\u4f73\u5b9e\u8df5\u7684\u5b8c\u6574\u6a21\u677f\uff1a</p>"},{"location":"wiki/Golang/Grpc/%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#_1","title":"\ud83c\udfd7\ufe0f \u5b8c\u6574\u9879\u76ee\u7ed3\u6784","text":"<pre><code>api/\n\u251c\u2500\u2500 buf.yaml                    # Buf \u914d\u7f6e\n\u251c\u2500\u2500 buf.gen.yaml               # \u4ee3\u7801\u751f\u6210\u914d\u7f6e\n\u251c\u2500\u2500 proto/\n\u2502   \u251c\u2500\u2500 google/               # \u5982\u679c\u9700\u8981\uff0c\u653e Google API \u7c7b\u578b\n\u2502   \u251c\u2500\u2500 v1/                   # \u7248\u672c\u5316\u76ee\u5f55\n\u2502   \u2502   \u251c\u2500\u2500 service/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 user_service.proto\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 order_service.proto\n\u2502   \u2502   \u251c\u2500\u2500 types/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 user.proto\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 common.proto\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 enums.proto\n\u2502   \u2502   \u2514\u2500\u2500 errors/\n\u2502   \u2502       \u2514\u2500\u2500 error.proto\n\u2502   \u2514\u2500\u2500 v2/                   # \u672a\u6765\u7248\u672c\n\u2514\u2500\u2500 gen/                      # \u751f\u6210\u7684\u4ee3\u7801\n    \u2514\u2500\u2500 go/\n</code></pre>"},{"location":"wiki/Golang/Grpc/%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#1-protov1serviceuser_serviceproto","title":"\ud83d\udcc4 1. \u4e3b\u670d\u52a1\u5b9a\u4e49\u6a21\u677f (<code>proto/v1/service/user_service.proto</code>)","text":"<pre><code>// \u6700\u4f73\u5b9e\u8df5\uff1a\u7248\u672c\u5316\u76ee\u5f55\u7ed3\u6784\nsyntax = \"proto3\";\n\n// \u5305\u540d\u91c7\u7528\u53cd\u5411\u57df\u540d+\u4ea7\u54c1+\u7248\u672c\npackage company.product.v1;\n\n// \u5bfc\u5165\u6807\u51c6\u7c7b\u578b\u548c\u672c\u5730\u7c7b\u578b\nimport \"google/protobuf/timestamp.proto\";\nimport \"google/protobuf/empty.proto\";\nimport \"google/protobuf/field_mask.proto\";\nimport \"google/api/annotations.proto\";  // \u7528\u4e8e REST \u7f51\u5173\nimport \"company/product/v1/types/user.proto\";\nimport \"company/product/v1/errors/error.proto\";\n\n// Go \u5305\u9009\u9879\uff08\u5fc5\u987b\uff09\noption go_package = \"github.com/company/product/gen/go/product/v1;productv1\";\n// \u591a\u4e2a\u8bed\u8a00\u7684\u547d\u540d\u7a7a\u95f4\noption java_multiple_files = true;\noption java_package = \"com.company.product.v1\";\noption java_outer_classname = \"UserServiceProto\";\n\n// C# \u547d\u540d\u7a7a\u95f4\noption csharp_namespace = \"Company.Product.V1\";\n\n// API \u6ce8\u91ca\uff08\u4f1a\u88ab\u5de5\u5177\u63d0\u53d6\u4e3a\u6587\u6863\uff09\noption (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_swagger) = {\n  info: {\n    title: \"User Service API\";\n    version: \"1.0.0\";\n    contact: {\n      name: \"Product Team\";\n      url: \"https://company.com\";\n      email: \"product@company.com\";\n    };\n    license: {\n      name: \"Business License\";\n      url: \"https://company.com/license\";\n    };\n  };\n  schemes: HTTPS;\n  consumes: \"application/json\";\n  produces: \"application/json\";\n  security_definitions: {\n    security: {\n      key: \"BearerAuth\";\n      value: {\n        type: TYPE_API_KEY;\n        in: IN_HEADER;\n        name: \"Authorization\";\n        description: \"Bearer token authentication\";\n      }\n    }\n  }\n};\n\n// \u670d\u52a1\u5b9a\u4e49\nservice UserService {\n  // \u7b80\u5355 CRUD \u64cd\u4f5c\n  rpc CreateUser(CreateUserRequest) returns (User) {\n    option (google.api.http) = {\n      post: \"/v1/users\"\n      body: \"*\"\n    };\n    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {\n      summary: \"Create a new user\"\n      description: \"Creates a new user in the system\"\n      tags: \"Users\"\n      security: {\n        security_requirement: {\n          key: \"BearerAuth\";\n          value: {};\n        }\n      }\n    };\n  }\n\n  rpc GetUser(GetUserRequest) returns (User) {\n    option (google.api.http) = {\n      get: \"/v1/users/{id}\"\n    };\n    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {\n      summary: \"Get user by ID\"\n      tags: \"Users\"\n    };\n  }\n\n  rpc UpdateUser(UpdateUserRequest) returns (User) {\n    option (google.api.http) = {\n      patch: \"/v1/users/{user.id}\"\n      body: \"*\"\n    };\n  }\n\n  rpc DeleteUser(DeleteUserRequest) returns (google.protobuf.Empty) {\n    option (google.api.http) = {\n      delete: \"/v1/users/{id}\"\n    };\n  }\n\n  // \u67e5\u8be2\u64cd\u4f5c\uff08\u5e26\u5206\u9875\u3001\u8fc7\u6ee4\u3001\u6392\u5e8f\uff09\n  rpc ListUsers(ListUsersRequest) returns (ListUsersResponse) {\n    option (google.api.http) = {\n      get: \"/v1/users\"\n    };\n  }\n\n  // \u6d41\u5f0f\u64cd\u4f5c\n  rpc BatchCreateUsers(stream CreateUserRequest) returns (BatchCreateUsersResponse) {\n    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {\n      summary: \"Batch create users (stream)\"\n      description: \"Accepts a stream of users to create in batch\"\n    };\n  }\n\n  rpc SearchUsers(SearchUsersRequest) returns (stream User) {\n    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {\n      summary: \"Search users with streaming response\"\n    };\n  }\n\n  // \u53cc\u5411\u6d41\uff08\u804a\u5929\u3001\u5b9e\u65f6\u66f4\u65b0\uff09\n  rpc UserChat(stream UserChatMessage) returns (stream UserChatMessage) {}\n}\n\n// \u8bf7\u6c42/\u54cd\u5e94\u6d88\u606f\u5b9a\u4e49\nmessage CreateUserRequest {\n  // \u4f7f\u7528\u5d4c\u5957\u6d88\u606f\u7ec4\u7ec7\u76f8\u5173\u5b57\u6bb5\n  User user = 1 [(validate.rules).message.required = true];\n  // \u6dfb\u52a0\u9a8c\u8bc1\u89c4\u5219\u6ce8\u91ca\uff08protoc-gen-validate\uff09\n  string request_id = 2 [\n    (validate.rules).string = {uuid: true},\n    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {\n      description: \"Unique request ID for idempotency\"\n      pattern: \"^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$\"\n    }\n  ];\n}\n\nmessage GetUserRequest {\n  // \u5b57\u6bb5\u6ce8\u91ca\u4f7f\u7528\u53cc\u659c\u7ebf\uff0c\u4f1a\u88ab\u63d0\u53d6\u5230\u6587\u6863\n  string id = 1 [\n    (validate.rules).string = {min_len: 1, max_len: 36},\n    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {\n      description: \"User UUID\"\n      example: \"\\\"550e8400-e29b-41d4-a716-446655440000\\\"\"\n    }\n  ];\n\n  // \u5b57\u6bb5\u63a9\u7801\uff0c\u7528\u4e8e\u6307\u5b9a\u8fd4\u56de\u54ea\u4e9b\u5b57\u6bb5\n  google.protobuf.FieldMask field_mask = 2;\n}\n\nmessage UpdateUserRequest {\n  User user = 1 [(validate.rules).message.required = true];\n  google.protobuf.FieldMask update_mask = 2;  // \u6307\u5b9a\u66f4\u65b0\u54ea\u4e9b\u5b57\u6bb5\n}\n\nmessage DeleteUserRequest {\n  string id = 1 [(validate.rules).string = {min_len: 1}];\n  // \u8f6f\u5220\u9664\u9009\u9879\n  bool force = 2;\n}\n\n// \u5206\u9875\u8bf7\u6c42\uff08\u6807\u51c6\u5316\uff09\nmessage ListUsersRequest {\n  // \u5206\u9875\u53c2\u6570\n  int32 page_size = 1 [\n    (validate.rules).int32 = {gte: 1, lte: 100},\n    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {\n      default: \"50\"\n    }\n  ];\n  string page_token = 2;  // \u7528\u4e8e\u7ee7\u7eed\u5206\u9875\u7684\u4ee4\u724c\n\n  // \u8fc7\u6ee4\u6761\u4ef6\n  string filter = 3;  // \u4f7f\u7528\u6807\u51c6\u8fc7\u6ee4\u8bed\u6cd5: \"active = true AND age &gt; 18\"\n\n  // \u6392\u5e8f\n  string order_by = 4;  // \u4f8b\u5982: \"name desc, created_at asc\"\n\n  // \u5b57\u6bb5\u63a9\u7801\n  google.protobuf.FieldMask field_mask = 5;\n}\n\nmessage ListUsersResponse {\n  repeated User users = 1;\n\n  // \u5206\u9875\u5143\u6570\u636e\n  string next_page_token = 2;\n  int32 total_size = 3;  // \u603b\u8bb0\u5f55\u6570\uff08\u5982\u679c\u652f\u6301\uff09\n}\n\nmessage BatchCreateUsersResponse {\n  repeated User created_users = 1;\n  int32 success_count = 2;\n  int32 failure_count = 3;\n  repeated BatchError errors = 4;  // \u6279\u5904\u7406\u4e2d\u7684\u9519\u8bef\n}\n\n// \u641c\u7d22\u8bf7\u6c42\nmessage SearchUsersRequest {\n  string query = 1;  // \u5168\u6587\u641c\u7d22\u67e5\u8be2\n\n  // \u5206\u9875\n  int32 page_size = 2;\n  string page_token = 3;\n\n  // \u641c\u7d22\u9009\u9879\n  SearchOptions options = 4;\n\n  message SearchOptions {\n    bool include_inactive = 1;\n    repeated string fields_to_search = 2;  // \u6307\u5b9a\u641c\u7d22\u54ea\u4e9b\u5b57\u6bb5\n  }\n}\n\n// \u804a\u5929\u6d88\u606f\nmessage UserChatMessage {\n  string user_id = 1 [(validate.rules).string = {min_len: 1}];\n  string message_id = 2 [(validate.rules).string.uuid = true];\n  MessageType type = 3;\n  oneof content {\n    string text = 4;\n    bytes attachment = 5;\n    Command command = 6;\n  }\n  google.protobuf.Timestamp timestamp = 7;\n  map&lt;string, string&gt; metadata = 8;  // \u6269\u5c55\u5143\u6570\u636e\n\n  enum MessageType {\n    MESSAGE_TYPE_UNSPECIFIED = 0;  // \u5fc5\u987b\u4ece0\u5f00\u59cb\n    MESSAGE_TYPE_TEXT = 1;\n    MESSAGE_TYPE_IMAGE = 2;\n    MESSAGE_TYPE_FILE = 3;\n    MESSAGE_TYPE_COMMAND = 4;\n  }\n\n  message Command {\n    string name = 1;\n    map&lt;string, string&gt; params = 2;\n  }\n}\n\n// \u6279\u5904\u7406\u9519\u8bef\nmessage BatchError {\n  int32 index = 1;  // \u8f93\u5165\u4e2d\u7684\u7d22\u5f15\n  string id = 2;    // \u7528\u6237ID\uff08\u5982\u679c\u6709\uff09\n  Error error = 3;  // \u5177\u4f53\u9519\u8bef\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#2-protov1typesuserproto","title":"\ud83d\udce6 2. \u7c7b\u578b\u5b9a\u4e49\u6a21\u677f (<code>proto/v1/types/user.proto</code>)","text":"<pre><code>syntax = \"proto3\";\n\npackage company.product.v1;\n\nimport \"google/protobuf/timestamp.proto\";\nimport \"google/protobuf/wrappers.proto\";\nimport \"company/product/v1/types/enums.proto\";\nimport \"validate/validate.proto\";\n\noption go_package = \"github.com/company/product/gen/go/product/v1;productv1\";\n\n// \u7528\u6237\u5b9e\u4f53 - \u4f7f\u7528\u6e05\u6670\u7684\u5206\u5c42\u7ed3\u6784\nmessage User {\n  // \u6838\u5fc3\u6807\u8bc6\u5b57\u6bb5\n  string id = 1 [\n    (validate.rules).string = {uuid: true},\n    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {\n      description: \"Unique user identifier (UUID)\"\n      read_only: true\n    }\n  ];\n\n  // \u57fa\u672c\u4fe1\u606f\uff08\u5206\u7ec4\u7ec4\u7ec7\uff09\n  message BasicInfo {\n    string first_name = 1 [(validate.rules).string = {min_len: 1, max_len: 50}];\n    string last_name = 2 [(validate.rules).string = {min_len: 1, max_len: 50}];\n    string display_name = 3 [(validate.rules).string = {max_len: 100}];\n\n    // \u4f7f\u7528\u5305\u88c5\u7c7b\u578b\u8868\u793a\u53ef\u9009\u5b57\u6bb5\n    google.protobuf.StringValue middle_name = 4;\n    google.protobuf.StringValue title = 5;  // \u5148\u751f/\u5973\u58eb/\u535a\u58eb\u7b49\n  }\n\n  BasicInfo basic_info = 2 [(validate.rules).message.required = true];\n\n  // \u8054\u7cfb\u4fe1\u606f\n  message ContactInfo {\n    string email = 1 [\n      (validate.rules).string = {email: true, max_len: 255},\n      (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {\n        example: \"\\\"user@example.com\\\"\"\n      }\n    ];\n\n    // \u4f7f\u7528 oneof \u8868\u793a\u4e92\u65a5\u7684\u5b57\u6bb5\n    oneof primary_phone {\n      string mobile_phone = 2 [(validate.rules).string = {pattern: \"^\\\\+?[1-9]\\\\d{1,14}$\"}]; // E.164 \u683c\u5f0f\n      string landline_phone = 3;\n    }\n\n    repeated string secondary_emails = 4;\n    repeated string phone_numbers = 5;\n\n    // \u5730\u5740\n    Address primary_address = 6;\n    repeated Address alternate_addresses = 7;\n  }\n\n  ContactInfo contact_info = 3;\n\n  // \u8d26\u6237\u4fe1\u606f\n  message AccountInfo {\n    string username = 1 [(validate.rules).string = {min_len: 3, max_len: 50, pattern: \"^[a-zA-Z0-9._-]+$\"}];\n    bool email_verified = 2;\n    bool phone_verified = 3;\n    AccountStatus status = 4;\n    repeated string roles = 5;  // \u7528\u6237\u89d2\u8272\n    repeated string permissions = 6;  // \u76f4\u63a5\u6743\u9650\n  }\n\n  AccountInfo account_info = 4;\n\n  // \u5143\u6570\u636e\n  message Metadata {\n    google.protobuf.Timestamp created_at = 1;\n    google.protobuf.Timestamp updated_at = 2;\n    google.protobuf.Timestamp last_login_at = 3;\n    string created_by = 4;  // \u521b\u5efa\u8005\u7528\u6237ID\n    string updated_by = 5;  // \u6700\u540e\u66f4\u65b0\u8005\u7528\u6237ID\n\n    // \u6269\u5c55\u5b57\u6bb5\n    map&lt;string, string&gt; labels = 6;  // \u7528\u4e8e\u5206\u7c7b/\u6807\u8bb0\n    map&lt;string, string&gt; annotations = 7;  // \u975e\u6807\u8bc6\u6027\u5143\u6570\u636e\n\n    // \u7248\u672c\u63a7\u5236\n    int64 version = 8;  // \u4e50\u89c2\u9501\u7248\u672c\u53f7\n    string etag = 9;    // \u7528\u4e8e\u6761\u4ef6\u66f4\u65b0\n  }\n\n  Metadata metadata = 5;\n\n  // \u4e1a\u52a1\u7279\u5b9a\u5b57\u6bb5\n  message Preferences {\n    string language = 1 [(validate.rules).string = {len: 2}];  // ISO 639-1\n    string timezone = 2;  // \u4f8b\u5982 \"America/New_York\"\n    string locale = 3;    // \u4f8b\u5982 \"en-US\"\n    CurrencyCode default_currency = 4;\n\n    // \u901a\u77e5\u504f\u597d\n    NotificationPreferences notifications = 5;\n\n    // \u9690\u79c1\u8bbe\u7f6e\n    PrivacySettings privacy = 6;\n  }\n\n  Preferences preferences = 6;\n\n  // \u7edf\u8ba1\u4fe1\u606f\n  message Statistics {\n    int32 login_count = 1;\n    int32 failed_login_attempts = 2;\n    google.protobuf.Timestamp password_changed_at = 3;\n    int32 order_count = 4;\n    double total_spent = 5;\n  }\n\n  Statistics statistics = 7;\n}\n\n// \u5730\u5740\u7c7b\u578b\uff08\u53ef\u590d\u7528\uff09\nmessage Address {\n  // \u4f7f\u7528\u679a\u4e3e\u63d0\u9ad8\u53ef\u8bfb\u6027\n  AddressType type = 1;  // \u5bb6\u5ead\u3001\u5de5\u4f5c\u3001\u8d26\u5355\u7b49\n\n  string line1 = 2 [(validate.rules).string = {min_len: 1, max_len: 200}];\n  google.protobuf.StringValue line2 = 3;\n  string city = 4 [(validate.rules).string = {min_len: 1, max_len: 100}];\n  string state = 5 [(validate.rules).string = {min_len: 1, max_len: 100}];\n  string postal_code = 6 [(validate.rules).string = {min_len: 1, max_len: 20}];\n  string country = 7 [\n    (validate.rules).string = {len: 2},  // ISO 3166-1 alpha-2\n    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {\n      example: \"\\\"US\\\"\"\n    }\n  ];\n\n  // \u9a8c\u8bc1\u72b6\u6001\n  bool is_verified = 8;\n  google.protobuf.Timestamp verified_at = 9;\n\n  // \u5750\u6807\n  message Coordinates {\n    double latitude = 1 [(validate.rules).double = {gte: -90, lte: 90}];\n    double longitude = 2 [(validate.rules).double = {gte: -180, lte: 180}];\n  }\n\n  Coordinates coordinates = 10;\n}\n\n// \u901a\u77e5\u504f\u597d\nmessage NotificationPreferences {\n  bool email_enabled = 1;\n  bool sms_enabled = 2;\n  bool push_enabled = 3;\n\n  message ChannelPreferences {\n    bool marketing = 1;\n    bool security = 2;\n    bool updates = 3;\n    bool reminders = 4;\n  }\n\n  ChannelPreferences channels = 4;\n}\n\n// \u9690\u79c1\u8bbe\u7f6e\nmessage PrivacySettings {\n  enum ProfileVisibility {\n    PROFILE_VISIBILITY_UNSPECIFIED = 0;\n    PROFILE_VISIBILITY_PRIVATE = 1;\n    PROFILE_VISIBILITY_FRIENDS_ONLY = 2;\n    PROFILE_VISIBILITY_PUBLIC = 3;\n  }\n\n  ProfileVisibility profile_visibility = 1;\n  bool show_email = 2;\n  bool show_phone = 3;\n  bool show_last_seen = 4;\n  bool allow_search_by_email = 5;\n  bool allow_search_by_phone = 6;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#3-protov1typesenumsproto","title":"\ud83c\udfaf 3. \u679a\u4e3e\u548c\u5e38\u91cf\u5b9a\u4e49 (<code>proto/v1/types/enums.proto</code>)","text":"<pre><code>syntax = \"proto3\";\n\npackage company.product.v1;\n\noption go_package = \"github.com/company/product/gen/go/product/v1;productv1\";\n\n// \u5730\u5740\u7c7b\u578b\u679a\u4e3e\nenum AddressType {\n  ADDRESS_TYPE_UNSPECIFIED = 0;  // \u5fc5\u987b\u5305\u542b UNSPECIFIED\n  ADDRESS_TYPE_HOME = 1;\n  ADDRESS_TYPE_WORK = 2;\n  ADDRESS_TYPE_BILLING = 3;\n  ADDRESS_TYPE_SHIPPING = 4;\n  ADDRESS_TYPE_OTHER = 99;\n}\n\n// \u8d26\u6237\u72b6\u6001\u679a\u4e3e\nenum AccountStatus {\n  ACCOUNT_STATUS_UNSPECIFIED = 0;\n  ACCOUNT_STATUS_PENDING = 1;      // \u7b49\u5f85\u6fc0\u6d3b\n  ACCOUNT_STATUS_ACTIVE = 2;       // \u6d3b\u8dc3\n  ACCOUNT_STATUS_SUSPENDED = 3;    // \u6682\u505c\n  ACCOUNT_STATUS_LOCKED = 4;       // \u9501\u5b9a\n  ACCOUNT_STATUS_INACTIVE = 5;     // \u4e0d\u6d3b\u8dc3\n  ACCOUNT_STATUS_DELETED = 6;      // \u5df2\u5220\u9664\n  ACCOUNT_STATUS_ARCHIVED = 7;     // \u5df2\u5f52\u6863\n}\n\n// \u7528\u6237\u89d2\u8272\uff08\u4f7f\u7528\u524d\u7f00\u907f\u514d\u547d\u540d\u51b2\u7a81\uff09\nenum UserRole {\n  USER_ROLE_UNSPECIFIED = 0;\n  USER_ROLE_GUEST = 1;\n  USER_ROLE_USER = 2;\n  USER_ROLE_ADMIN = 3;\n  USER_ROLE_SUPER_ADMIN = 4;\n  USER_ROLE_MODERATOR = 5;\n  USER_ROLE_EDITOR = 6;\n  USER_ROLE_VIEWER = 7;\n}\n\n// \u8d27\u5e01\u4ee3\u7801\uff08ISO 4217\uff09\nenum CurrencyCode {\n  CURRENCY_CODE_UNSPECIFIED = 0;\n  CURRENCY_CODE_USD = 1;  // \u7f8e\u5143\n  CURRENCY_CODE_EUR = 2;  // \u6b27\u5143\n  CURRENCY_CODE_GBP = 3;  // \u82f1\u9551\n  CURRENCY_CODE_JPY = 4;  // \u65e5\u5143\n  CURRENCY_CODE_CNY = 5;  // \u4eba\u6c11\u5e01\n}\n\n// \u6027\u522b\uff08\u6ce8\u610f\u654f\u611f\u6027\u548c\u5305\u5bb9\u6027\uff09\nenum Gender {\n  GENDER_UNSPECIFIED = 0;\n  GENDER_MALE = 1;\n  GENDER_FEMALE = 2;\n  GENDER_NON_BINARY = 3;\n  GENDER_PREFER_NOT_TO_SAY = 4;\n  GENDER_OTHER = 99;\n}\n\n// \u65f6\u95f4\u5355\u4f4d\uff08\u7528\u4e8e\u65f6\u95f4\u95f4\u9694\uff09\nenum TimeUnit {\n  TIME_UNIT_UNSPECIFIED = 0;\n  TIME_UNIT_SECOND = 1;\n  TIME_UNIT_MINUTE = 2;\n  TIME_UNIT_HOUR = 3;\n  TIME_UNIT_DAY = 4;\n  TIME_UNIT_WEEK = 5;\n  TIME_UNIT_MONTH = 6;\n  TIME_UNIT_YEAR = 7;\n}\n\n// \u6392\u5e8f\u65b9\u5411\nenum SortDirection {\n  SORT_DIRECTION_UNSPECIFIED = 0;\n  SORT_DIRECTION_ASC = 1;\n  SORT_DIRECTION_DESC = 2;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#4-protov1errorserrorproto","title":"\u26a0\ufe0f 4. \u9519\u8bef\u5b9a\u4e49 (<code>proto/v1/errors/error.proto</code>)","text":"<pre><code>syntax = \"proto3\";\n\npackage company.product.v1;\n\nimport \"google/protobuf/any.proto\";\n\noption go_package = \"github.com/company/product/gen/go/product/v1;productv1\";\n\n// \u6807\u51c6\u9519\u8bef\u54cd\u5e94\nmessage Error {\n  // \u9519\u8bef\u4ee3\u7801\uff08\u673a\u5668\u53ef\u8bfb\uff09\n  string code = 1;\n\n  // \u9519\u8bef\u6d88\u606f\uff08\u4eba\u7c7b\u53ef\u8bfb\uff09\n  string message = 2;\n\n  // \u9519\u8bef\u7c7b\u578b\n  ErrorType type = 3;\n\n  // \u5177\u4f53\u5b57\u6bb5\u9519\u8bef\n  repeated FieldViolation field_violations = 4;\n\n  // \u5e2e\u52a9\u94fe\u63a5\n  string help_link = 5;\n\n  // \u8bf7\u6c42ID\uff08\u7528\u4e8e\u8ffd\u8e2a\uff09\n  string request_id = 6;\n\n  // \u6269\u5c55\u9519\u8bef\u8be6\u60c5\n  repeated google.protobuf.Any details = 7;\n\n  // \u5806\u6808\u8ddf\u8e2a\uff08\u4ec5\u5f00\u53d1\u73af\u5883\uff09\n  string stack_trace = 8;\n}\n\n// \u5b57\u6bb5\u9a8c\u8bc1\u9519\u8bef\nmessage FieldViolation {\n  string field = 1;\n  string description = 2;\n  string code = 3;  // \u5982\uff1a\"REQUIRED\", \"INVALID_EMAIL\"\n}\n\n// \u9519\u8bef\u7c7b\u578b\u679a\u4e3e\nenum ErrorType {\n  ERROR_TYPE_UNSPECIFIED = 0;\n  ERROR_TYPE_VALIDATION = 1;      // \u8f93\u5165\u9a8c\u8bc1\u5931\u8d25\n  ERROR_TYPE_NOT_FOUND = 2;       // \u8d44\u6e90\u4e0d\u5b58\u5728\n  ERROR_TYPE_ALREADY_EXISTS = 3;  // \u8d44\u6e90\u5df2\u5b58\u5728\n  ERROR_TYPE_PERMISSION_DENIED = 4; // \u6743\u9650\u4e0d\u8db3\n  ERROR_TYPE_UNAUTHENTICATED = 5; // \u672a\u8ba4\u8bc1\n  ERROR_TYPE_RESOURCE_EXHAUSTED = 6; // \u8d44\u6e90\u8017\u5c3d\n  ERROR_TYPE_FAILED_PRECONDITION = 7; // \u524d\u7f6e\u6761\u4ef6\u5931\u8d25\n  ERROR_TYPE_ABORTED = 8;         // \u64cd\u4f5c\u4e2d\u6b62\n  ERROR_TYPE_OUT_OF_RANGE = 9;    // \u8d85\u51fa\u8303\u56f4\n  ERROR_TYPE_UNIMPLEMENTED = 10;  // \u672a\u5b9e\u73b0\n  ERROR_TYPE_INTERNAL = 11;       // \u5185\u90e8\u9519\u8bef\n  ERROR_TYPE_UNAVAILABLE = 12;    // \u670d\u52a1\u4e0d\u53ef\u7528\n  ERROR_TYPE_DATA_LOSS = 13;      // \u6570\u636e\u4e22\u5931\n  ERROR_TYPE_DEADLINE_EXCEEDED = 14; // \u8d85\u65f6\n}\n\n// \u9884\u5b9a\u4e49\u9519\u8bef\u4ee3\u7801\nenum ErrorCode {\n  // \u901a\u7528\u9519\u8bef (1000-1999)\n  ERROR_CODE_UNSPECIFIED = 0;\n  ERROR_CODE_INVALID_ARGUMENT = 1000;\n  ERROR_CODE_UNAUTHENTICATED = 1001;\n  ERROR_CODE_PERMISSION_DENIED = 1002;\n  ERROR_CODE_NOT_FOUND = 1003;\n  ERROR_CODE_ALREADY_EXISTS = 1004;\n  ERROR_CODE_RESOURCE_EXHAUSTED = 1005;\n  ERROR_CODE_FAILED_PRECONDITION = 1006;\n  ERROR_CODE_ABORTED = 1007;\n  ERROR_CODE_OUT_OF_RANGE = 1008;\n  ERROR_CODE_UNIMPLEMENTED = 1009;\n  ERROR_CODE_INTERNAL = 1010;\n  ERROR_CODE_UNAVAILABLE = 1011;\n  ERROR_CODE_DATA_LOSS = 1012;\n  ERROR_CODE_DEADLINE_EXCEEDED = 1013;\n\n  // \u7528\u6237\u76f8\u5173\u9519\u8bef (2000-2999)\n  ERROR_CODE_USER_NOT_FOUND = 2000;\n  ERROR_CODE_USER_ALREADY_EXISTS = 2001;\n  ERROR_CODE_USER_INACTIVE = 2002;\n  ERROR_CODE_USER_SUSPENDED = 2003;\n  ERROR_CODE_INVALID_CREDENTIALS = 2004;\n  ERROR_CODE_ACCOUNT_LOCKED = 2005;\n  ERROR_CODE_EMAIL_NOT_VERIFIED = 2006;\n  ERROR_CODE_PHONE_NOT_VERIFIED = 2007;\n  ERROR_CODE_INVALID_PASSWORD = 2008;\n  ERROR_CODE_WEAK_PASSWORD = 2009;\n  ERROR_CODE_PASSWORD_EXPIRED = 2010;\n  ERROR_CODE_MAX_LOGIN_ATTEMPTS = 2011;\n\n  // \u9a8c\u8bc1\u9519\u8bef (3000-3999)\n  ERROR_CODE_VALIDATION_FAILED = 3000;\n  ERROR_CODE_REQUIRED_FIELD = 3001;\n  ERROR_CODE_INVALID_EMAIL = 3002;\n  ERROR_CODE_INVALID_PHONE = 3003;\n  ERROR_CODE_INVALID_DATE = 3004;\n  ERROR_CODE_INVALID_FORMAT = 3005;\n  ERROR_CODE_OUT_OF_RANGE = 3006;\n  ERROR_CODE_TOO_SHORT = 3007;\n  ERROR_CODE_TOO_LONG = 3008;\n  ERROR_CODE_PATTERN_MISMATCH = 3009;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#5-protov1typescommonproto","title":"\u2699\ufe0f 5. \u901a\u7528\u7c7b\u578b (<code>proto/v1/types/common.proto</code>)","text":"<pre><code>syntax = \"proto3\";\n\npackage company.product.v1;\n\nimport \"google/protobuf/timestamp.proto\";\nimport \"google/protobuf/duration.proto\";\n\noption go_package = \"github.com/company/product/gen/go/product/v1;productv1\";\n\n// \u5206\u9875\u54cd\u5e94\u901a\u7528\u7ed3\u6784\nmessage PaginationInfo {\n  int32 page = 1;\n  int32 page_size = 2;\n  int32 total_pages = 3;\n  int64 total_items = 4;\n  bool has_next = 5;\n  bool has_previous = 6;\n  string next_cursor = 7;\n  string previous_cursor = 8;\n}\n\n// \u65f6\u95f4\u8303\u56f4\nmessage TimeRange {\n  google.protobuf.Timestamp start_time = 1;\n  google.protobuf.Timestamp end_time = 2;\n}\n\n// \u65e5\u671f\u8303\u56f4\nmessage DateRange {\n  string start_date = 1;  // YYYY-MM-DD\n  string end_date = 2;    // YYYY-MM-DD\n}\n\n// \u5730\u7406\u4f4d\u7f6e\nmessage GeoPoint {\n  double latitude = 1;\n  double longitude = 2;\n  google.protobuf.DoubleValue altitude = 3;  // \u53ef\u9009\u9ad8\u5ea6\n}\n\n// \u8d27\u5e01\u91d1\u989d\nmessage Money {\n  // ISO 4217 \u8d27\u5e01\u4ee3\u7801\n  string currency_code = 1 [(validate.rules).string = {len: 3}];\n\n  // \u91d1\u989d\uff08\u4ee5\u6700\u5c0f\u5355\u4f4d\u8868\u793a\uff0c\u5982\u5206\uff09\n  // \u4f7f\u7528 string \u907f\u514d JavaScript \u7cbe\u5ea6\u95ee\u9898\n  string units = 2;  // \u6574\u6570\u90e8\u5206\n  int32 nanos = 3;   // \u5c0f\u6570\u90e8\u5206\uff0810^-9\uff09\n\n  // \u793a\u4f8b: $12.34 -&gt; units=\"12\", nanos=340000000\n  // \u793a\u4f8b: \u20ac0.99 -&gt; units=\"0\", nanos=990000000\n}\n\n// \u6587\u4ef6\u4fe1\u606f\nmessage FileInfo {\n  string id = 1;\n  string name = 2;\n  string mime_type = 3;\n  int64 size = 4;  // \u5b57\u8282\n  string url = 5;\n  string hash = 6;  // SHA256\n  google.protobuf.Timestamp uploaded_at = 7;\n  map&lt;string, string&gt; metadata = 8;\n}\n\n// \u5ba1\u8ba1\u4fe1\u606f\nmessage AuditInfo {\n  google.protobuf.Timestamp created_at = 1;\n  string created_by = 2;\n  google.protobuf.Timestamp updated_at = 3;\n  string updated_by = 4;\n  google.protobuf.Timestamp deleted_at = 5;\n  string deleted_by = 6;\n}\n\n// \u8d44\u6e90\u5f15\u7528\nmessage ResourceReference {\n  string type = 1;  // \u8d44\u6e90\u7c7b\u578b\uff0c\u5982 \"user\", \"order\"\n  string id = 2;    // \u8d44\u6e90ID\n  string name = 3;  // \u53ef\u9009\u663e\u793a\u540d\u79f0\n  string link = 4;  // \u53ef\u9009\u8d44\u6e90\u94fe\u63a5\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#6-buf-bufyaml","title":"\ud83d\udee0\ufe0f 6. Buf \u914d\u7f6e (<code>buf.yaml</code>)","text":"<pre><code>version: v1\nlint:\n  use:\n    - DEFAULT\n  except:\n    - PACKAGE_VERSION_SUFFIX  # \u5141\u8bb8 v1, v2 \u540e\u7f00\n  rpc_allow_same_request_response: true\n  rpc_allow_google_protobuf_empty_requests: true\n  rpc_allow_google_protobuf_empty_responses: true\nbreaking:\n  use:\n    - FILE\n  except:\n    - RPC_NO_DELETE  # \u5141\u8bb8\u5220\u9664RPC\uff08\u901a\u8fc7\u7248\u672c\u63a7\u5236\u7ba1\u7406\uff09\n</code></pre>"},{"location":"wiki/Golang/Grpc/%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#7-bufgenyaml","title":"\ud83d\ude80 7. \u4ee3\u7801\u751f\u6210\u914d\u7f6e (<code>buf.gen.yaml</code>)","text":"<pre><code>version: v1\nmanaged:\n  enabled: true\n  override:\n    - file_option: go_package\n      value_prefix: github.com/company/product/gen/go\nplugins:\n  - name: go\n    out: gen/go\n    opt: paths=source_relative\n  - name: go-grpc\n    out: gen/go\n    opt:\n      - paths=source_relative\n      - require_unimplemented_servers=false\n  - name: grpc-gateway\n    out: gen/go\n    opt:\n      - paths=source_relative\n      - generate_unbound_methods=true\n      - allow_delete_body=true\n  - name: openapiv2\n    out: gen/openapi\n  - name: validate\n    out: gen/go\n    opt:\n      - paths=source_relative\n      - lang=go\n  # TypeScript/JavaScript\n  - name: js\n    out: gen/js\n    opt:\n      - import_style=commonjs\n      - binary_format=grpc-web\n  - name: grpc-web\n    out: gen/js\n    opt:\n      - import_style=commonjs\n      - mode=grpcwebtext\n</code></pre>"},{"location":"wiki/Golang/Grpc/%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#8-makefile","title":"\ud83d\udccb 8. Makefile \u793a\u4f8b","text":"<pre><code>.PHONY: proto gen clean\n\n# Protobuf \u751f\u6210\nproto: gen\n\ngen:\n    @echo \"Generating Go code...\"\n    buf generate\n    @echo \"Formatting generated code...\"\n    go fmt ./gen/...\n\n# \u4ee3\u7801\u68c0\u67e5\nlint:\n    buf lint\n    buf breaking --against '.git#branch=main'\n\n# \u6e05\u7406\u751f\u6210\u7684\u6587\u4ef6\nclean:\n    rm -rf gen/\n\n# \u4e0b\u8f7d\u4f9d\u8d56\ndeps:\n    go install google.golang.org/protobuf/cmd/protoc-gen-go@latest\n    go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest\n    go install github.com/grpc-ecosystem/grpc-gateway/v2/protoc-gen-grpc-gateway@latest\n    go install github.com/grpc-ecosystem/grpc-gateway/v2/protoc-gen-openapiv2@latest\n    go install github.com/envoyproxy/protoc-gen-validate@latest\n    go install github.com/bufbuild/buf/cmd/buf@latest\n</code></pre>"},{"location":"wiki/Golang/Grpc/%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#_2","title":"\ud83d\udca1 \u5173\u952e\u6700\u4f73\u5b9e\u8df5\u603b\u7ed3","text":"<ol> <li> <p>\u7248\u672c\u5316\u76ee\u5f55\uff1a\u4f7f\u7528 <code>v1/</code>, <code>v2/</code> \u76ee\u5f55\u7ba1\u7406\u4e0d\u540c API \u7248\u672c</p> </li> <li> <p>\u5305\u540d\u89c4\u8303\uff1a<code>company.product.v1</code></p> </li> <li> <p>Go \u5305\u9009\u9879\uff1a\u5fc5\u987b\u8bbe\u7f6e <code>go_package</code></p> </li> <li> <p>\u679a\u4e3e\u547d\u540d\uff1a\u4f7f\u7528 <code>TYPE_UNSPECIFIED = 0</code> \u4f5c\u4e3a\u9ed8\u8ba4\u503c</p> </li> <li> <p>\u5b57\u6bb5\u7ec4\u7ec7\uff1a\u4f7f\u7528\u5d4c\u5957\u6d88\u606f\u5206\u7ec4\u76f8\u5173\u5b57\u6bb5</p> </li> <li> <p>\u9a8c\u8bc1\u6ce8\u91ca\uff1a\u4f7f\u7528 <code>validate.rules</code> \u6dfb\u52a0\u9a8c\u8bc1\u89c4\u5219</p> </li> <li> <p>\u6587\u6863\u6ce8\u91ca\uff1a\u6240\u6709\u5b57\u6bb5\u548c\u670d\u52a1\u90fd\u6dfb\u52a0\u8be6\u7ec6\u6587\u6863</p> </li> <li> <p>\u9519\u8bef\u5904\u7406\uff1a\u5b9a\u4e49\u6807\u51c6\u7684\u9519\u8bef\u54cd\u5e94\u683c\u5f0f</p> </li> <li> <p>\u5206\u9875\u6807\u51c6\u5316\uff1a\u4f7f\u7528 <code>page_token</code> \u548c <code>page_size</code></p> </li> <li> <p>\u5de5\u5177\u96c6\u6210\uff1a\u4f7f\u7528 Buf \u8fdb\u884c linting \u548c breaking change \u68c0\u6d4b</p> </li> </ol>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/","title":"\ud83d\udcd8 Protocol Buffers 3 \u8bed\u6cd5\u5b8c\u5168\u6307\u5357","text":""},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#1","title":"\ud83d\udcc4 1. \u57fa\u7840\u8bed\u6cd5\u7ed3\u6784","text":""},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_1","title":"\u6587\u4ef6\u5f00\u5934\u58f0\u660e","text":"<pre><code>// \u5fc5\u9700\uff1a\u6307\u5b9a\u8bed\u6cd5\u7248\u672c\nsyntax = \"proto3\";\n\n// \u53ef\u9009\uff1a\u5305\u540d\uff08\u9632\u6b62\u547d\u540d\u51b2\u7a81\uff09\npackage mypackage.v1;\n\n// \u5fc5\u9700\uff08\u5bf9Go\uff09\uff1a\u751f\u6210\u7684Go\u5305\u8def\u5f84\noption go_package = \"github.com/user/project/gen/go/mypackage/v1;mypackagev1\";\n\n// \u5176\u4ed6\u8bed\u8a00\u9009\u9879\noption java_multiple_files = true;\noption java_package = \"com.example.mypackage.v1\";\noption csharp_namespace = \"Example.MyPackage.V1\";\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_2","title":"\u6ce8\u91ca\u89c4\u8303","text":"<pre><code>// \u5355\u884c\u6ce8\u91ca\nmessage User {\n  // \u5b57\u6bb5\u6ce8\u91ca\n  string id = 1;\n\n  /*\n   * \u591a\u884c\u6ce8\u91ca\n   * \u7528\u4e8e\u590d\u6742\u8bf4\u660e\n   */\n  string name = 2;\n}\n\n/// \u6587\u6863\u6ce8\u91ca\uff08\u90e8\u5206\u5de5\u5177\u652f\u6301\uff09\n/// \u7528\u6237\u670d\u52a1\u63a5\u53e3\nservice UserService {\n  rpc GetUser(GetUserRequest) returns (User);\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#2","title":"\ud83d\udce6 2. \u57fa\u672c\u6570\u636e\u7c7b\u578b","text":""},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_3","title":"\u6807\u91cf\u7c7b\u578b","text":"<pre><code>message ScalarTypes {\n  // \u6570\u5b57\u7c7b\u578b\n  double double_field = 1;   // \u53cc\u7cbe\u5ea6\u6d6e\u70b9\u6570\n  float float_field = 2;     // \u5355\u7cbe\u5ea6\u6d6e\u70b9\u6570\n\n  // \u6574\u6570\u7c7b\u578b\n  int32 int32_field = 3;     // \u53d8\u957f\u7f16\u7801\uff0c\u8d1f\u503c\u6548\u7387\u4f4e\n  int64 int64_field = 4;     // \u53d8\u957f\u7f16\u7801\uff0c\u8d1f\u503c\u6548\u7387\u4f4e\n  uint32 uint32_field = 5;   // \u65e0\u7b26\u53f7\u53d8\u957f\u7f16\u7801\n  uint64 uint64_field = 6;   // \u65e0\u7b26\u53f7\u53d8\u957f\u7f16\u7801\n  sint32 sint32_field = 7;   // \u53d8\u957f\u7f16\u7801\uff0c\u8d1f\u503c\u6548\u7387\u9ad8\n  sint64 sint64_field = 8;   // \u53d8\u957f\u7f16\u7801\uff0c\u8d1f\u503c\u6548\u7387\u9ad8\n  fixed32 fixed32_field = 9; // \u56fa\u5b9a4\u5b57\u8282\uff0c\u5927\u4e8e2^28\u65f6\u6548\u7387\u9ad8\n  fixed64 fixed64_field = 10;// \u56fa\u5b9a8\u5b57\u8282\uff0c\u5927\u4e8e2^56\u65f6\u6548\u7387\u9ad8\n  sfixed32 sfixed32_field = 11; // \u56fa\u5b9a4\u5b57\u8282\n  sfixed64 sfixed64_field = 12; // \u56fa\u5b9a8\u5b57\u8282\n\n  // \u5e03\u5c14\u7c7b\u578b\n  bool bool_field = 13;\n\n  // \u5b57\u7b26\u4e32\u7c7b\u578b\n  string string_field = 14;  // UTF-8 \u6216 7-bit ASCII\n\n  // \u5b57\u8282\u7c7b\u578b\n  bytes bytes_field = 15;    // \u4efb\u610f\u4e8c\u8fdb\u5236\u6570\u636e\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_4","title":"\u9ed8\u8ba4\u503c\u89c4\u5219","text":"<pre><code>// proto3 \u4e2d\u6240\u6709\u5b57\u6bb5\u90fd\u6709\u9ed8\u8ba4\u503c\uff0c\u65e0\u6cd5\u533a\u5206\"\u672a\u8bbe\u7f6e\"\u548c\"\u9ed8\u8ba4\u503c\"\nmessage DefaultValues {\n  string name = 1;           // \u9ed8\u8ba4: \"\" (\u7a7a\u5b57\u7b26\u4e32)\n  int32 count = 2;           // \u9ed8\u8ba4: 0\n  bool active = 3;           // \u9ed8\u8ba4: false\n  repeated string tags = 4;  // \u9ed8\u8ba4: [] (\u7a7a\u5217\u8868)\n  Color color = 5;           // \u9ed8\u8ba4: \u7b2c\u4e00\u4e2a\u679a\u4e3e\u503c(\u5fc5\u987b\u4e3a0)\n}\n\nenum Color {\n  COLOR_UNSPECIFIED = 0;  // \u5fc5\u987b\u5b9a\u4e490\u503c\u4f5c\u4e3a\u9ed8\u8ba4\n  COLOR_RED = 1;\n  COLOR_GREEN = 2;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#3","title":"\ud83c\udfd7\ufe0f 3. \u590d\u5408\u6570\u636e\u7c7b\u578b","text":""},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_5","title":"\u6d88\u606f\u5b9a\u4e49","text":"<pre><code>// \u57fa\u672c\u6d88\u606f\nmessage Person {\n  string id = 1;\n  string name = 2;\n  string email = 3;\n  int32 age = 4;\n}\n\n// \u5d4c\u5957\u6d88\u606f\nmessage Company {\n  string id = 1;\n  string name = 2;\n\n  // \u5185\u5d4c\u6d88\u606f\u5b9a\u4e49\n  message Address {\n    string street = 1;\n    string city = 2;\n    string country = 3;\n  }\n\n  Address address = 3;\n\n  // \u5f15\u7528\u5916\u90e8\u6d88\u606f\n  repeated Person employees = 4;\n}\n\n// \u4f7f\u7528\u5d4c\u5957\u6d88\u606f\nCompany.Address companyAddress = 1;\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_6","title":"\u6570\u7ec4/\u5217\u8868","text":"<pre><code>message ListExample {\n  // \u91cd\u590d\u5b57\u6bb5\uff08\u6570\u7ec4\uff09\n  repeated string tags = 1;\n  repeated int32 scores = 2;\n  repeated Person people = 3;\n\n  // \u4e8c\u7ef4\u6570\u7ec4\uff08\u901a\u8fc7\u5d4c\u5957\u6d88\u606f\u5b9e\u73b0\uff09\n  message Row {\n    repeated int32 cells = 1;\n  }\n  repeated Row matrix = 4;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_7","title":"\u6620\u5c04\u7c7b\u578b","text":"<pre><code>message MapExample {\n  // \u952e\u7c7b\u578b\u53ea\u80fd\u662f\u6574\u6570\u6216\u5b57\u7b26\u4e32\n  map&lt;string, string&gt; properties = 1;\n  map&lt;int32, string&gt; id_to_name = 2;\n  map&lt;string, Person&gt; username_to_person = 3;\n\n  // map&lt;string, repeated string&gt; \u4e0d\u5141\u8bb8\n  // \u66ff\u4ee3\u65b9\u6848\uff1a\n  message StringList {\n    repeated string values = 1;\n  }\n  map&lt;string, StringList&gt; tags_by_category = 4;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_8","title":"\u679a\u4e3e\u7c7b\u578b","text":"<pre><code>enum UserRole {\n  // \u5fc5\u987b\u4ece0\u5f00\u59cb\n  USER_ROLE_UNSPECIFIED = 0;  // \u7ea6\u5b9a\uff1a\u4f7f\u7528UNSPECIFIED\u4f5c\u4e3a0\u503c\n  USER_ROLE_GUEST = 1;\n  USER_ROLE_USER = 2;\n  USER_ROLE_ADMIN = 3;\n  USER_ROLE_SUPER_ADMIN = 4;\n\n  // \u53ef\u4ee5\u9884\u7559\u503c\n  reserved 5 to 10;\n  reserved \"DEPRECATED_ROLE\";\n}\n\n// \u679a\u4e3e\u522b\u540d\uff08\u76f8\u540c\u503c\u7684\u4e0d\u540c\u540d\u79f0\uff09\nenum Status {\n  STATUS_UNKNOWN = 0;\n  STATUS_ACTIVE = 1;\n  STATUS_INACTIVE = 2;\n  STATUS_ENABLED = 1;  // STATUS_ACTIVE\u7684\u522b\u540d\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#4","title":"\ud83d\udd04 4. \u9ad8\u7ea7\u7279\u6027","text":""},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#oneof","title":"Oneof \u5b57\u6bb5","text":"<pre><code>message Notification {\n  string id = 1;\n  int64 timestamp = 2;\n\n  // \u4e92\u65a5\u7684\u5b57\u6bb5\uff0c\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u8bbe\u7f6e\u4e00\u4e2a\n  oneof content {\n    string text = 3;\n    Image image = 4;\n    Video video = 5;\n    Audio audio = 6;\n  }\n\n  oneof priority {\n    bool high_priority = 7;\n    bool urgent = 8;\n  }\n}\n\n// \u6ce8\u610f\uff1aoneof \u5b57\u6bb5\u4e0d\u80fd\u662f repeated\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_9","title":"\u4fdd\u7559\u5b57\u6bb5","text":"<pre><code>message User {\n  // \u4fdd\u7559\u5b57\u6bb5\u7f16\u53f7\uff08\u9632\u6b62\u91cd\u7528\uff09\n  reserved 2, 15 to 20;  // \u4fdd\u7559\u5b57\u6bb5\u53f7\n  reserved \"surname\", \"age\";  // \u4fdd\u7559\u5b57\u6bb5\u540d\n\n  string id = 1;\n  string name = 3;  // \u8df3\u8fc7\u4fdd\u7559\u76842\n  // string surname = 4;  // \u9519\u8bef\uff1a\u5b57\u6bb5\u540d\u88ab\u4fdd\u7559\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#json","title":"JSON \u6620\u5c04","text":"<pre><code>message JsonExample {\n  // \u81ea\u5b9a\u4e49JSON\u5b57\u6bb5\u540d\n  string user_id = 1 [json_name = \"userId\"];\n  string full_name = 2 [json_name = \"fullName\"];\n\n  // \u9ed8\u8ba4\u6620\u5c04\u89c4\u5219\uff1a\n  // message_name \u2192 messageName\n  // field_name \u2192 fieldName\n  // repeated \u2192 \u6570\u7ec4\n  // map \u2192 \u5bf9\u8c61\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#5","title":"\ud83d\udee0\ufe0f 5. \u670d\u52a1\u5b9a\u4e49","text":""},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_10","title":"\u670d\u52a1\u57fa\u7840","text":"<pre><code>// \u670d\u52a1\u5b9a\u4e49\nservice UserService {\n  // \u4e00\u5143RPC\uff08\u8bf7\u6c42-\u54cd\u5e94\uff09\n  rpc GetUser(GetUserRequest) returns (User);\n\n  // \u670d\u52a1\u7aef\u6d41\u5f0fRPC\n  rpc ListUsers(ListUsersRequest) returns (stream User);\n\n  // \u5ba2\u6237\u7aef\u6d41\u5f0fRPC\n  rpc CreateUsers(stream CreateUserRequest) returns (CreateUsersResponse);\n\n  // \u53cc\u5411\u6d41\u5f0fRPC\n  rpc Chat(stream ChatMessage) returns (stream ChatMessage);\n}\n\n// \u8bf7\u6c42/\u54cd\u5e94\u6d88\u606f\nmessage GetUserRequest {\n  string user_id = 1;\n}\n\nmessage ListUsersRequest {\n  int32 page_size = 1;\n  string page_token = 2;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#6","title":"\ud83d\udcda 6. \u5bfc\u5165\u548c\u5305\u7ba1\u7406","text":""},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_11","title":"\u5bfc\u5165\u8bed\u6cd5","text":"<pre><code>// \u5bfc\u5165\u5176\u4ed6.proto\u6587\u4ef6\nimport \"google/protobuf/timestamp.proto\";\nimport \"google/protobuf/empty.proto\";\nimport \"google/protobuf/wrappers.proto\";\n\n// \u516c\u5171\u5bfc\u5165\nimport public \"common.proto\";  // \u53ef\u88ab\u5bfc\u5165\u6b64\u6587\u4ef6\u7684\u5176\u4ed6\u6587\u4ef6\u4f7f\u7528\n\n// \u4f7f\u7528\u5bfc\u5165\u7684\u7c7b\u578b\nmessage Event {\n  string id = 1;\n  google.protobuf.Timestamp created_at = 2;\n  google.protobuf.StringValue description = 3;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_12","title":"\u5305\u548c\u547d\u540d\u7a7a\u95f4","text":"<pre><code>// \u58f0\u660e\u5305\npackage company.product.v1;\n\n// \u4f7f\u7528\u5b8c\u5168\u9650\u5b9a\u540d\nmessage MyMessage {\n  // \u4f7f\u7528\u5176\u4ed6\u5305\u7684\u7c7b\u578b\n  company.product.v2.CommonType common = 1;\n\n  // \u7b80\u5199\uff08\u5728\u540c\u4e00\u5305\u5185\uff09\n  CommonType local_common = 2;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#7","title":"\u2699\ufe0f 7. \u9009\u9879\u548c\u6ce8\u89e3","text":""},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_13","title":"\u5b57\u6bb5\u9009\u9879","text":"<pre><code>import \"google/protobuf/descriptor.proto\";\n\nmessage AdvancedMessage {\n  // \u5f03\u7528\u5b57\u6bb5\n  string old_field = 1 [deprecated = true];\n\n  // \u81ea\u5b9a\u4e49\u9009\u9879\uff08\u9700\u8981\u5148\u5b9a\u4e49\uff09\n  string secret_field = 2 [\n    sensitive = true,  // \u81ea\u5b9a\u4e49\u9009\u9879\n    json_name = \"secretField\"\n  ];\n\n  // \u9a8c\u8bc1\u89c4\u5219\uff08\u4f7f\u7528protoc-gen-validate\uff09\n  string email = 3 [(validate.rules).string.email = true];\n  int32 age = 4 [(validate.rules).int32 = {gt: 0, lt: 150}];\n}\n\n// \u5b9a\u4e49\u81ea\u5b9a\u4e49\u9009\u9879\nextend google.protobuf.FieldOptions {\n  bool sensitive = 50000;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_14","title":"\u6d88\u606f\u548c\u679a\u4e3e\u9009\u9879","text":"<pre><code>// \u6d88\u606f\u9009\u9879\nmessage Config {\n  option (my_option) = \"value\";\n\n  string name = 1;\n}\n\n// \u679a\u4e3e\u9009\u9879\nenum LogLevel {\n  option allow_alias = true;  // \u5141\u8bb8\u679a\u4e3e\u503c\u522b\u540d\n\n  LOG_LEVEL_UNSPECIFIED = 0;\n  LOG_LEVEL_DEBUG = 1;\n  LOG_LEVEL_INFO = 2;\n  LOG_LEVEL_WARNING = 3;\n  LOG_LEVEL_ERROR = 4;\n  LOG_LEVEL_FATAL = 5;\n  LOG_LEVEL_PANIC = 5;  // FATAL\u7684\u522b\u540d\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#8","title":"\ud83d\udccb 8. \u5b8c\u6574\u793a\u4f8b","text":"<pre><code>syntax = \"proto3\";\n\npackage ecommerce.v1;\n\nimport \"google/protobuf/timestamp.proto\";\nimport \"google/protobuf/wrappers.proto\";\nimport \"validate/validate.proto\";\n\noption go_package = \"github.com/company/ecommerce/gen/go/ecommerce/v1;ecommercev1\";\noption java_multiple_files = true;\noption java_package = \"com.company.ecommerce.v1\";\n\n// \u679a\u4e3e\u5b9a\u4e49\nenum OrderStatus {\n  ORDER_STATUS_UNSPECIFIED = 0;\n  ORDER_STATUS_PENDING = 1;\n  ORDER_STATUS_PROCESSING = 2;\n  ORDER_STATUS_SHIPPED = 3;\n  ORDER_STATUS_DELIVERED = 4;\n  ORDER_STATUS_CANCELLED = 5;\n  ORDER_STATUS_REFUNDED = 6;\n}\n\nenum PaymentMethod {\n  PAYMENT_METHOD_UNSPECIFIED = 0;\n  PAYMENT_METHOD_CREDIT_CARD = 1;\n  PAYMENT_METHOD_PAYPAL = 2;\n  PAYMENT_METHOD_BANK_TRANSFER = 3;\n}\n\n// \u6d88\u606f\u5b9a\u4e49\nmessage Product {\n  string id = 1 [(validate.rules).string.uuid = true];\n  string name = 2 [(validate.rules).string = {min_len: 1, max_len: 100}];\n  string description = 3;\n  Category category = 4;\n  Money price = 5;\n  int32 stock = 6;\n  bool active = 7;\n  google.protobuf.Timestamp created_at = 8;\n  google.protobuf.Timestamp updated_at = 9;\n  map&lt;string, string&gt; attributes = 10;\n\n  message Category {\n    string id = 1;\n    string name = 2;\n    string slug = 3;\n  }\n}\n\nmessage Money {\n  string currency_code = 1 [(validate.rules).string.len = 3];\n  int64 units = 2;  // \u6574\u6570\u90e8\u5206\n  int32 nanos = 3;  // \u5c0f\u6570\u90e8\u5206\uff0810^-9\uff09\n}\n\nmessage Order {\n  string id = 1;\n  string customer_id = 2;\n  OrderStatus status = 3;\n  repeated OrderItem items = 4;\n  Money total_amount = 5;\n  Address shipping_address = 6;\n  PaymentMethod payment_method = 7;\n  google.protobuf.Timestamp order_date = 8;\n  google.protobuf.Timestamp estimated_delivery = 9;\n\n  message OrderItem {\n    string product_id = 1;\n    string product_name = 2;\n    int32 quantity = 3 [(validate.rules).int32.gt = 0];\n    Money unit_price = 4;\n    Money total_price = 5;\n  }\n}\n\nmessage Address {\n  string line1 = 1 [(validate.rules).string.min_len = 1];\n  google.protobuf.StringValue line2 = 2;\n  string city = 3 [(validate.rules).string.min_len = 1];\n  string state = 4;\n  string postal_code = 5;\n  string country = 6 [(validate.rules).string.len = 2];\n\n  oneof type {\n    bool is_residential = 7;\n    bool is_business = 8;\n  }\n}\n\n// \u670d\u52a1\u5b9a\u4e49\nservice OrderService {\n  rpc CreateOrder(CreateOrderRequest) returns (Order);\n  rpc GetOrder(GetOrderRequest) returns (Order);\n  rpc ListOrders(ListOrdersRequest) returns (ListOrdersResponse);\n  rpc UpdateOrderStatus(UpdateOrderStatusRequest) returns (Order);\n  rpc StreamOrderUpdates(StreamOrderUpdatesRequest) returns (stream OrderUpdate);\n\n  // \u6279\u91cf\u64cd\u4f5c\n  rpc BatchCreateOrders(stream CreateOrderRequest) returns (BatchCreateOrdersResponse);\n}\n\n// \u8bf7\u6c42/\u54cd\u5e94\u6d88\u606f\nmessage CreateOrderRequest {\n  string customer_id = 1 [(validate.rules).string.uuid = true];\n  repeated OrderItem items = 2 [(validate.rules).repeated.min_items = 1];\n  Address shipping_address = 3;\n  PaymentMethod payment_method = 4;\n}\n\nmessage ListOrdersRequest {\n  string customer_id = 1;  // \u53ef\u9009\u8fc7\u6ee4\n  repeated OrderStatus status_filter = 2;\n  google.protobuf.Timestamp from_date = 3;\n  google.protobuf.Timestamp to_date = 4;\n  int32 page_size = 5 [(validate.rules).int32 = {gte: 1, lte: 100}];\n  string page_token = 6;\n}\n\nmessage ListOrdersResponse {\n  repeated Order orders = 1;\n  string next_page_token = 2;\n  int32 total_count = 3;\n}\n\nmessage OrderUpdate {\n  string order_id = 1;\n  OrderStatus new_status = 2;\n  google.protobuf.Timestamp updated_at = 3;\n  string message = 4;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#9","title":"\ud83d\udca1 9. \u91cd\u8981\u6ce8\u610f\u4e8b\u9879","text":""},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_15","title":"\u8bed\u6cd5\u89c4\u5219\u603b\u7ed3","text":"<ol> <li> <p>\u5b57\u6bb5\u7f16\u53f7\uff1a1-15 \u5360\u75281\u5b57\u8282\uff0c16-2047 \u5360\u75282\u5b57\u8282</p> </li> <li> <p>\u5b57\u6bb5\u89c4\u5219\uff1aproto3 \u53ea\u6709 <code>repeated</code>\uff0c\u6ca1\u6709 <code>required</code>/<code>optional</code></p> </li> <li> <p>\u9ed8\u8ba4\u503c\uff1a\u65e0\u6cd5\u68c0\u6d4b\u5b57\u6bb5\u662f\u5426\u88ab\u8bbe\u7f6e vs \u663e\u5f0f\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c</p> </li> <li> <p>\u679a\u4e3e\uff1a\u5fc5\u987b\u5305\u542b\u503c\u4e3a0\u7684\u679a\u4e3e\u9879\u4f5c\u4e3a\u9ed8\u8ba4\u503c</p> </li> <li> <p>\u670d\u52a1\uff1a\u5fc5\u987b\u5b9a\u4e49\u8bf7\u6c42\u548c\u54cd\u5e94\u6d88\u606f\uff0c\u4e0d\u80fd\u4f7f\u7528\u6807\u91cf\u7c7b\u578b</p> </li> <li> <p>\u517c\u5bb9\u6027\uff1a\u4e0d\u80fd\u4fee\u6539\u5df2\u4f7f\u7528\u5b57\u6bb5\u7684\u7f16\u53f7\u6216\u7c7b\u578b</p> </li> </ol>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_16","title":"\u6027\u80fd\u6700\u4f73\u5b9e\u8df5","text":"<pre><code>// 1. \u5e38\u7528\u5b57\u6bb5\u4f7f\u75281-15\u7684\u7f16\u53f7\nmessage OptimizedMessage {\n  string id = 1;           // \u5e38\u7528\u5b57\u6bb5\u7528\u5c0f\u7f16\u53f7\n  string name = 2;\n  int32 priority = 3;\n  repeated string tags = 16;  // \u4e0d\u5e38\u7528\u5b57\u6bb5\u7528\u5927\u7f16\u53f7\n  map&lt;string, string&gt; metadata = 17;\n}\n\n// 2. \u907f\u514d\u8fc7\u5ea6\u5d4c\u5957\n// 3. \u5408\u7406\u4f7f\u7528 repeated \u548c map\n// 4. \u8003\u8651\u4f7f\u7528 oneof \u66ff\u4ee3\u591a\u4e2a\u53ef\u9009\u5b57\u6bb5\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%98%20Protocol%20Buffers%203%20%E8%AF%AD%E6%B3%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/#_17","title":"\u5de5\u5177\u547d\u4ee4\u793a\u4f8b","text":"<pre><code># 1. \u751f\u6210Go\u4ee3\u7801\nprotoc --go_out=. --go_opt=paths=source_relative \\\n       --go-grpc_out=. --go-grpc_opt=paths=source_relative \\\n       *.proto\n\n# 2. \u751f\u6210\u591a\u79cd\u8bed\u8a00\nprotoc \\\n  --go_out=gen/go \\\n  --java_out=gen/java \\\n  --python_out=gen/python \\\n  --js_out=gen/js \\\n  *.proto\n\n# 3. \u4f7f\u7528Buf\u5de5\u5177\nbuf lint      # \u4ee3\u7801\u68c0\u67e5\nbuf generate  # \u751f\u6210\u4ee3\u7801\nbuf breaking  # \u68c0\u67e5\u7834\u574f\u6027\u53d8\u66f4\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%A6%20%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/","title":"\ud83d\udce6 \u5b8c\u6574\u7684 <code>.proto</code> \u6587\u4ef6\u6700\u4f73\u5b9e\u8df5\u6a21\u677f","text":"<p>\u4ee5\u4e0b\u662f\u7ecf\u8fc7\u751f\u4ea7\u9a8c\u8bc1\u7684\u3001\u7b26\u5408\u73b0\u4ee3 gRPC/Protobuf \u5f00\u53d1\u6700\u4f73\u5b9e\u8df5\u7684\u5b8c\u6574\u6a21\u677f\uff1a</p>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%A6%20%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#_1","title":"\ud83c\udfd7\ufe0f \u5b8c\u6574\u9879\u76ee\u7ed3\u6784","text":"<pre><code>api/\n\u251c\u2500\u2500 buf.yaml                    # Buf \u914d\u7f6e\n\u251c\u2500\u2500 buf.gen.yaml               # \u4ee3\u7801\u751f\u6210\u914d\u7f6e\n\u251c\u2500\u2500 proto/\n\u2502   \u251c\u2500\u2500 google/               # \u5982\u679c\u9700\u8981\uff0c\u653e Google API \u7c7b\u578b\n\u2502   \u251c\u2500\u2500 v1/                   # \u7248\u672c\u5316\u76ee\u5f55\n\u2502   \u2502   \u251c\u2500\u2500 service/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 user_service.proto\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 order_service.proto\n\u2502   \u2502   \u251c\u2500\u2500 types/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 user.proto\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 common.proto\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 enums.proto\n\u2502   \u2502   \u2514\u2500\u2500 errors/\n\u2502   \u2502       \u2514\u2500\u2500 error.proto\n\u2502   \u2514\u2500\u2500 v2/                   # \u672a\u6765\u7248\u672c\n\u2514\u2500\u2500 gen/                      # \u751f\u6210\u7684\u4ee3\u7801\n    \u2514\u2500\u2500 go/\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%A6%20%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#1-protov1serviceuser_serviceproto","title":"\ud83d\udcc4 1. \u4e3b\u670d\u52a1\u5b9a\u4e49\u6a21\u677f (<code>proto/v1/service/user_service.proto</code>)","text":"<pre><code>// \u6700\u4f73\u5b9e\u8df5\uff1a\u7248\u672c\u5316\u76ee\u5f55\u7ed3\u6784\nsyntax = \"proto3\";\n\n// \u5305\u540d\u91c7\u7528\u53cd\u5411\u57df\u540d+\u4ea7\u54c1+\u7248\u672c\npackage company.product.v1;\n\n// \u5bfc\u5165\u6807\u51c6\u7c7b\u578b\u548c\u672c\u5730\u7c7b\u578b\nimport \"google/protobuf/timestamp.proto\";\nimport \"google/protobuf/empty.proto\";\nimport \"google/protobuf/field_mask.proto\";\nimport \"google/api/annotations.proto\";  // \u7528\u4e8e REST \u7f51\u5173\nimport \"company/product/v1/types/user.proto\";\nimport \"company/product/v1/errors/error.proto\";\n\n// Go \u5305\u9009\u9879\uff08\u5fc5\u987b\uff09\noption go_package = \"github.com/company/product/gen/go/product/v1;productv1\";\n// \u591a\u4e2a\u8bed\u8a00\u7684\u547d\u540d\u7a7a\u95f4\noption java_multiple_files = true;\noption java_package = \"com.company.product.v1\";\noption java_outer_classname = \"UserServiceProto\";\n\n// C# \u547d\u540d\u7a7a\u95f4\noption csharp_namespace = \"Company.Product.V1\";\n\n// API \u6ce8\u91ca\uff08\u4f1a\u88ab\u5de5\u5177\u63d0\u53d6\u4e3a\u6587\u6863\uff09\noption (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_swagger) = {\n  info: {\n    title: \"User Service API\";\n    version: \"1.0.0\";\n    contact: {\n      name: \"Product Team\";\n      url: \"https://company.com\";\n      email: \"product@company.com\";\n    };\n    license: {\n      name: \"Business License\";\n      url: \"https://company.com/license\";\n    };\n  };\n  schemes: HTTPS;\n  consumes: \"application/json\";\n  produces: \"application/json\";\n  security_definitions: {\n    security: {\n      key: \"BearerAuth\";\n      value: {\n        type: TYPE_API_KEY;\n        in: IN_HEADER;\n        name: \"Authorization\";\n        description: \"Bearer token authentication\";\n      }\n    }\n  }\n};\n\n// \u670d\u52a1\u5b9a\u4e49\nservice UserService {\n  // \u7b80\u5355 CRUD \u64cd\u4f5c\n  rpc CreateUser(CreateUserRequest) returns (User) {\n    option (google.api.http) = {\n      post: \"/v1/users\"\n      body: \"*\"\n    };\n    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {\n      summary: \"Create a new user\"\n      description: \"Creates a new user in the system\"\n      tags: \"Users\"\n      security: {\n        security_requirement: {\n          key: \"BearerAuth\";\n          value: {};\n        }\n      }\n    };\n  }\n\n  rpc GetUser(GetUserRequest) returns (User) {\n    option (google.api.http) = {\n      get: \"/v1/users/{id}\"\n    };\n    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {\n      summary: \"Get user by ID\"\n      tags: \"Users\"\n    };\n  }\n\n  rpc UpdateUser(UpdateUserRequest) returns (User) {\n    option (google.api.http) = {\n      patch: \"/v1/users/{user.id}\"\n      body: \"*\"\n    };\n  }\n\n  rpc DeleteUser(DeleteUserRequest) returns (google.protobuf.Empty) {\n    option (google.api.http) = {\n      delete: \"/v1/users/{id}\"\n    };\n  }\n\n  // \u67e5\u8be2\u64cd\u4f5c\uff08\u5e26\u5206\u9875\u3001\u8fc7\u6ee4\u3001\u6392\u5e8f\uff09\n  rpc ListUsers(ListUsersRequest) returns (ListUsersResponse) {\n    option (google.api.http) = {\n      get: \"/v1/users\"\n    };\n  }\n\n  // \u6d41\u5f0f\u64cd\u4f5c\n  rpc BatchCreateUsers(stream CreateUserRequest) returns (BatchCreateUsersResponse) {\n    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {\n      summary: \"Batch create users (stream)\"\n      description: \"Accepts a stream of users to create in batch\"\n    };\n  }\n\n  rpc SearchUsers(SearchUsersRequest) returns (stream User) {\n    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {\n      summary: \"Search users with streaming response\"\n    };\n  }\n\n  // \u53cc\u5411\u6d41\uff08\u804a\u5929\u3001\u5b9e\u65f6\u66f4\u65b0\uff09\n  rpc UserChat(stream UserChatMessage) returns (stream UserChatMessage) {}\n}\n\n// \u8bf7\u6c42/\u54cd\u5e94\u6d88\u606f\u5b9a\u4e49\nmessage CreateUserRequest {\n  // \u4f7f\u7528\u5d4c\u5957\u6d88\u606f\u7ec4\u7ec7\u76f8\u5173\u5b57\u6bb5\n  User user = 1 [(validate.rules).message.required = true];\n  // \u6dfb\u52a0\u9a8c\u8bc1\u89c4\u5219\u6ce8\u91ca\uff08protoc-gen-validate\uff09\n  string request_id = 2 [\n    (validate.rules).string = {uuid: true},\n    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {\n      description: \"Unique request ID for idempotency\"\n      pattern: \"^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$\"\n    }\n  ];\n}\n\nmessage GetUserRequest {\n  // \u5b57\u6bb5\u6ce8\u91ca\u4f7f\u7528\u53cc\u659c\u7ebf\uff0c\u4f1a\u88ab\u63d0\u53d6\u5230\u6587\u6863\n  string id = 1 [\n    (validate.rules).string = {min_len: 1, max_len: 36},\n    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {\n      description: \"User UUID\"\n      example: \"\\\"550e8400-e29b-41d4-a716-446655440000\\\"\"\n    }\n  ];\n\n  // \u5b57\u6bb5\u63a9\u7801\uff0c\u7528\u4e8e\u6307\u5b9a\u8fd4\u56de\u54ea\u4e9b\u5b57\u6bb5\n  google.protobuf.FieldMask field_mask = 2;\n}\n\nmessage UpdateUserRequest {\n  User user = 1 [(validate.rules).message.required = true];\n  google.protobuf.FieldMask update_mask = 2;  // \u6307\u5b9a\u66f4\u65b0\u54ea\u4e9b\u5b57\u6bb5\n}\n\nmessage DeleteUserRequest {\n  string id = 1 [(validate.rules).string = {min_len: 1}];\n  // \u8f6f\u5220\u9664\u9009\u9879\n  bool force = 2;\n}\n\n// \u5206\u9875\u8bf7\u6c42\uff08\u6807\u51c6\u5316\uff09\nmessage ListUsersRequest {\n  // \u5206\u9875\u53c2\u6570\n  int32 page_size = 1 [\n    (validate.rules).int32 = {gte: 1, lte: 100},\n    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {\n      default: \"50\"\n    }\n  ];\n  string page_token = 2;  // \u7528\u4e8e\u7ee7\u7eed\u5206\u9875\u7684\u4ee4\u724c\n\n  // \u8fc7\u6ee4\u6761\u4ef6\n  string filter = 3;  // \u4f7f\u7528\u6807\u51c6\u8fc7\u6ee4\u8bed\u6cd5: \"active = true AND age &gt; 18\"\n\n  // \u6392\u5e8f\n  string order_by = 4;  // \u4f8b\u5982: \"name desc, created_at asc\"\n\n  // \u5b57\u6bb5\u63a9\u7801\n  google.protobuf.FieldMask field_mask = 5;\n}\n\nmessage ListUsersResponse {\n  repeated User users = 1;\n\n  // \u5206\u9875\u5143\u6570\u636e\n  string next_page_token = 2;\n  int32 total_size = 3;  // \u603b\u8bb0\u5f55\u6570\uff08\u5982\u679c\u652f\u6301\uff09\n}\n\nmessage BatchCreateUsersResponse {\n  repeated User created_users = 1;\n  int32 success_count = 2;\n  int32 failure_count = 3;\n  repeated BatchError errors = 4;  // \u6279\u5904\u7406\u4e2d\u7684\u9519\u8bef\n}\n\n// \u641c\u7d22\u8bf7\u6c42\nmessage SearchUsersRequest {\n  string query = 1;  // \u5168\u6587\u641c\u7d22\u67e5\u8be2\n\n  // \u5206\u9875\n  int32 page_size = 2;\n  string page_token = 3;\n\n  // \u641c\u7d22\u9009\u9879\n  SearchOptions options = 4;\n\n  message SearchOptions {\n    bool include_inactive = 1;\n    repeated string fields_to_search = 2;  // \u6307\u5b9a\u641c\u7d22\u54ea\u4e9b\u5b57\u6bb5\n  }\n}\n\n// \u804a\u5929\u6d88\u606f\nmessage UserChatMessage {\n  string user_id = 1 [(validate.rules).string = {min_len: 1}];\n  string message_id = 2 [(validate.rules).string.uuid = true];\n  MessageType type = 3;\n  oneof content {\n    string text = 4;\n    bytes attachment = 5;\n    Command command = 6;\n  }\n  google.protobuf.Timestamp timestamp = 7;\n  map&lt;string, string&gt; metadata = 8;  // \u6269\u5c55\u5143\u6570\u636e\n\n  enum MessageType {\n    MESSAGE_TYPE_UNSPECIFIED = 0;  // \u5fc5\u987b\u4ece0\u5f00\u59cb\n    MESSAGE_TYPE_TEXT = 1;\n    MESSAGE_TYPE_IMAGE = 2;\n    MESSAGE_TYPE_FILE = 3;\n    MESSAGE_TYPE_COMMAND = 4;\n  }\n\n  message Command {\n    string name = 1;\n    map&lt;string, string&gt; params = 2;\n  }\n}\n\n// \u6279\u5904\u7406\u9519\u8bef\nmessage BatchError {\n  int32 index = 1;  // \u8f93\u5165\u4e2d\u7684\u7d22\u5f15\n  string id = 2;    // \u7528\u6237ID\uff08\u5982\u679c\u6709\uff09\n  Error error = 3;  // \u5177\u4f53\u9519\u8bef\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%A6%20%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#2-protov1typesuserproto","title":"\ud83d\udce6 2. \u7c7b\u578b\u5b9a\u4e49\u6a21\u677f (<code>proto/v1/types/user.proto</code>)","text":"<pre><code>syntax = \"proto3\";\n\npackage company.product.v1;\n\nimport \"google/protobuf/timestamp.proto\";\nimport \"google/protobuf/wrappers.proto\";\nimport \"company/product/v1/types/enums.proto\";\nimport \"validate/validate.proto\";\n\noption go_package = \"github.com/company/product/gen/go/product/v1;productv1\";\n\n// \u7528\u6237\u5b9e\u4f53 - \u4f7f\u7528\u6e05\u6670\u7684\u5206\u5c42\u7ed3\u6784\nmessage User {\n  // \u6838\u5fc3\u6807\u8bc6\u5b57\u6bb5\n  string id = 1 [\n    (validate.rules).string = {uuid: true},\n    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {\n      description: \"Unique user identifier (UUID)\"\n      read_only: true\n    }\n  ];\n\n  // \u57fa\u672c\u4fe1\u606f\uff08\u5206\u7ec4\u7ec4\u7ec7\uff09\n  message BasicInfo {\n    string first_name = 1 [(validate.rules).string = {min_len: 1, max_len: 50}];\n    string last_name = 2 [(validate.rules).string = {min_len: 1, max_len: 50}];\n    string display_name = 3 [(validate.rules).string = {max_len: 100}];\n\n    // \u4f7f\u7528\u5305\u88c5\u7c7b\u578b\u8868\u793a\u53ef\u9009\u5b57\u6bb5\n    google.protobuf.StringValue middle_name = 4;\n    google.protobuf.StringValue title = 5;  // \u5148\u751f/\u5973\u58eb/\u535a\u58eb\u7b49\n  }\n\n  BasicInfo basic_info = 2 [(validate.rules).message.required = true];\n\n  // \u8054\u7cfb\u4fe1\u606f\n  message ContactInfo {\n    string email = 1 [\n      (validate.rules).string = {email: true, max_len: 255},\n      (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {\n        example: \"\\\"user@example.com\\\"\"\n      }\n    ];\n\n    // \u4f7f\u7528 oneof \u8868\u793a\u4e92\u65a5\u7684\u5b57\u6bb5\n    oneof primary_phone {\n      string mobile_phone = 2 [(validate.rules).string = {pattern: \"^\\\\+?[1-9]\\\\d{1,14}$\"}]; // E.164 \u683c\u5f0f\n      string landline_phone = 3;\n    }\n\n    repeated string secondary_emails = 4;\n    repeated string phone_numbers = 5;\n\n    // \u5730\u5740\n    Address primary_address = 6;\n    repeated Address alternate_addresses = 7;\n  }\n\n  ContactInfo contact_info = 3;\n\n  // \u8d26\u6237\u4fe1\u606f\n  message AccountInfo {\n    string username = 1 [(validate.rules).string = {min_len: 3, max_len: 50, pattern: \"^[a-zA-Z0-9._-]+$\"}];\n    bool email_verified = 2;\n    bool phone_verified = 3;\n    AccountStatus status = 4;\n    repeated string roles = 5;  // \u7528\u6237\u89d2\u8272\n    repeated string permissions = 6;  // \u76f4\u63a5\u6743\u9650\n  }\n\n  AccountInfo account_info = 4;\n\n  // \u5143\u6570\u636e\n  message Metadata {\n    google.protobuf.Timestamp created_at = 1;\n    google.protobuf.Timestamp updated_at = 2;\n    google.protobuf.Timestamp last_login_at = 3;\n    string created_by = 4;  // \u521b\u5efa\u8005\u7528\u6237ID\n    string updated_by = 5;  // \u6700\u540e\u66f4\u65b0\u8005\u7528\u6237ID\n\n    // \u6269\u5c55\u5b57\u6bb5\n    map&lt;string, string&gt; labels = 6;  // \u7528\u4e8e\u5206\u7c7b/\u6807\u8bb0\n    map&lt;string, string&gt; annotations = 7;  // \u975e\u6807\u8bc6\u6027\u5143\u6570\u636e\n\n    // \u7248\u672c\u63a7\u5236\n    int64 version = 8;  // \u4e50\u89c2\u9501\u7248\u672c\u53f7\n    string etag = 9;    // \u7528\u4e8e\u6761\u4ef6\u66f4\u65b0\n  }\n\n  Metadata metadata = 5;\n\n  // \u4e1a\u52a1\u7279\u5b9a\u5b57\u6bb5\n  message Preferences {\n    string language = 1 [(validate.rules).string = {len: 2}];  // ISO 639-1\n    string timezone = 2;  // \u4f8b\u5982 \"America/New_York\"\n    string locale = 3;    // \u4f8b\u5982 \"en-US\"\n    CurrencyCode default_currency = 4;\n\n    // \u901a\u77e5\u504f\u597d\n    NotificationPreferences notifications = 5;\n\n    // \u9690\u79c1\u8bbe\u7f6e\n    PrivacySettings privacy = 6;\n  }\n\n  Preferences preferences = 6;\n\n  // \u7edf\u8ba1\u4fe1\u606f\n  message Statistics {\n    int32 login_count = 1;\n    int32 failed_login_attempts = 2;\n    google.protobuf.Timestamp password_changed_at = 3;\n    int32 order_count = 4;\n    double total_spent = 5;\n  }\n\n  Statistics statistics = 7;\n}\n\n// \u5730\u5740\u7c7b\u578b\uff08\u53ef\u590d\u7528\uff09\nmessage Address {\n  // \u4f7f\u7528\u679a\u4e3e\u63d0\u9ad8\u53ef\u8bfb\u6027\n  AddressType type = 1;  // \u5bb6\u5ead\u3001\u5de5\u4f5c\u3001\u8d26\u5355\u7b49\n\n  string line1 = 2 [(validate.rules).string = {min_len: 1, max_len: 200}];\n  google.protobuf.StringValue line2 = 3;\n  string city = 4 [(validate.rules).string = {min_len: 1, max_len: 100}];\n  string state = 5 [(validate.rules).string = {min_len: 1, max_len: 100}];\n  string postal_code = 6 [(validate.rules).string = {min_len: 1, max_len: 20}];\n  string country = 7 [\n    (validate.rules).string = {len: 2},  // ISO 3166-1 alpha-2\n    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {\n      example: \"\\\"US\\\"\"\n    }\n  ];\n\n  // \u9a8c\u8bc1\u72b6\u6001\n  bool is_verified = 8;\n  google.protobuf.Timestamp verified_at = 9;\n\n  // \u5750\u6807\n  message Coordinates {\n    double latitude = 1 [(validate.rules).double = {gte: -90, lte: 90}];\n    double longitude = 2 [(validate.rules).double = {gte: -180, lte: 180}];\n  }\n\n  Coordinates coordinates = 10;\n}\n\n// \u901a\u77e5\u504f\u597d\nmessage NotificationPreferences {\n  bool email_enabled = 1;\n  bool sms_enabled = 2;\n  bool push_enabled = 3;\n\n  message ChannelPreferences {\n    bool marketing = 1;\n    bool security = 2;\n    bool updates = 3;\n    bool reminders = 4;\n  }\n\n  ChannelPreferences channels = 4;\n}\n\n// \u9690\u79c1\u8bbe\u7f6e\nmessage PrivacySettings {\n  enum ProfileVisibility {\n    PROFILE_VISIBILITY_UNSPECIFIED = 0;\n    PROFILE_VISIBILITY_PRIVATE = 1;\n    PROFILE_VISIBILITY_FRIENDS_ONLY = 2;\n    PROFILE_VISIBILITY_PUBLIC = 3;\n  }\n\n  ProfileVisibility profile_visibility = 1;\n  bool show_email = 2;\n  bool show_phone = 3;\n  bool show_last_seen = 4;\n  bool allow_search_by_email = 5;\n  bool allow_search_by_phone = 6;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%A6%20%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#3-protov1typesenumsproto","title":"\ud83c\udfaf 3. \u679a\u4e3e\u548c\u5e38\u91cf\u5b9a\u4e49 (<code>proto/v1/types/enums.proto</code>)","text":"<pre><code>syntax = \"proto3\";\n\npackage company.product.v1;\n\noption go_package = \"github.com/company/product/gen/go/product/v1;productv1\";\n\n// \u5730\u5740\u7c7b\u578b\u679a\u4e3e\nenum AddressType {\n  ADDRESS_TYPE_UNSPECIFIED = 0;  // \u5fc5\u987b\u5305\u542b UNSPECIFIED\n  ADDRESS_TYPE_HOME = 1;\n  ADDRESS_TYPE_WORK = 2;\n  ADDRESS_TYPE_BILLING = 3;\n  ADDRESS_TYPE_SHIPPING = 4;\n  ADDRESS_TYPE_OTHER = 99;\n}\n\n// \u8d26\u6237\u72b6\u6001\u679a\u4e3e\nenum AccountStatus {\n  ACCOUNT_STATUS_UNSPECIFIED = 0;\n  ACCOUNT_STATUS_PENDING = 1;      // \u7b49\u5f85\u6fc0\u6d3b\n  ACCOUNT_STATUS_ACTIVE = 2;       // \u6d3b\u8dc3\n  ACCOUNT_STATUS_SUSPENDED = 3;    // \u6682\u505c\n  ACCOUNT_STATUS_LOCKED = 4;       // \u9501\u5b9a\n  ACCOUNT_STATUS_INACTIVE = 5;     // \u4e0d\u6d3b\u8dc3\n  ACCOUNT_STATUS_DELETED = 6;      // \u5df2\u5220\u9664\n  ACCOUNT_STATUS_ARCHIVED = 7;     // \u5df2\u5f52\u6863\n}\n\n// \u7528\u6237\u89d2\u8272\uff08\u4f7f\u7528\u524d\u7f00\u907f\u514d\u547d\u540d\u51b2\u7a81\uff09\nenum UserRole {\n  USER_ROLE_UNSPECIFIED = 0;\n  USER_ROLE_GUEST = 1;\n  USER_ROLE_USER = 2;\n  USER_ROLE_ADMIN = 3;\n  USER_ROLE_SUPER_ADMIN = 4;\n  USER_ROLE_MODERATOR = 5;\n  USER_ROLE_EDITOR = 6;\n  USER_ROLE_VIEWER = 7;\n}\n\n// \u8d27\u5e01\u4ee3\u7801\uff08ISO 4217\uff09\nenum CurrencyCode {\n  CURRENCY_CODE_UNSPECIFIED = 0;\n  CURRENCY_CODE_USD = 1;  // \u7f8e\u5143\n  CURRENCY_CODE_EUR = 2;  // \u6b27\u5143\n  CURRENCY_CODE_GBP = 3;  // \u82f1\u9551\n  CURRENCY_CODE_JPY = 4;  // \u65e5\u5143\n  CURRENCY_CODE_CNY = 5;  // \u4eba\u6c11\u5e01\n}\n\n// \u6027\u522b\uff08\u6ce8\u610f\u654f\u611f\u6027\u548c\u5305\u5bb9\u6027\uff09\nenum Gender {\n  GENDER_UNSPECIFIED = 0;\n  GENDER_MALE = 1;\n  GENDER_FEMALE = 2;\n  GENDER_NON_BINARY = 3;\n  GENDER_PREFER_NOT_TO_SAY = 4;\n  GENDER_OTHER = 99;\n}\n\n// \u65f6\u95f4\u5355\u4f4d\uff08\u7528\u4e8e\u65f6\u95f4\u95f4\u9694\uff09\nenum TimeUnit {\n  TIME_UNIT_UNSPECIFIED = 0;\n  TIME_UNIT_SECOND = 1;\n  TIME_UNIT_MINUTE = 2;\n  TIME_UNIT_HOUR = 3;\n  TIME_UNIT_DAY = 4;\n  TIME_UNIT_WEEK = 5;\n  TIME_UNIT_MONTH = 6;\n  TIME_UNIT_YEAR = 7;\n}\n\n// \u6392\u5e8f\u65b9\u5411\nenum SortDirection {\n  SORT_DIRECTION_UNSPECIFIED = 0;\n  SORT_DIRECTION_ASC = 1;\n  SORT_DIRECTION_DESC = 2;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%A6%20%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#4-protov1errorserrorproto","title":"\u26a0\ufe0f 4. \u9519\u8bef\u5b9a\u4e49 (<code>proto/v1/errors/error.proto</code>)","text":"<pre><code>syntax = \"proto3\";\n\npackage company.product.v1;\n\nimport \"google/protobuf/any.proto\";\n\noption go_package = \"github.com/company/product/gen/go/product/v1;productv1\";\n\n// \u6807\u51c6\u9519\u8bef\u54cd\u5e94\nmessage Error {\n  // \u9519\u8bef\u4ee3\u7801\uff08\u673a\u5668\u53ef\u8bfb\uff09\n  string code = 1;\n\n  // \u9519\u8bef\u6d88\u606f\uff08\u4eba\u7c7b\u53ef\u8bfb\uff09\n  string message = 2;\n\n  // \u9519\u8bef\u7c7b\u578b\n  ErrorType type = 3;\n\n  // \u5177\u4f53\u5b57\u6bb5\u9519\u8bef\n  repeated FieldViolation field_violations = 4;\n\n  // \u5e2e\u52a9\u94fe\u63a5\n  string help_link = 5;\n\n  // \u8bf7\u6c42ID\uff08\u7528\u4e8e\u8ffd\u8e2a\uff09\n  string request_id = 6;\n\n  // \u6269\u5c55\u9519\u8bef\u8be6\u60c5\n  repeated google.protobuf.Any details = 7;\n\n  // \u5806\u6808\u8ddf\u8e2a\uff08\u4ec5\u5f00\u53d1\u73af\u5883\uff09\n  string stack_trace = 8;\n}\n\n// \u5b57\u6bb5\u9a8c\u8bc1\u9519\u8bef\nmessage FieldViolation {\n  string field = 1;\n  string description = 2;\n  string code = 3;  // \u5982\uff1a\"REQUIRED\", \"INVALID_EMAIL\"\n}\n\n// \u9519\u8bef\u7c7b\u578b\u679a\u4e3e\nenum ErrorType {\n  ERROR_TYPE_UNSPECIFIED = 0;\n  ERROR_TYPE_VALIDATION = 1;      // \u8f93\u5165\u9a8c\u8bc1\u5931\u8d25\n  ERROR_TYPE_NOT_FOUND = 2;       // \u8d44\u6e90\u4e0d\u5b58\u5728\n  ERROR_TYPE_ALREADY_EXISTS = 3;  // \u8d44\u6e90\u5df2\u5b58\u5728\n  ERROR_TYPE_PERMISSION_DENIED = 4; // \u6743\u9650\u4e0d\u8db3\n  ERROR_TYPE_UNAUTHENTICATED = 5; // \u672a\u8ba4\u8bc1\n  ERROR_TYPE_RESOURCE_EXHAUSTED = 6; // \u8d44\u6e90\u8017\u5c3d\n  ERROR_TYPE_FAILED_PRECONDITION = 7; // \u524d\u7f6e\u6761\u4ef6\u5931\u8d25\n  ERROR_TYPE_ABORTED = 8;         // \u64cd\u4f5c\u4e2d\u6b62\n  ERROR_TYPE_OUT_OF_RANGE = 9;    // \u8d85\u51fa\u8303\u56f4\n  ERROR_TYPE_UNIMPLEMENTED = 10;  // \u672a\u5b9e\u73b0\n  ERROR_TYPE_INTERNAL = 11;       // \u5185\u90e8\u9519\u8bef\n  ERROR_TYPE_UNAVAILABLE = 12;    // \u670d\u52a1\u4e0d\u53ef\u7528\n  ERROR_TYPE_DATA_LOSS = 13;      // \u6570\u636e\u4e22\u5931\n  ERROR_TYPE_DEADLINE_EXCEEDED = 14; // \u8d85\u65f6\n}\n\n// \u9884\u5b9a\u4e49\u9519\u8bef\u4ee3\u7801\nenum ErrorCode {\n  // \u901a\u7528\u9519\u8bef (1000-1999)\n  ERROR_CODE_UNSPECIFIED = 0;\n  ERROR_CODE_INVALID_ARGUMENT = 1000;\n  ERROR_CODE_UNAUTHENTICATED = 1001;\n  ERROR_CODE_PERMISSION_DENIED = 1002;\n  ERROR_CODE_NOT_FOUND = 1003;\n  ERROR_CODE_ALREADY_EXISTS = 1004;\n  ERROR_CODE_RESOURCE_EXHAUSTED = 1005;\n  ERROR_CODE_FAILED_PRECONDITION = 1006;\n  ERROR_CODE_ABORTED = 1007;\n  ERROR_CODE_OUT_OF_RANGE = 1008;\n  ERROR_CODE_UNIMPLEMENTED = 1009;\n  ERROR_CODE_INTERNAL = 1010;\n  ERROR_CODE_UNAVAILABLE = 1011;\n  ERROR_CODE_DATA_LOSS = 1012;\n  ERROR_CODE_DEADLINE_EXCEEDED = 1013;\n\n  // \u7528\u6237\u76f8\u5173\u9519\u8bef (2000-2999)\n  ERROR_CODE_USER_NOT_FOUND = 2000;\n  ERROR_CODE_USER_ALREADY_EXISTS = 2001;\n  ERROR_CODE_USER_INACTIVE = 2002;\n  ERROR_CODE_USER_SUSPENDED = 2003;\n  ERROR_CODE_INVALID_CREDENTIALS = 2004;\n  ERROR_CODE_ACCOUNT_LOCKED = 2005;\n  ERROR_CODE_EMAIL_NOT_VERIFIED = 2006;\n  ERROR_CODE_PHONE_NOT_VERIFIED = 2007;\n  ERROR_CODE_INVALID_PASSWORD = 2008;\n  ERROR_CODE_WEAK_PASSWORD = 2009;\n  ERROR_CODE_PASSWORD_EXPIRED = 2010;\n  ERROR_CODE_MAX_LOGIN_ATTEMPTS = 2011;\n\n  // \u9a8c\u8bc1\u9519\u8bef (3000-3999)\n  ERROR_CODE_VALIDATION_FAILED = 3000;\n  ERROR_CODE_REQUIRED_FIELD = 3001;\n  ERROR_CODE_INVALID_EMAIL = 3002;\n  ERROR_CODE_INVALID_PHONE = 3003;\n  ERROR_CODE_INVALID_DATE = 3004;\n  ERROR_CODE_INVALID_FORMAT = 3005;\n  ERROR_CODE_OUT_OF_RANGE = 3006;\n  ERROR_CODE_TOO_SHORT = 3007;\n  ERROR_CODE_TOO_LONG = 3008;\n  ERROR_CODE_PATTERN_MISMATCH = 3009;\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%A6%20%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#5-protov1typescommonproto","title":"\u2699\ufe0f 5. \u901a\u7528\u7c7b\u578b (<code>proto/v1/types/common.proto</code>)","text":"<pre><code>syntax = \"proto3\";\n\npackage company.product.v1;\n\nimport \"google/protobuf/timestamp.proto\";\nimport \"google/protobuf/duration.proto\";\n\noption go_package = \"github.com/company/product/gen/go/product/v1;productv1\";\n\n// \u5206\u9875\u54cd\u5e94\u901a\u7528\u7ed3\u6784\nmessage PaginationInfo {\n  int32 page = 1;\n  int32 page_size = 2;\n  int32 total_pages = 3;\n  int64 total_items = 4;\n  bool has_next = 5;\n  bool has_previous = 6;\n  string next_cursor = 7;\n  string previous_cursor = 8;\n}\n\n// \u65f6\u95f4\u8303\u56f4\nmessage TimeRange {\n  google.protobuf.Timestamp start_time = 1;\n  google.protobuf.Timestamp end_time = 2;\n}\n\n// \u65e5\u671f\u8303\u56f4\nmessage DateRange {\n  string start_date = 1;  // YYYY-MM-DD\n  string end_date = 2;    // YYYY-MM-DD\n}\n\n// \u5730\u7406\u4f4d\u7f6e\nmessage GeoPoint {\n  double latitude = 1;\n  double longitude = 2;\n  google.protobuf.DoubleValue altitude = 3;  // \u53ef\u9009\u9ad8\u5ea6\n}\n\n// \u8d27\u5e01\u91d1\u989d\nmessage Money {\n  // ISO 4217 \u8d27\u5e01\u4ee3\u7801\n  string currency_code = 1 [(validate.rules).string = {len: 3}];\n\n  // \u91d1\u989d\uff08\u4ee5\u6700\u5c0f\u5355\u4f4d\u8868\u793a\uff0c\u5982\u5206\uff09\n  // \u4f7f\u7528 string \u907f\u514d JavaScript \u7cbe\u5ea6\u95ee\u9898\n  string units = 2;  // \u6574\u6570\u90e8\u5206\n  int32 nanos = 3;   // \u5c0f\u6570\u90e8\u5206\uff0810^-9\uff09\n\n  // \u793a\u4f8b: $12.34 -&gt; units=\"12\", nanos=340000000\n  // \u793a\u4f8b: \u20ac0.99 -&gt; units=\"0\", nanos=990000000\n}\n\n// \u6587\u4ef6\u4fe1\u606f\nmessage FileInfo {\n  string id = 1;\n  string name = 2;\n  string mime_type = 3;\n  int64 size = 4;  // \u5b57\u8282\n  string url = 5;\n  string hash = 6;  // SHA256\n  google.protobuf.Timestamp uploaded_at = 7;\n  map&lt;string, string&gt; metadata = 8;\n}\n\n// \u5ba1\u8ba1\u4fe1\u606f\nmessage AuditInfo {\n  google.protobuf.Timestamp created_at = 1;\n  string created_by = 2;\n  google.protobuf.Timestamp updated_at = 3;\n  string updated_by = 4;\n  google.protobuf.Timestamp deleted_at = 5;\n  string deleted_by = 6;\n}\n\n// \u8d44\u6e90\u5f15\u7528\nmessage ResourceReference {\n  string type = 1;  // \u8d44\u6e90\u7c7b\u578b\uff0c\u5982 \"user\", \"order\"\n  string id = 2;    // \u8d44\u6e90ID\n  string name = 3;  // \u53ef\u9009\u663e\u793a\u540d\u79f0\n  string link = 4;  // \u53ef\u9009\u8d44\u6e90\u94fe\u63a5\n}\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%A6%20%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#6-buf-bufyaml","title":"\ud83d\udee0\ufe0f 6. Buf \u914d\u7f6e (<code>buf.yaml</code>)","text":"<pre><code>version: v1\nlint:\n  use:\n    - DEFAULT\n  except:\n    - PACKAGE_VERSION_SUFFIX  # \u5141\u8bb8 v1, v2 \u540e\u7f00\n  rpc_allow_same_request_response: true\n  rpc_allow_google_protobuf_empty_requests: true\n  rpc_allow_google_protobuf_empty_responses: true\nbreaking:\n  use:\n    - FILE\n  except:\n    - RPC_NO_DELETE  # \u5141\u8bb8\u5220\u9664RPC\uff08\u901a\u8fc7\u7248\u672c\u63a7\u5236\u7ba1\u7406\uff09\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%A6%20%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#7-bufgenyaml","title":"\ud83d\ude80 7. \u4ee3\u7801\u751f\u6210\u914d\u7f6e (<code>buf.gen.yaml</code>)","text":"<pre><code>version: v1\nmanaged:\n  enabled: true\n  override:\n    - file_option: go_package\n      value_prefix: github.com/company/product/gen/go\nplugins:\n  - name: go\n    out: gen/go\n    opt: paths=source_relative\n  - name: go-grpc\n    out: gen/go\n    opt:\n      - paths=source_relative\n      - require_unimplemented_servers=false\n  - name: grpc-gateway\n    out: gen/go\n    opt:\n      - paths=source_relative\n      - generate_unbound_methods=true\n      - allow_delete_body=true\n  - name: openapiv2\n    out: gen/openapi\n  - name: validate\n    out: gen/go\n    opt:\n      - paths=source_relative\n      - lang=go\n  # TypeScript/JavaScript\n  - name: js\n    out: gen/js\n    opt:\n      - import_style=commonjs\n      - binary_format=grpc-web\n  - name: grpc-web\n    out: gen/js\n    opt:\n      - import_style=commonjs\n      - mode=grpcwebtext\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%A6%20%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#8-makefile","title":"\ud83d\udccb 8. Makefile \u793a\u4f8b","text":"<pre><code>.PHONY: proto gen clean\n\n# Protobuf \u751f\u6210\nproto: gen\n\ngen:\n    @echo \"Generating Go code...\"\n    buf generate\n    @echo \"Formatting generated code...\"\n    go fmt ./gen/...\n\n# \u4ee3\u7801\u68c0\u67e5\nlint:\n    buf lint\n    buf breaking --against '.git#branch=main'\n\n# \u6e05\u7406\u751f\u6210\u7684\u6587\u4ef6\nclean:\n    rm -rf gen/\n\n# \u4e0b\u8f7d\u4f9d\u8d56\ndeps:\n    go install google.golang.org/protobuf/cmd/protoc-gen-go@latest\n    go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest\n    go install github.com/grpc-ecosystem/grpc-gateway/v2/protoc-gen-grpc-gateway@latest\n    go install github.com/grpc-ecosystem/grpc-gateway/v2/protoc-gen-openapiv2@latest\n    go install github.com/envoyproxy/protoc-gen-validate@latest\n    go install github.com/bufbuild/buf/cmd/buf@latest\n</code></pre>"},{"location":"wiki/Golang/Grpc/%F0%9F%93%A6%20%E5%AE%8C%E6%95%B4%E7%9A%84%20.proto%20%E6%96%87%E4%BB%B6%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%A8%A1%E6%9D%BF/#_2","title":"\ud83d\udca1 \u5173\u952e\u6700\u4f73\u5b9e\u8df5\u603b\u7ed3","text":"<ol> <li> <p>\u7248\u672c\u5316\u76ee\u5f55\uff1a\u4f7f\u7528 <code>v1/</code>, <code>v2/</code> \u76ee\u5f55\u7ba1\u7406\u4e0d\u540c API \u7248\u672c</p> </li> <li> <p>\u5305\u540d\u89c4\u8303\uff1a<code>company.product.v1</code></p> </li> <li> <p>Go \u5305\u9009\u9879\uff1a\u5fc5\u987b\u8bbe\u7f6e <code>go_package</code></p> </li> <li> <p>\u679a\u4e3e\u547d\u540d\uff1a\u4f7f\u7528 <code>TYPE_UNSPECIFIED = 0</code> \u4f5c\u4e3a\u9ed8\u8ba4\u503c</p> </li> <li> <p>\u5b57\u6bb5\u7ec4\u7ec7\uff1a\u4f7f\u7528\u5d4c\u5957\u6d88\u606f\u5206\u7ec4\u76f8\u5173\u5b57\u6bb5</p> </li> <li> <p>\u9a8c\u8bc1\u6ce8\u91ca\uff1a\u4f7f\u7528 <code>validate.rules</code> \u6dfb\u52a0\u9a8c\u8bc1\u89c4\u5219</p> </li> <li> <p>\u6587\u6863\u6ce8\u91ca\uff1a\u6240\u6709\u5b57\u6bb5\u548c\u670d\u52a1\u90fd\u6dfb\u52a0\u8be6\u7ec6\u6587\u6863</p> </li> <li> <p>\u9519\u8bef\u5904\u7406\uff1a\u5b9a\u4e49\u6807\u51c6\u7684\u9519\u8bef\u54cd\u5e94\u683c\u5f0f</p> </li> <li> <p>\u5206\u9875\u6807\u51c6\u5316\uff1a\u4f7f\u7528 <code>page_token</code> \u548c <code>page_size</code></p> </li> <li> <p>\u5de5\u5177\u96c6\u6210\uff1a\u4f7f\u7528 Buf \u8fdb\u884c linting \u548c breaking change \u68c0\u6d4b</p> </li> </ol>"},{"location":"wiki/Linux/ssh/","title":"ssh","text":""},{"location":"wiki/Linux/ssh/#ssh_1","title":"ssh\u81ea\u52a8\u767b\u9646","text":"<ol> <li>ssh-keygen \u751f\u6210\u516c\u94a5\uff0c\u79c1\u94a5</li> <li>\u62f7\u8d1d\u516c\u94a5\u5230\u670d\u52a1\u5668</li> </ol> <pre><code>#\u4f7f\u7528ssh-copy-id\nssh-copy-id -i .ssh/id_rsa.pub root@server_ip\n</code></pre> <ol> <li>ssh root@server_ip \u514d\u5bc6\u767b\u9646</li> </ol>"},{"location":"wiki/Mysql/sql%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92%E5%92%8C%E6%88%90%E6%9C%AC/","title":"Sql\u6267\u884c\u8ba1\u5212\u548c\u6210\u672c","text":""},{"location":"wiki/Mysql/sql%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92%E5%92%8C%E6%88%90%E6%9C%AC/#_1","title":"\u67e5\u8be2\u8868\u72b6\u6001","text":"<pre><code>mysql&gt; SHOW TABLE STATUS like 'contact_30'\\G\n*************************** 1. row ***************************\n           Name: contact_30\n         Engine: InnoDB\n        Version: 10\n     Row_format: Dynamic\n           Rows: 609024\n Avg_row_length: 99\n    Data_length: 60456960\nMax_data_length: 0\n   Index_length: 227622912\n      Data_free: 4194304\n Auto_increment: 4530020\n    Create_time: 2021-01-14 22:33:19\n    Update_time: 2022-09-27 11:59:45\n     Check_time: NULL\n      Collation: utf8_general_ci\n       Checksum: NULL\n Create_options: row_format=DYNAMIC\n        Comment:\n1 row in set (0.00 sec)\n</code></pre> <p>Row_format: \u6570\u636e\u683c\u5f0f\u3002 Rows \u8868\u6570\u636e\u884c\u6570\uff0cMyISAM\u7684\u8fd9\u4e2a\u6570\u636e\u884c\u6570\u7edf\u8ba1\u662f\u51c6\u786e\u7684\uff0c\u800cInnoDB\u662f\u4f30\u503c\u662f\u4e0d\u51c6\u786e\u7684\u3002\u8fd9\u91cct_user\u8868\u7684\u9884\u4f30\u884c\u6570\u662f9964\u884c\u3002 Data_length: \u8be5\u8868\u6240\u5360\u7528\u7a7a\u95f4\u7684\u5b57\u8282\u6570\u3002 60456960 bytes = 59040kb </p>"},{"location":"wiki/Mysql/sql%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92%E5%92%8C%E6%88%90%E6%9C%AC/#sql","title":"SQL\u6267\u884c\u6210\u672c\u5206\u6790","text":"<p>\u6210\u672c\u5206\u6790</p> <ol> <li>\u8ba1\u7b97\u5168\u8868\u626b\u63cf\u7684\u67e5\u8be2\u7d22\u5f15</li> </ol> <p>mysql\u6bcf\u9875\u5b58\u50a816kb\uff0cinnoDB\u9700\u898159040kb / 16=3690\u9875\u78c1\u76d8\u6765\u5b58\u50a8</p> <p>\u78c1\u76d8io\u6210\u672c = 3690*1.0(\u78c1\u76d8io\u6210\u672c) + 1.1(\u5fae\u8c03\u7cfb\u6570) = 3691.1</p> <p>cpu\u6210\u672c = 609024(rows)*0.2 + 0.01(\u5fae\u8c03\u7cfb\u6570) = 121804.81</p> <p>\u5168\u8868\u626b\u63cf\u6210\u672c = 3691.1 + 121805.8 = 125496.9</p> <ol> <li>\u8ba1\u7b97\u8d70\u7d22\u5f15\u7684\u67e5\u8be2\u6210\u672c</li> </ol> <p>mysql\u89c4\u5b9a\uff0c\u5f53\u8bfb\u53d6\u7d22\u5f15\u65f6\uff0c\u6bcf\u626b\u63cf\u4e00\u4e2a\u626b\u63cf\u533a\u95f4\u6216\u8005\u8303\u56f4\u533a\u95f4\u7684IO\u6210\u672c\uff0c\u548c\u8bfb\u53d6\u4e00\u4e2a\u9875\u9762\u7684IO\u6210\u672c\u662f\u4e00\u6837\u7684\uff0c\u90fd\u662f1.0</p> <ul> <li>\u67e5\u770b\u6267\u884c\u8ba1\u5212</li> </ul> <pre><code>mysql&gt; explain select id from contact_30 where uid = 32216965 and type = 1 and risk = 0 and status = 0 and version_id &gt; 0 and version_id &lt; 1664194189167313 and tag&amp;8 order by rank desc, version_id desc limit 500;\n+----+-------------+------------+------------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------+---------+-------------------------+-------+----------+--------------------------+\n| id | select_type | table      | partitions | type | possible_keys                                                                                                                                                                          | key                                          | key_len | ref                     | rows  | filtered | Extra                    |\n+----+-------------+------------+------------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------+---------+-------------------------+-------+----------+--------------------------+\n|  1 | SIMPLE      | contact_30 | NULL       | ref  | owner_peer_conv_type,owner_id_version_id_del_status_key,idx_owner_conv_type_del_status_version_id,idx_uid_type_risk_status_rank_version_id_tag,idx_uid_risk_status_rank_version_id_tag | idx_uid_type_risk_status_rank_version_id_tag | 14      | const,const,const,const | 18266 |    11.11 | Using where; Using index |\n+----+-------------+------------+------------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------+---------+-------------------------+-------+----------+--------------------------+\n1 row in set, 1 warning (0.01 sec)\n</code></pre> <p>io\u6210\u672c</p> <p>sql\u626b\u63cf\u4e8618266\u884c\uff0c</p> <p>\u6bcf\u4e2a\u7d22\u5f15\u503c\u91cd\u590d\u884c\u6570\u5e73\u5747\u503c\uff1a609024(Rows) / 13370(Cardinality) = 45.55</p> <p>18266 / 45.55 * 1.0 = 401 + 4(\u626b\u63cf\u4e864\u4e2a\u8303\u56f4\u533a\u95f4)</p> <p>cpu\u6210\u672c</p> <p>18266  * 0.1111 * 0.2 + 0.01 = 405.88</p> <p>\u56de\u8868\u6210\u672c</p> <p>\u56de\u8868IO\u6210\u672c = 18266  * 0.1111 * 1.0 + 1.0 = 2030.35 </p> <p>\u56de\u8868cpu\u6210\u672c = 18266  * 0.1111 * 0.2 = 405.87</p> <ul> <li>\u67e5\u770b\u7d22\u5f15\u4fe1\u606f</li> </ul> <pre><code>mysql&gt; show index from contact_30 where Key_name=\"idx_uid_type_risk_status_rank_version_id_tag\";\n+------------+------------+----------------------------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table      | Non_unique | Key_name                                     | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+------------+------------+----------------------------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| contact_30 |          1 | idx_uid_type_risk_status_rank_version_id_tag |            1 | uid         | A         |        7859 |     NULL | NULL   |      | BTREE      |         |               |\n| contact_30 |          1 | idx_uid_type_risk_status_rank_version_id_tag |            2 | type        | A         |        8818 |     NULL | NULL   |      | BTREE      |         |               |\n| contact_30 |          1 | idx_uid_type_risk_status_rank_version_id_tag |            3 | risk        | A         |        7092 |     NULL | NULL   |      | BTREE      |         |               |\n| contact_30 |          1 | idx_uid_type_risk_status_rank_version_id_tag |            4 | status      | A         |       13478 |     NULL | NULL   |      | BTREE      |         |               |\n| contact_30 |          1 | idx_uid_type_risk_status_rank_version_id_tag |            5 | rank        | A         |       13370 |     NULL | NULL   |      | BTREE      |         |               |\n| contact_30 |          1 | idx_uid_type_risk_status_rank_version_id_tag |            6 | version_id  | A         |      542032 |     NULL | NULL   |      | BTREE      |         |               |\n| contact_30 |          1 | idx_uid_type_risk_status_rank_version_id_tag |            7 | tag         | A         |      518613 |     NULL | NULL   |      | BTREE      |         |               |\n+------------+------------+----------------------------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n7 rows in set (0.00 sec)\n</code></pre>"},{"location":"wiki/Mysql/%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E5%99%A8%E4%BC%98%E5%8C%96trace/","title":"\u67e5\u8be2\u4f18\u5316\u5668\u4f18\u5316trace","text":""},{"location":"wiki/Mysql/%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E5%99%A8%E4%BC%98%E5%8C%96trace/#trace","title":"\u67e5\u8be2\u4f18\u5316\u5668\u4f18\u5316trace","text":"<pre><code>mysql&gt; set session optimizer_trace=\"enabled=on\",end_markers_in_json=on;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt; SELECT id FROM `contact_26`WHERE (uid = '45549227') AND (type = '1') AND (risk = '0') AND (status = '0') AND (version_id &gt; '1645962030000070') AND (tag&amp;'2') ORDER BY rank desc,version_id desc LIMIT 9007199254740992;\n+---------+\n| id      |\n+---------+\n| 3615097 |\n+---------+\n1 row in set (0.01 sec)\n\nmysql&gt; SELECT * FROM information_schema.OPTIMIZER_TRACE;\nmysql&gt; set session optimizer_trace=\"enabled=off\";\nQuery OK, 0 rows affected (0.00 sec)\n</code></pre>"},{"location":"wiki/Mysql/%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E5%99%A8%E4%BC%98%E5%8C%96trace/#show-status","title":"SHOW STATUS","text":"<p>\u76f8\u5173\u94fe\u63a5</p> <p>\u76f8\u5173\u94fe\u63a5</p> <p>show status\u67e5\u8be2mysql\u670d\u52a1\u72b6\u6001\u7684\u8ba1\u6570\uff0c\u6709\u7684\u53d8\u91cf\u662f\u5168\u5c40\u7684\uff0c\u6709\u7684\u53d8\u91cf\u7684session\u7ea7\u522b\u7684</p> <ol> <li>show status like 'handler_read%';</li> </ol> <pre><code>mysql&gt; SHOW SESSION STATUS LIKE 'handler_read%';\n+-----------------------+-------+\n| Variable_name         | Value |\n+-----------------------+-------+\n| Handler_read_first    | 0     |\n| Handler_read_key      | 3     |\n| Handler_read_last     | 0     |\n| Handler_read_next     | 0     |\n| Handler_read_prev     | 10114 |\n| Handler_read_rnd      | 0     |\n| Handler_read_rnd_next | 103   |\n+-----------------------+-------+\n7 rows in set (0.00 sec)\n</code></pre> <ul> <li>Handler_read_first    \u8bfb\u53d6\u7d22\u5f15\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u6b21\u6570\uff0c\u5982\u679cvalue\u6bd4\u8f83\u9ad8\uff0c\u8bf4\u660e\u5b58\u5728\u5f88\u591a\u5168\u7d22\u5f15\u626b\u63cf</li> <li>Handler_read_last    \u8bfb\u53d6\u7d22\u5f15\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u7684\u6b21\u6570</li> <li>Handler_read_key    \u6839\u636e\u7d22\u5f15\u8bfb\u53d6\u7684\u64cd\u4f5c\u6b21\u6570</li> <li>Handler_read_next   \u6309\u7167\u7d22\u5f15\u5411\u540e\u8bfb\u53d6\u884c\u6570\uff0c\u5982\u679c\u67e5\u8be2\u7684\u7d22\u5f15\u8303\u56f4\u8fc7\u5927\u3001\u6216\u8005\u6b63\u5728\u8fdb\u884c\u7d22\u5f15\u626b\u63cf\uff0cvalue\u4f1a\u589e\u9ad8</li> <li>Handler_read_prev   \u6309\u7167\u7d22\u5f15\u5411\u524d\u8bfb\u53d6\u884c\u6570</li> <li>Handler_read_rnd   </li> <li>Handler_read_rnd_next </li> </ul>"},{"location":"wiki/Mysql/%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E5%99%A8%E4%BC%98%E5%8C%96trace/#show-profilelist","title":"SHOW PROFILELIST","text":""},{"location":"wiki/Mysql/%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E5%99%A8%E4%BC%98%E5%8C%96trace/#show-profile","title":"SHOW PROFILE","text":"<ol> <li>\u5f00\u542f\u67e5\u770b\u7cfb\u7edf\u6027\u80fd</li> </ol> <pre><code>## \u5f00\u542f\nmysql&gt; select @@profiling;\n+-------------+\n| @@profiling |\n+-------------+\n|           0 |\n+-------------+\n1 row in set, 1 warning (0.01 sec)\n\nmysql&gt; set profiling=ON;\nQuery OK, 0 rows affected, 1 warning (0.00 sec)\n\nmysql&gt; select @@profiling;\n+-------------+\n| @@profiling |\n+-------------+\n|           1 |\n+-------------+\n1 row in set, 1 warning (0.00 sec)\n## \u5173\u95ed\nmysql&gt; set profiling=OFF;\nQuery OK, 0 rows affected, 1 warning (0.00 sec)\n</code></pre> <ol> <li> <p>\u6267\u884c\u67e5\u8be2\u8bed\u53e5</p> </li> <li> <p>\u67e5\u770bsql\u6267\u884c\u60c5\u51b5</p> </li> <li> <p>\u67e5\u770b\u6267\u884c\u8bb0\u5f55</p> </li> </ol> <pre><code>mysql&gt; show profiles;\n+----------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Query_ID | Duration   | Query                                                                                                                                                                                                                                                                                                        |\n+----------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|        1 | 0.00011125 | select @@profiling\n</code></pre> <ul> <li>\u67e5\u770bsql\u8be6\u60c5</li> </ul> <pre><code>mysql&gt; show profile for query 2;\n+----------------------+----------+\n| Status               | Duration |\n+----------------------+----------+\n| starting             | 0.000073 |\n| checking permissions | 0.000008 |\n| checking permissions | 0.000005 |\n| Opening tables       | 0.000052 |\n| init                 | 0.000036 |\n| System lock          | 0.000005 |\n| optimizing           | 0.000004 |\n| optimizing           | 0.000008 |\n| statistics           | 0.010685 |\n| preparing            | 0.000032 |\n| Sorting result       | 0.000008 |\n| statistics           | 0.000017 |\n| preparing            | 0.000007 |\n| executing            | 0.000006 |\n| Sending data         | 0.000019 |\n| executing            | 0.000004 |\n| Sending data         | 0.041649 |\n| end                  | 0.000021 |\n| query end            | 0.000014 |\n| closing tables       | 0.000004 |\n| removing tmp table   | 0.000008 |\n| closing tables       | 0.000009 |\n| freeing items        | 0.000027 |\n| cleaning up          | 0.000005 |\n+----------------------+----------+\n24 rows in set, 1 warning (0.00 sec)\n</code></pre> <p>\u9ed8\u8ba4\u662f\u6267\u884c\u65f6\u95f4\uff0c\u5728profile\u53ef\u4ee5\u6dfb\u52a0\u6307\u6807</p> <ul> <li>cpu</li> <li>memory</li> <li>block io</li> </ul>"},{"location":"wiki/Mysql/%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E5%99%A8%E4%BC%98%E5%8C%96trace/#show-variables","title":"SHOW VARIABLES","text":"<ul> <li>SHOW VARIABLES LIKE '%XXX%';</li> <li>SHOW GLOBAL VARIABLES LIKE '%XXX%';</li> </ul>"},{"location":"wiki/Mysql/%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E5%99%A8%E4%BC%98%E5%8C%96trace/#show-status_1","title":"SHOW STATUS","text":"<ul> <li>SHOW GLOBAL STATUS;</li> <li>SHOW SESSION STATUS;</li> </ul>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/","title":"\ud83d\udc3c Python Pandas \u5b8c\u5168\u6559\u7a0b","text":"<p>Pandas \u662f Python \u6570\u636e\u79d1\u5b66\u7684\u6838\u5fc3\u5e93\uff0c\u63d0\u4f9b\u4e86\u5feb\u901f\u3001\u7075\u6d3b\u3001\u6613\u7528\u7684\u6570\u636e\u7ed3\u6784\u3002\u4ee5\u4e0b\u662f\u5b8c\u6574\u7684\u4f7f\u7528\u6559\u7a0b\uff1a</p>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#1","title":"\ud83d\udce6 1. \u5b89\u88c5\u4e0e\u73af\u5883\u914d\u7f6e","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#pandas","title":"\u5b89\u88c5 Pandas","text":"<pre><code># \u57fa\u7840\u5b89\u88c5\npip install pandas\n\n# \u5b8c\u6574\u6570\u636e\u79d1\u5b66\u73af\u5883\npip install pandas numpy matplotlib scikit-learn\n\n# \u7279\u5b9a\u7248\u672c\npip install pandas==2.1.0\n\n# \u901a\u8fc7 conda\nconda install pandas\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_1","title":"\u5bfc\u5165\u7ea6\u5b9a","text":"<pre><code>import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# \u8bbe\u7f6e\u663e\u793a\u9009\u9879\npd.set_option('display.max_columns', None)  # \u663e\u793a\u6240\u6709\u5217\npd.set_option('display.max_rows', 100)       # \u6700\u591a\u663e\u793a100\u884c\npd.set_option('display.width', 1000)         # \u663e\u793a\u5bbd\u5ea6\npd.set_option('display.float_format', '{:.2f}'.format)  # \u6d6e\u70b9\u6570\u683c\u5f0f\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#2","title":"\ud83c\udfd7\ufe0f 2. \u6838\u5fc3\u6570\u636e\u7ed3\u6784","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#series-","title":"Series - \u4e00\u7ef4\u6570\u7ec4","text":"<pre><code># \u521b\u5efa Series\ns1 = pd.Series([1, 3, 5, np.nan, 6, 8])\ns2 = pd.Series([10, 20, 30], index=['a', 'b', 'c'])\ns3 = pd.Series({'a': 1, 'b': 2, 'c': 3})\n\nprint(s1)\nprint(f\"\u7c7b\u578b: {type(s1)}\")\nprint(f\"\u503c: {s1.values}\")\nprint(f\"\u7d22\u5f15: {s1.index}\")\n\n# Series \u64cd\u4f5c\nprint(s2 * 2)                    # \u6807\u91cf\u8fd0\u7b97\nprint(s2[s2 &gt; 15])               # \u5e03\u5c14\u7d22\u5f15\nprint(s2.get('d', default=0))    # \u5b89\u5168\u83b7\u53d6\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#dataframe-","title":"DataFrame - \u4e8c\u7ef4\u8868\u683c","text":"<pre><code># \u521b\u5efa DataFrame\n# \u65b9\u6cd51\uff1a\u4ece\u5b57\u5178\u521b\u5efa\ndf1 = pd.DataFrame({\n    '\u59d3\u540d': ['\u5f20\u4e09', '\u674e\u56db', '\u738b\u4e94', '\u8d75\u516d'],\n    '\u5e74\u9f84': [25, 30, 35, 28],\n    '\u57ce\u5e02': ['\u5317\u4eac', '\u4e0a\u6d77', '\u5e7f\u5dde', '\u6df1\u5733'],\n    '\u5de5\u8d44': [50000, 60000, 55000, 65000]\n})\n\n# \u65b9\u6cd52\uff1a\u4ece\u5217\u8868\u521b\u5efa\ndata = [\n    ['\u5f20\u4e09', 25, '\u5317\u4eac', 50000],\n    ['\u674e\u56db', 30, '\u4e0a\u6d77', 60000],\n    ['\u738b\u4e94', 35, '\u5e7f\u5dde', 55000],\n    ['\u8d75\u516d', 28, '\u6df1\u5733', 65000]\n]\ndf2 = pd.DataFrame(data, columns=['\u59d3\u540d', '\u5e74\u9f84', '\u57ce\u5e02', '\u5de5\u8d44'])\n\n# \u65b9\u6cd53\uff1a\u4ece NumPy \u6570\u7ec4\narr = np.array([\n    ['\u5f20\u4e09', 25, '\u5317\u4eac', 50000],\n    ['\u674e\u56db', 30, '\u4e0a\u6d77', 60000]\n])\ndf3 = pd.DataFrame(arr, columns=['\u59d3\u540d', '\u5e74\u9f84', '\u57ce\u5e02', '\u5de5\u8d44'])\ndf3[['\u5e74\u9f84', '\u5de5\u8d44']] = df3[['\u5e74\u9f84', '\u5de5\u8d44']].astype(int)\n\n# \u65b9\u6cd54\uff1a\u4ece\u6587\u4ef6\u8bfb\u53d6\uff08\u540e\u9762\u4f1a\u8be6\u7ec6\u8bb2\uff09\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#3","title":"\ud83d\udcc1 3. \u6570\u636e\u8bfb\u53d6\u4e0e\u5199\u5165","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_2","title":"\u8bfb\u53d6\u5404\u79cd\u683c\u5f0f\u6587\u4ef6","text":"<pre><code># CSV \u6587\u4ef6\ndf = pd.read_csv('data.csv')\ndf = pd.read_csv('data.csv', encoding='gbk')  # \u4e2d\u6587\u7f16\u7801\ndf = pd.read_csv('data.csv', sep=',')         # \u5206\u9694\u7b26\ndf = pd.read_csv('data.csv', header=0)        # \u8868\u5934\u884c\ndf = pd.read_csv('data.csv', index_col=0)     # \u7d22\u5f15\u5217\ndf = pd.read_csv('data.csv', usecols=['\u52171', '\u52172'])  # \u9009\u62e9\u5217\ndf = pd.read_csv('data.csv', nrows=1000)      # \u8bfb\u53d6\u524d1000\u884c\n\n# \u5904\u7406\u5927\u6587\u4ef6\uff08\u5206\u5757\u8bfb\u53d6\uff09\nchunk_size = 10000\nchunks = []\nfor chunk in pd.read_csv('large_data.csv', chunksize=chunk_size):\n    # \u5904\u7406\u6bcf\u4e2a\u5757\n    processed_chunk = chunk[chunk['value'] &gt; 0]\n    chunks.append(processed_chunk)\ndf = pd.concat(chunks, ignore_index=True)\n\n# Excel \u6587\u4ef6\ndf = pd.read_excel('data.xlsx', sheet_name='Sheet1')\ndf = pd.read_excel('data.xlsx', sheet_name=0)      # \u7b2c\u4e00\u4e2a\u5de5\u4f5c\u8868\ndf = pd.read_excel('data.xlsx', sheet_name=None)   # \u8bfb\u53d6\u6240\u6709\u5de5\u4f5c\u8868\n\n# JSON \u6587\u4ef6\ndf = pd.read_json('data.json')\ndf = pd.read_json('data.json', orient='records')   # \u8bb0\u5f55\u683c\u5f0f\n\n# SQL \u6570\u636e\u5e93\nimport sqlite3\nconn = sqlite3.connect('database.db')\ndf = pd.read_sql('SELECT * FROM users', conn)\ndf = pd.read_sql_table('users', conn)              # \u76f4\u63a5\u8bfb\u53d6\u8868\ndf = pd.read_sql_query('SELECT name, age FROM users WHERE age &gt; 20', conn)\n\n# \u7f51\u9875\u8868\u683c\nurl = 'https://example.com/table.html'\ntables = pd.read_html(url)  # \u8fd4\u56de DataFrame \u5217\u8868\ndf = tables[0]\n\n# Parquet \u6587\u4ef6\uff08\u9ad8\u6548\u4e8c\u8fdb\u5236\u683c\u5f0f\uff09\ndf = pd.read_parquet('data.parquet')\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_3","title":"\u5199\u5165\u6587\u4ef6","text":"<pre><code># CSV\ndf.to_csv('output.csv', index=False, encoding='utf-8-sig')  # \u4e2d\u6587\u517c\u5bb9\ndf.to_csv('output.csv', index=False, sep='|')               # \u81ea\u5b9a\u4e49\u5206\u9694\u7b26\n\n# Excel\nwith pd.ExcelWriter('output.xlsx', engine='openpyxl') as writer:\n    df.to_excel(writer, sheet_name='Sheet1', index=False)\n    # \u591a\u4e2a DataFrame \u5199\u5165\u4e0d\u540c\u5de5\u4f5c\u8868\n    df_summary.to_excel(writer, sheet_name='Summary', index=False)\n\n# JSON\ndf.to_json('output.json', orient='records', force_ascii=False)\n\n# SQL\ndf.to_sql('table_name', conn, if_exists='replace', index=False)\n\n# Parquet\ndf.to_parquet('output.parquet', compression='snappy')\n\n# \u591a\u79cd\u683c\u5f0f\u540c\u65f6\u4fdd\u5b58\ndef save_dataframe(df, filename):\n    \"\"\"\u667a\u80fd\u4fdd\u5b58 DataFrame\"\"\"\n    if filename.endswith('.csv'):\n        df.to_csv(filename, index=False)\n    elif filename.endswith('.xlsx'):\n        df.to_excel(filename, index=False)\n    elif filename.endswith('.json'):\n        df.to_json(filename, orient='records')\n    elif filename.endswith('.parquet'):\n        df.to_parquet(filename)\n    else:\n        raise ValueError(\"\u4e0d\u652f\u6301\u7684\u683c\u5f0f\")\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#4","title":"\ud83d\udd0d 4. \u6570\u636e\u67e5\u770b\u4e0e\u57fa\u672c\u4fe1\u606f","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_4","title":"\u67e5\u770b\u6570\u636e","text":"<pre><code># \u57fa\u672c\u67e5\u770b\nprint(df.head())           # \u524d5\u884c\nprint(df.head(10))         # \u524d10\u884c\nprint(df.tail())           # \u540e5\u884c\nprint(df.sample(5))        # \u968f\u673a5\u884c\nprint(df.shape)            # (\u884c\u6570, \u5217\u6570)\nprint(df.columns)          # \u5217\u540d\u5217\u8868\nprint(df.index)            # \u7d22\u5f15\nprint(df.dtypes)           # \u6bcf\u5217\u6570\u636e\u7c7b\u578b\n\n# \u8be6\u7ec6\u63cf\u8ff0\nprint(df.info())           # \u5185\u5b58\u4f7f\u7528\u548c\u6570\u636e\u7c7b\u578b\nprint(df.describe())       # \u6570\u503c\u5217\u7edf\u8ba1\nprint(df.describe(include='all'))  # \u6240\u6709\u5217\u7edf\u8ba1\nprint(df.describe(include=[np.number]))  # \u53ea\u6570\u503c\u5217\nprint(df.describe(include=[object]))     # \u53ea\u5bf9\u8c61\u5217\n\n# \u552f\u4e00\u503c\u548c\u8ba1\u6570\nprint(df['\u57ce\u5e02'].unique())          # \u552f\u4e00\u503c\u6570\u7ec4\nprint(df['\u57ce\u5e02'].nunique())         # \u552f\u4e00\u503c\u6570\u91cf\nprint(df['\u57ce\u5e02'].value_counts())    # \u503c\u8ba1\u6570\nprint(df['\u57ce\u5e02'].value_counts(normalize=True))  # \u6bd4\u4f8b\n\n# \u7f3a\u5931\u503c\u7edf\u8ba1\nprint(df.isnull().sum())            # \u6bcf\u5217\u7f3a\u5931\u503c\u6570\u91cf\nprint(df.isnull().sum().sum())      # \u603b\u7f3a\u5931\u503c\u6570\u91cf\nprint(df.isnull().mean() * 100)     # \u6bcf\u5217\u7f3a\u5931\u503c\u767e\u5206\u6bd4\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_5","title":"\u9009\u62e9\u4e0e\u7d22\u5f15","text":"<pre><code># \u5217\u9009\u62e9\ndf['\u59d3\u540d']                    # \u8fd4\u56de Series\ndf[['\u59d3\u540d', '\u5e74\u9f84']]           # \u8fd4\u56de DataFrame\ndf.loc[:, '\u59d3\u540d']             # \u4f7f\u7528 loc\ndf.iloc[:, 0]                # \u4f7f\u7528 iloc\uff0c\u7b2c\u4e00\u5217\n\n# \u884c\u9009\u62e9\ndf[0:3]                      # \u524d3\u884c\ndf.iloc[0]                   # \u7b2c\u4e00\u884c\uff08Series\uff09\ndf.iloc[[0, 2, 4]]           # \u7b2c1,3,5\u884c\ndf.loc[df['\u5e74\u9f84'] &gt; 30]       # \u6761\u4ef6\u9009\u62e9\n\n# \u884c\u548c\u5217\u540c\u65f6\u9009\u62e9\ndf.loc[df['\u5e74\u9f84'] &gt; 30, ['\u59d3\u540d', '\u57ce\u5e02']]\ndf.iloc[0:3, 1:3]\n\n# \u6761\u4ef6\u7b5b\u9009\ndf[(df['\u5e74\u9f84'] &gt; 25) &amp; (df['\u5de5\u8d44'] &gt; 55000)]      # AND\ndf[(df['\u57ce\u5e02'] == '\u5317\u4eac') | (df['\u57ce\u5e02'] == '\u4e0a\u6d77')]  # OR\ndf[~df['\u59d3\u540d'].str.contains('\u5f20')]                 # NOT\n\n# \u57fa\u4e8e\u5b57\u7b26\u4e32\u7684\u9009\u62e9\ndf[df['\u59d3\u540d'].str.startswith('\u5f20')]      # \u4ee5\"\u5f20\"\u5f00\u5934\ndf[df['\u59d3\u540d'].str.contains('\u4e09|\u56db')]     # \u5305\u542b\"\u4e09\"\u6216\"\u56db\"\ndf[df['\u57ce\u5e02'].str.lower() == 'beijing']  # \u5ffd\u7565\u5927\u5c0f\u5199\n\n# Query \u65b9\u6cd5\uff08SQL\u98ce\u683c\uff09\ndf.query('\u5e74\u9f84 &gt; 30 and \u5de5\u8d44 &gt; 50000')\ndf.query('\u57ce\u5e02 in [\"\u5317\u4eac\", \"\u4e0a\u6d77\"]')\ndf.query('\u59d3\u540d.str.contains(\"\u5f20\")', engine='python')\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#5","title":"\ud83e\uddf9 5. \u6570\u636e\u6e05\u6d17\u4e0e\u9884\u5904\u7406","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_6","title":"\u5904\u7406\u7f3a\u5931\u503c","text":"<pre><code># \u68c0\u6d4b\u7f3a\u5931\u503c\ndf.isna()\ndf.notna()\ndf.isnull()   # isna \u7684\u522b\u540d\n\n# \u5220\u9664\u7f3a\u5931\u503c\ndf.dropna()                          # \u5220\u9664\u4efb\u4f55\u5305\u542b NA \u7684\u884c\ndf.dropna(axis=1)                    # \u5220\u9664\u4efb\u4f55\u5305\u542b NA \u7684\u5217\ndf.dropna(how='all')                 # \u53ea\u5220\u9664\u5168\u4e3a NA \u7684\u884c\ndf.dropna(subset=['\u5e74\u9f84', '\u5de5\u8d44'])     # \u53ea\u5728\u7279\u5b9a\u5217\u68c0\u67e5\ndf.dropna(thresh=3)                  # \u4fdd\u7559\u81f3\u5c11\u67093\u4e2a\u975eNA\u503c\u7684\u884c\n\n# \u586b\u5145\u7f3a\u5931\u503c\ndf.fillna(0)                         # \u586b\u5145\u4e3a0\ndf.fillna(method='ffill')            # \u5411\u524d\u586b\u5145\ndf.fillna(method='bfill')            # \u5411\u540e\u586b\u5145\ndf.fillna(df.mean())                 # \u7528\u5747\u503c\u586b\u5145\u6570\u503c\u5217\ndf.fillna(df.mode().iloc[0])         # \u7528\u4f17\u6570\u586b\u5145\ndf['\u5e74\u9f84'].fillna(df['\u5e74\u9f84'].median(), inplace=True)  # \u539f\u5730\u4fee\u6539\n\n# \u63d2\u503c\ndf.interpolate()                     # \u7ebf\u6027\u63d2\u503c\ndf.interpolate(method='time')        # \u65f6\u95f4\u5e8f\u5217\u63d2\u503c\ndf.interpolate(limit=2)              # \u6700\u591a\u63d2\u503c2\u4e2a\u8fde\u7eed\u7f3a\u5931\u503c\n\n# \u9ad8\u7ea7\u7f3a\u5931\u503c\u5904\u7406\ndef handle_missing(df):\n    \"\"\"\u667a\u80fd\u5904\u7406\u7f3a\u5931\u503c\"\"\"\n    result = df.copy()\n\n    # \u6570\u503c\u5217\u7528\u4e2d\u4f4d\u6570\u586b\u5145\n    numeric_cols = result.select_dtypes(include=[np.number]).columns\n    for col in numeric_cols:\n        if result[col].isna().any():\n            result[col] = result[col].fillna(result[col].median())\n\n    # \u5206\u7c7b\u5217\u7528\u4f17\u6570\u586b\u5145\n    cat_cols = result.select_dtypes(include=['object']).columns\n    for col in cat_cols:\n        if result[col].isna().any():\n            mode_value = result[col].mode()[0] if not result[col].mode().empty else 'Unknown'\n            result[col] = result[col].fillna(mode_value)\n\n    return result\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_7","title":"\u5904\u7406\u91cd\u590d\u503c","text":"<pre><code># \u68c0\u6d4b\u91cd\u590d\u884c\ndf.duplicated()                      # \u6807\u8bb0\u91cd\u590d\u884c\ndf.duplicated(subset=['\u59d3\u540d', '\u57ce\u5e02']) # \u57fa\u4e8e\u7279\u5b9a\u5217\ndf.duplicated(keep='first')          # \u4fdd\u7559\u7b2c\u4e00\u4e2a\uff08\u9ed8\u8ba4\uff09\ndf.duplicated(keep='last')           # \u4fdd\u7559\u6700\u540e\u4e00\u4e2a\ndf.duplicated(keep=False)            # \u6807\u8bb0\u6240\u6709\u91cd\u590d\n\n# \u5220\u9664\u91cd\u590d\u884c\ndf.drop_duplicates()                 # \u5220\u9664\u5b8c\u5168\u91cd\u590d\u7684\u884c\ndf.drop_duplicates(subset=['\u59d3\u540d'])   # \u57fa\u4e8e\u59d3\u540d\u53bb\u91cd\ndf.drop_duplicates(keep='first')     # \u4fdd\u7559\u7b2c\u4e00\u4e2a\ndf.drop_duplicates(keep='last')      # \u4fdd\u7559\u6700\u540e\u4e00\u4e2a\ndf.drop_duplicates(inplace=True)     # \u539f\u5730\u4fee\u6539\n\n# \u9ad8\u7ea7\u53bb\u91cd\u7b56\u7565\ndef smart_deduplicate(df, key_columns):\n    \"\"\"\u667a\u80fd\u53bb\u91cd\uff1a\u4fdd\u7559\u6700\u65b0\u6216\u6700\u5b8c\u6574\u7684\u6570\u636e\"\"\"\n    # \u6309\u65f6\u95f4\u5012\u5e8f\u6392\u5e8f\uff08\u5047\u8bbe\u6709 update_time \u5217\uff09\n    if 'update_time' in df.columns:\n        df = df.sort_values('update_time', ascending=False)\n\n    # \u521b\u5efa\u5b8c\u6574\u5ea6\u8bc4\u5206\n    df['completeness'] = df.notna().sum(axis=1) / df.shape[1]\n\n    # \u6309\u5173\u952e\u5217\u5206\u7ec4\uff0c\u9009\u62e9\u6700\u5b8c\u6574\u7684\u6570\u636e\n    deduplicated = df.sort_values('completeness', ascending=False)\\\n                    .drop_duplicates(subset=key_columns, keep='first')\\\n                    .drop(columns=['completeness'])\n\n    return deduplicated\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_8","title":"\u6570\u636e\u7c7b\u578b\u8f6c\u6362","text":"<pre><code># \u67e5\u770b\u6570\u636e\u7c7b\u578b\nprint(df.dtypes)\n\n# \u7c7b\u578b\u8f6c\u6362\ndf['\u5e74\u9f84'] = df['\u5e74\u9f84'].astype(int)\ndf['\u5de5\u8d44'] = pd.to_numeric(df['\u5de5\u8d44'], errors='coerce')\ndf['\u65e5\u671f'] = pd.to_datetime(df['\u65e5\u671f'])\ndf['\u65e5\u671f'] = pd.to_datetime(df['\u65e5\u671f'], format='%Y-%m-%d')  # \u6307\u5b9a\u683c\u5f0f\n\n# \u5206\u7c7b\u6570\u636e\ndf['\u57ce\u5e02'] = df['\u57ce\u5e02'].astype('category')\ndf['\u57ce\u5e02_cat'] = pd.Categorical(df['\u57ce\u5e02'], categories=['\u5317\u4eac', '\u4e0a\u6d77', '\u5e7f\u5dde', '\u6df1\u5733'], ordered=True)\n\n# \u5e03\u5c14\u8f6c\u6362\ndf['\u9ad8\u5de5\u8d44'] = df['\u5de5\u8d44'] &gt; 55000\ndf['\u9ad8\u5de5\u8d44'] = df['\u9ad8\u5de5\u8d44'].astype(bool)\n\n# \u6279\u91cf\u8f6c\u6362\ndef convert_types(df):\n    \"\"\"\u667a\u80fd\u7c7b\u578b\u8f6c\u6362\"\"\"\n    result = df.copy()\n\n    # \u5c1d\u8bd5\u8f6c\u6362\u4e3a\u6570\u503c\u7c7b\u578b\n    for col in result.columns:\n        # \u8df3\u8fc7\u5df2\u7ecf\u662f\u6570\u503c\u6216\u65e5\u671f\u7c7b\u578b\u7684\u5217\n        if result[col].dtype in [np.number, 'datetime64[ns]']:\n            continue\n\n        # \u5c1d\u8bd5\u8f6c\u6362\u4e3a\u6570\u503c\n        converted = pd.to_numeric(result[col], errors='ignore')\n        if not converted is result[col]:\n            result[col] = converted\n\n        # \u5982\u679c\u8f6c\u6362\u5931\u8d25\u4e14\u770b\u8d77\u6765\u50cf\u65e5\u671f\n        elif result[col].dtype == 'object' and result[col].str.contains(r'\\d{4}-\\d{2}-\\d{2}').any():\n            try:\n                result[col] = pd.to_datetime(result[col], errors='coerce')\n            except:\n                pass\n\n    return result\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#6","title":"\ud83d\udcca 6. \u6570\u636e\u5904\u7406\u4e0e\u8f6c\u6362","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_9","title":"\u5217\u64cd\u4f5c","text":"<pre><code># \u6dfb\u52a0\u65b0\u5217\ndf['\u5e74\u85aa'] = df['\u5de5\u8d44'] * 12\ndf['\u5e74\u9f84\u7ec4'] = pd.cut(df['\u5e74\u9f84'], bins=[0, 30, 40, 100], labels=['\u9752\u5e74', '\u4e2d\u5e74', '\u8001\u5e74'])\ndf['\u5de5\u8d44\u7ea7\u522b'] = np.where(df['\u5de5\u8d44'] &gt; 60000, '\u9ad8', '\u4f4e')\n\n# \u4fee\u6539\u5217\u540d\ndf.rename(columns={'\u59d3\u540d': 'name', '\u5e74\u9f84': 'age'}, inplace=True)\ndf.columns = ['Name', 'Age', 'City', 'Salary']  # \u5168\u90e8\u91cd\u547d\u540d\ndf.columns = df.columns.str.lower()            # \u8f6c\u4e3a\u5c0f\u5199\ndf.columns = df.columns.str.replace(' ', '_')  # \u66ff\u6362\u7a7a\u683c\n\n# \u5220\u9664\u5217\ndf.drop(columns=['\u5e74\u85aa'], inplace=True)        # \u5220\u9664\u6307\u5b9a\u5217\ndf.drop(columns=df.columns[df.isna().mean() &gt; 0.5], inplace=True)  # \u5220\u9664\u7f3a\u5931\u503c\u591a\u7684\u5217\n\n# \u5217\u91cd\u6392\u5e8f\ndf = df[['\u57ce\u5e02', '\u59d3\u540d', '\u5e74\u9f84', '\u5de5\u8d44']]        # \u624b\u52a8\u91cd\u6392\ndf = df.reindex(sorted(df.columns), axis=1)    # \u6309\u5b57\u6bcd\u6392\u5e8f\n\n# \u62c6\u5206\u5217\ndf[['\u59d3', '\u540d']] = df['\u59d3\u540d'].str.split('', n=1, expand=True)\n\n# \u5408\u5e76\u5217\ndf['\u59d3\u540d_\u57ce\u5e02'] = df['\u59d3\u540d'] + '(' + df['\u57ce\u5e02'] + ')'\ndf['\u4fe1\u606f'] = df.apply(lambda row: f\"{row['\u59d3\u540d']}-{row['\u5e74\u9f84']}\", axis=1)\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_10","title":"\u884c\u64cd\u4f5c","text":"<pre><code># \u6dfb\u52a0\u884c\nnew_row = pd.Series({'\u59d3\u540d': '\u94b1\u4e03', '\u5e74\u9f84': 40, '\u57ce\u5e02': '\u676d\u5dde', '\u5de5\u8d44': 70000})\ndf = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True)\n\n# \u6279\u91cf\u6dfb\u52a0\nnew_data = pd.DataFrame({\n    '\u59d3\u540d': ['\u5b59\u516b', '\u5468\u4e5d'],\n    '\u5e74\u9f84': [45, 33],\n    '\u57ce\u5e02': ['\u5357\u4eac', '\u6210\u90fd'],\n    '\u5de5\u8d44': [72000, 58000]\n})\ndf = pd.concat([df, new_data], ignore_index=True)\n\n# \u5220\u9664\u884c\ndf.drop([0, 2], inplace=True)                  # \u5220\u9664\u7d22\u5f150\u548c2\ndf.drop(df[df['\u5e74\u9f84'] &lt; 25].index, inplace=True)  # \u6761\u4ef6\u5220\u9664\n\n# \u8fc7\u6ee4\u884c\ndf_filtered = df[df['\u5de5\u8d44'].between(50000, 60000)]  # \u8303\u56f4\u8fc7\u6ee4\ndf_filtered = df[df['\u57ce\u5e02'].isin(['\u5317\u4eac', '\u4e0a\u6d77'])]  # \u503c\u5217\u8868\u8fc7\u6ee4\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_11","title":"\u6570\u636e\u8f6c\u6362","text":"<pre><code># \u5e94\u7528\u51fd\u6570\ndf['\u5de5\u8d44_k'] = df['\u5de5\u8d44'].apply(lambda x: f\"{x/1000:.1f}k\")\ndf['\u59d3\u540d\u957f\u5ea6'] = df['\u59d3\u540d'].apply(len)\ndf[['\u5e74\u9f84', '\u5de5\u8d44']] = df[['\u5e74\u9f84', '\u5de5\u8d44']].applymap(lambda x: x * 1.1)  # \u6240\u6709\u5143\u7d20\n\n# \u5411\u91cf\u5316\u64cd\u4f5c\uff08\u66f4\u5feb\uff09\ndf['\u5de5\u8d44_\u8c03\u6574'] = df['\u5de5\u8d44'] * 1.1\ndf['\u5e74\u9f84_\u5e73\u65b9'] = np.square(df['\u5e74\u9f84'])\n\n# \u5206\u7ec4\u5e94\u7528\ndef salary_category(x):\n    if x &lt; 50000:\n        return '\u4f4e'\n    elif x &lt; 60000:\n        return '\u4e2d'\n    else:\n        return '\u9ad8'\n\ndf['\u85aa\u8d44\u7b49\u7ea7'] = df['\u5de5\u8d44'].apply(salary_category)\n\n# \u4f7f\u7528 pipe \u94fe\u5f0f\u64cd\u4f5c\ndf_processed = (df\n    .pipe(lambda d: d[d['\u5e74\u9f84'] &gt; 25])\n    .pipe(lambda d: d.assign(\u5de5\u8d44=lambda x: x['\u5de5\u8d44'] * 1.1))\n    .pipe(lambda d: d.sort_values('\u5de5\u8d44', ascending=False))\n)\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#7","title":"\ud83d\udcc8 7. \u6570\u636e\u805a\u5408\u4e0e\u5206\u7ec4","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_12","title":"\u57fa\u7840\u5206\u7ec4\u64cd\u4f5c","text":"<pre><code># \u5355\u5217\u5206\u7ec4\ngrouped = df.groupby('\u57ce\u5e02')\nprint(grouped.groups)  # \u67e5\u770b\u5206\u7ec4\n\n# \u591a\u5217\u5206\u7ec4\ngrouped = df.groupby(['\u57ce\u5e02', '\u85aa\u8d44\u7b49\u7ea7'])\n\n# \u5206\u7ec4\u7edf\u8ba1\ndf.groupby('\u57ce\u5e02')['\u5de5\u8d44'].mean()           # \u6bcf\u4e2a\u57ce\u5e02\u7684\u5e73\u5747\u5de5\u8d44\ndf.groupby('\u57ce\u5e02')['\u5e74\u9f84'].agg(['mean', 'min', 'max', 'count'])\ndf.groupby('\u57ce\u5e02').agg({'\u5de5\u8d44': 'mean', '\u5e74\u9f84': ['min', 'max']})\n\n# \u81ea\u5b9a\u4e49\u805a\u5408\u51fd\u6570\ndef range_func(x):\n    return x.max() - x.min()\n\ndf.groupby('\u57ce\u5e02').agg({\n    '\u5de5\u8d44': ['mean', range_func],\n    '\u5e74\u9f84': lambda x: x.std()\n})\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_13","title":"\u9ad8\u7ea7\u5206\u7ec4\u64cd\u4f5c","text":"<pre><code># \u5206\u7ec4\u540e\u8fc7\u6ee4\n# \u4fdd\u7559\u5e73\u5747\u5de5\u8d44\u5927\u4e8e55000\u7684\u57ce\u5e02\ndf.groupby('\u57ce\u5e02').filter(lambda x: x['\u5de5\u8d44'].mean() &gt; 55000)\n\n# \u5206\u7ec4\u540e\u8f6c\u6362\n# \u8ba1\u7b97\u6bcf\u4e2a\u57ce\u5e02\u76f8\u5bf9\u4e8e\u8be5\u57ce\u5e02\u5e73\u5747\u5de5\u8d44\u7684\u6bd4\u503c\ndf['\u76f8\u5bf9\u5de5\u8d44'] = df.groupby('\u57ce\u5e02')['\u5de5\u8d44'].transform(lambda x: x / x.mean())\n\n# \u5206\u7ec4\u6392\u540d\ndf['\u57ce\u5e02\u5185\u6392\u540d'] = df.groupby('\u57ce\u5e02')['\u5de5\u8d44'].rank(ascending=False, method='dense')\n\n# \u6eda\u52a8/\u6269\u5c55\u7a97\u53e3\u8ba1\u7b97\ndf['\u5de5\u8d44_MA3'] = df.groupby('\u57ce\u5e02')['\u5de5\u8d44'].rolling(window=3).mean().reset_index(0, drop=True)\ndf['\u5de5\u8d44_\u7d2f\u8ba1'] = df.groupby('\u57ce\u5e02')['\u5de5\u8d44'].expanding().mean().reset_index(0, drop=True)\n\n# \u5206\u7ec4\u91c7\u6837\nsampled = df.groupby('\u57ce\u5e02', group_keys=False).apply(lambda x: x.sample(min(len(x), 2)))\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_14","title":"\u900f\u89c6\u8868\u4e0e\u4ea4\u53c9\u8868","text":"<pre><code># \u900f\u89c6\u8868\uff08\u7c7b\u4f3cExcel\u6570\u636e\u900f\u89c6\u8868\uff09\npivot = pd.pivot_table(df, \n                       values='\u5de5\u8d44', \n                       index='\u57ce\u5e02', \n                       columns='\u85aa\u8d44\u7b49\u7ea7', \n                       aggfunc='mean',\n                       fill_value=0,\n                       margins=True,  # \u6dfb\u52a0\u603b\u8ba1\n                       margins_name='\u603b\u8ba1')\n\n# \u591a\u5c42\u900f\u89c6\u8868\npivot_multi = pd.pivot_table(df,\n                            values=['\u5de5\u8d44', '\u5e74\u9f84'],\n                            index=['\u57ce\u5e02', '\u85aa\u8d44\u7b49\u7ea7'],\n                            aggfunc={'\u5de5\u8d44': 'mean', '\u5e74\u9f84': ['min', 'max']})\n\n# \u4ea4\u53c9\u8868\uff08\u9891\u6570\u7edf\u8ba1\uff09\ncross = pd.crosstab(df['\u57ce\u5e02'], df['\u85aa\u8d44\u7b49\u7ea7'], normalize='index')  # \u884c\u767e\u5206\u6bd4\ncross_multi = pd.crosstab([df['\u57ce\u5e02'], df['\u5e74\u9f84\u7ec4']], df['\u85aa\u8d44\u7b49\u7ea7'])\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#8","title":"\ud83d\udd17 8. \u6570\u636e\u5408\u5e76\u4e0e\u8fde\u63a5","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_15","title":"\u5408\u5e76\u64cd\u4f5c","text":"<pre><code># \u521b\u5efa\u793a\u4f8b\u6570\u636e\ndf1 = pd.DataFrame({\n    'key': ['A', 'B', 'C', 'D'],\n    'value1': [1, 2, 3, 4]\n})\n\ndf2 = pd.DataFrame({\n    'key': ['B', 'D', 'E', 'F'],\n    'value2': [5, 6, 7, 8]\n})\n\n# 1. \u5185\u8fde\u63a5\uff08\u4ea4\u96c6\uff09\ninner = pd.merge(df1, df2, on='key', how='inner')\n\n# 2. \u5de6\u8fde\u63a5\uff08\u5de6\u8868\u5168\u90e8\uff09\nleft = pd.merge(df1, df2, on='key', how='left')\n\n# 3. \u53f3\u8fde\u63a5\uff08\u53f3\u8868\u5168\u90e8\uff09\nright = pd.merge(df1, df2, on='key', how='right')\n\n# 4. \u5916\u8fde\u63a5\uff08\u5e76\u96c6\uff09\nouter = pd.merge(df1, df2, on='key', how='outer')\n\n# 5. \u57fa\u4e8e\u591a\u4e2a\u952e\u5408\u5e76\ndf3 = pd.DataFrame({\n    'key1': ['A', 'B', 'C'],\n    'key2': ['X', 'Y', 'Z'],\n    'value': [10, 20, 30]\n})\nmulti = pd.merge(df1, df3, left_on='key', right_on='key1')\n\n# 6. \u8fde\u63a5\u6307\u793a\u5668\nmerged = pd.merge(df1, df2, on='key', how='outer', indicator=True)\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_16","title":"\u8fde\u63a5\u64cd\u4f5c","text":"<pre><code># \u7eb5\u5411\u8fde\u63a5\uff08\u5806\u53e0\uff09\ndf_top = df.head(2)\ndf_bottom = df.tail(2)\nconcatenated = pd.concat([df_top, df_bottom], axis=0)  # \u7eb5\u5411\nconcatenated = pd.concat([df_top, df_bottom], ignore_index=True)  # \u91cd\u7f6e\u7d22\u5f15\n\n# \u6a2a\u5411\u8fde\u63a5\ndf_left = df[['\u59d3\u540d', '\u5e74\u9f84']]\ndf_right = df[['\u57ce\u5e02', '\u5de5\u8d44']]\ncombined = pd.concat([df_left, df_right], axis=1)\n\n# \u4f7f\u7528 join \u65b9\u6cd5\ndf1.set_index('key', inplace=True)\ndf2.set_index('key', inplace=True)\njoined = df1.join(df2, how='inner')\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_17","title":"\u590d\u6742\u5408\u5e76\u573a\u666f","text":"<pre><code># \u5408\u5e76\u591a\u4e2aDataFrame\nfrom functools import reduce\n\ndfs = [df1, df2, df3]\nmerged_all = reduce(lambda left, right: pd.merge(left, right, on='key', how='outer'), dfs)\n\n# \u5408\u5e76\u65f6\u5904\u7406\u91cd\u590d\u5217\u540d\ndf4 = pd.DataFrame({\n    'key': ['A', 'B', 'C'],\n    'value': [100, 200, 300]\n})\n\nmerged_suffix = pd.merge(df1, df4, on='key', how='outer', suffixes=('_left', '_right'))\n\n# \u6839\u636e\u6761\u4ef6\u5408\u5e76\uff08\u7c7b\u4f3cSQL\u7684WHERE JOIN\uff09\n# \u9700\u8981\u5148\u521b\u5efa\u8fde\u63a5\u952e\u6216\u4f7f\u7528pandas\u7684merge_asof\ndf5 = pd.DataFrame({\n    'timestamp': pd.date_range('2023-01-01', periods=5, freq='H'),\n    'value': [1, 2, 3, 4, 5]\n})\n\ndf6 = pd.DataFrame({\n    'timestamp': pd.date_range('2023-01-01 00:30:00', periods=5, freq='H'),\n    'value2': [10, 20, 30, 40, 50]\n})\n\n# \u6700\u8fd1\u65f6\u95f4\u5408\u5e76\ntime_merged = pd.merge_asof(df5, df6, on='timestamp', direction='nearest')\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#9","title":"\ud83d\udcca 9. \u65f6\u95f4\u5e8f\u5217\u5904\u7406","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_18","title":"\u65f6\u95f4\u6570\u636e\u5904\u7406","text":"<pre><code># \u521b\u5efa\u65f6\u95f4\u5e8f\u5217\ndates = pd.date_range('2023-01-01', periods=10, freq='D')\nts = pd.Series(np.random.randn(10), index=dates)\n\n# \u65f6\u95f4\u7d22\u5f15\u64cd\u4f5c\nts['2023-01-05']                          # \u9009\u62e9\u7279\u5b9a\u65e5\u671f\nts['2023-01']                             # \u9009\u62e9\u6574\u4e2a\u4e00\u6708\nts['2023-01-05':'2023-01-08']              # \u9009\u62e9\u8303\u56f4\n\n# \u65f6\u95f4\u5c5e\u6027\nts.index.year                             # \u5e74\u4efd\nts.index.month                            # \u6708\u4efd\nts.index.day                              # \u65e5\u671f\nts.index.dayofweek                        # \u661f\u671f\u51e0\uff080=\u5468\u4e00\uff09\nts.index.quarter                          # \u5b63\u5ea6\n\n# \u65f6\u95f4\u91cd\u91c7\u6837\ndaily_data = pd.Series(np.random.randn(30), \n                       index=pd.date_range('2023-01-01', periods=30, freq='D'))\n\nmonthly = daily_data.resample('M').mean()                  # \u6309\u6708\u5e73\u5747\nweekly = daily_data.resample('W').sum()                    # \u6309\u5468\u6c42\u548c\nbusiness_days = daily_data.asfreq('B').fillna(method='ffill')  # \u5de5\u4f5c\u65e5\u9891\u7387\n\n# \u79fb\u52a8\u7a97\u53e3\u8ba1\u7b97\ndaily_data.rolling(window=7).mean()                       # 7\u5929\u79fb\u52a8\u5e73\u5747\ndaily_data.rolling(window=30, min_periods=1).mean()       # 30\u5929\u79fb\u52a8\u5e73\u5747\ndaily_data.expanding().mean()                             # \u6269\u5c55\u7a97\u53e3\u5e73\u5747\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_19","title":"\u65f6\u95f4\u5e8f\u5217\u5206\u6790","text":"<pre><code># \u65f6\u95f4\u5dee\u8ba1\u7b97\ndf['\u65e5\u671f'] = pd.to_datetime(df['\u65e5\u671f'])\ndf['\u5929\u6570\u5dee'] = (df['\u65e5\u671f'] - df['\u65e5\u671f'].min()).dt.days\ndf['\u6708\u6570\u5dee'] = (df['\u65e5\u671f'].dt.year - df['\u65e5\u671f'].min().year) * 12 + (df['\u65e5\u671f'].dt.month - df['\u65e5\u671f'].min().month)\n\n# \u5468\u671f\u5206\u6790\ndf['\u5e74\u4efd'] = df['\u65e5\u671f'].dt.year\ndf['\u6708\u4efd'] = df['\u65e5\u671f'].dt.month\ndf['\u5b63\u5ea6'] = df['\u65e5\u671f'].dt.quarter\ndf['\u661f\u671f'] = df['\u65e5\u671f'].dt.day_name()\n\n# \u65f6\u95f4\u5e8f\u5217\u5206\u89e3\nfrom statsmodels.tsa.seasonal import seasonal_decompose\n\nresult = seasonal_decompose(ts, model='additive', period=7)\nresult.plot()\n\n# \u65f6\u95f4\u5e8f\u5217\u7279\u5f81\u5de5\u7a0b\ndef create_time_features(df, date_col):\n    \"\"\"\u521b\u5efa\u65f6\u95f4\u7279\u5f81\"\"\"\n    df = df.copy()\n    df[f'{date_col}_year'] = df[date_col].dt.year\n    df[f'{date_col}_month'] = df[date_col].dt.month\n    df[f'{date_col}_day'] = df[date_col].dt.day\n    df[f'{date_col}_dayofweek'] = df[date_col].dt.dayofweek\n    df[f'{date_col}_quarter'] = df[date_col].dt.quarter\n    df[f'{date_col}_is_weekend'] = df[date_col].dt.dayofweek.isin([5, 6]).astype(int)\n\n    # \u5468\u671f\u7279\u5f81\n    df[f'{date_col}_sin_month'] = np.sin(2 * np.pi * df[f'{date_col}_month']/12)\n    df[f'{date_col}_cos_month'] = np.cos(2 * np.pi * df[f'{date_col}_month']/12)\n\n    return df\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#10","title":"\ud83d\udcc9 10. \u6570\u636e\u53ef\u89c6\u5316","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_20","title":"\u57fa\u7840\u7ed8\u56fe","text":"<pre><code>import matplotlib.pyplot as plt\nimport seaborn as sns\n\n# \u8bbe\u7f6e\u6837\u5f0f\nplt.style.use('seaborn-v0_8-darkgrid')\nsns.set_palette('husl')\n\n# 1. \u6298\u7ebf\u56fe\ndf.plot(x='\u65e5\u671f', y='\u5de5\u8d44', kind='line', figsize=(10, 6))\nplt.title('\u5de5\u8d44\u8d8b\u52bf\u56fe')\nplt.xlabel('\u65e5\u671f')\nplt.ylabel('\u5de5\u8d44')\nplt.show()\n\n# 2. \u67f1\u72b6\u56fe\ndf['\u57ce\u5e02'].value_counts().plot(kind='bar', figsize=(10, 6))\nplt.title('\u5404\u57ce\u5e02\u4eba\u6570\u5206\u5e03')\nplt.xlabel('\u57ce\u5e02')\nplt.ylabel('\u4eba\u6570')\nplt.xticks(rotation=45)\nplt.show()\n\n# 3. \u76f4\u65b9\u56fe\ndf['\u5e74\u9f84'].plot(kind='hist', bins=10, figsize=(10, 6), alpha=0.7)\nplt.title('\u5e74\u9f84\u5206\u5e03')\nplt.xlabel('\u5e74\u9f84')\nplt.ylabel('\u9891\u6570')\nplt.show()\n\n# 4. \u6563\u70b9\u56fe\ndf.plot(kind='scatter', x='\u5e74\u9f84', y='\u5de5\u8d44', figsize=(10, 6))\nplt.title('\u5e74\u9f84\u4e0e\u5de5\u8d44\u5173\u7cfb')\nplt.xlabel('\u5e74\u9f84')\nplt.ylabel('\u5de5\u8d44')\nplt.show()\n\n# 5. \u7bb1\u7ebf\u56fe\ndf.boxplot(column='\u5de5\u8d44', by='\u57ce\u5e02', figsize=(10, 6))\nplt.title('\u5404\u57ce\u5e02\u5de5\u8d44\u5206\u5e03')\nplt.suptitle('')  # \u79fb\u9664\u9ed8\u8ba4\u6807\u9898\nplt.xlabel('\u57ce\u5e02')\nplt.ylabel('\u5de5\u8d44')\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_21","title":"\u9ad8\u7ea7\u53ef\u89c6\u5316","text":"<pre><code># \u5b50\u56fe\nfig, axes = plt.subplots(2, 2, figsize=(15, 10))\n\ndf['\u5e74\u9f84'].plot(kind='hist', ax=axes[0, 0], title='\u5e74\u9f84\u5206\u5e03')\ndf['\u5de5\u8d44'].plot(kind='hist', ax=axes[0, 1], title='\u5de5\u8d44\u5206\u5e03')\ndf.plot(kind='scatter', x='\u5e74\u9f84', y='\u5de5\u8d44', ax=axes[1, 0], title='\u5e74\u9f84vs\u5de5\u8d44')\ndf['\u57ce\u5e02'].value_counts().plot(kind='bar', ax=axes[1, 1], title='\u57ce\u5e02\u5206\u5e03')\n\nplt.tight_layout()\nplt.show()\n\n# \u70ed\u529b\u56fe\ncorrelation = df[['\u5e74\u9f84', '\u5de5\u8d44']].corr()\nsns.heatmap(correlation, annot=True, cmap='coolwarm', center=0)\nplt.title('\u76f8\u5173\u6027\u70ed\u529b\u56fe')\nplt.show()\n\n# \u6210\u5bf9\u5173\u7cfb\u56fe\uff08Pairplot\uff09\nsns.pairplot(df[['\u5e74\u9f84', '\u5de5\u8d44']])\nplt.show()\n\n# \u5206\u7c7b\u6563\u70b9\u56fe\nsns.stripplot(x='\u57ce\u5e02', y='\u5de5\u8d44', data=df, jitter=True)\nplt.title('\u5404\u57ce\u5e02\u5de5\u8d44\u5206\u5e03')\nplt.xticks(rotation=45)\nplt.show()\n\n# \u4fdd\u5b58\u56fe\u8868\nfig = df.plot(x='\u65e5\u671f', y='\u5de5\u8d44').get_figure()\nfig.savefig('output.png', dpi=300, bbox_inches='tight')\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#11","title":"\u26a1 11. \u6027\u80fd\u4f18\u5316\u6280\u5de7","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_22","title":"\u9ad8\u6548\u6570\u636e\u5904\u7406","text":"<pre><code># 1. \u4f7f\u7528\u5411\u91cf\u5316\u64cd\u4f5c\u800c\u4e0d\u662f\u5faa\u73af\n# \u6162\nfor i in range(len(df)):\n    df.loc[i, '\u65b0\u5217'] = df.loc[i, '\u5de5\u8d44'] * 1.1\n\n# \u5feb\ndf['\u65b0\u5217'] = df['\u5de5\u8d44'] * 1.1\n\n# 2. \u4f7f\u7528 .at \u548c .iat \u8bbf\u95ee\u5355\u4e2a\u5143\u7d20\n# \u6162\ndf.loc[0, '\u5de5\u8d44'] = 60000\n\n# \u5feb\ndf.at[0, '\u5de5\u8d44'] = 60000\n\n# 3. \u4f7f\u7528\u5408\u9002\u7684\u6570\u636e\u7c7b\u578b\ndf['\u5c0f\u6574\u6570'] = df['\u5c0f\u6574\u6570'].astype(np.int8)\ndf['\u5206\u7c7b\u5217'] = df['\u5206\u7c7b\u5217'].astype('category')\n\n# 4. \u4f7f\u7528\u67e5\u8be2\u4f18\u5316\n# \u521b\u5efa\u7d22\u5f15\ndf_indexed = df.set_index('\u57ce\u5e02')\nresult = df_indexed.loc['\u5317\u4eac']  # \u5feb\u901f\u67e5\u8be2\n\n# 5. \u4f7f\u7528 chunk \u5904\u7406\u5927\u6570\u636e\ndef process_large_file(filepath):\n    chunk_size = 10000\n    results = []\n\n    for chunk in pd.read_csv(filepath, chunksize=chunk_size):\n        # \u5904\u7406\u6bcf\u4e2achunk\n        processed = chunk[chunk['value'] &gt; 0]\n        results.append(processed)\n\n    return pd.concat(results, ignore_index=True)\n\n# 6. \u4f7f\u7528 eval() \u8fdb\u884c\u8868\u8fbe\u5f0f\u8ba1\u7b97\uff08\u5927\u6570\u636e\u65f6\uff09\ndf['\u7ed3\u679c'] = pd.eval('df.\u5de5\u8d44 * df.\u5e74\u9f84 / 100')\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_23","title":"\u5185\u5b58\u4f18\u5316","text":"<pre><code>def reduce_memory_usage(df, verbose=True):\n    \"\"\"\u51cf\u5c11DataFrame\u5185\u5b58\u4f7f\u7528\"\"\"\n    numerics = ['int16', 'int32', 'int64', 'float16', 'float32', 'float64']\n    start_mem = df.memory_usage().sum() / 1024**2\n\n    for col in df.columns:\n        col_type = df[col].dtypes\n\n        if col_type in numerics:\n            c_min = df[col].min()\n            c_max = df[col].max()\n\n            if str(col_type)[:3] == 'int':\n                if c_min &gt; np.iinfo(np.int8).min and c_max &lt; np.iinfo(np.int8).max:\n                    df[col] = df[col].astype(np.int8)\n                elif c_min &gt; np.iinfo(np.int16).min and c_max &lt; np.iinfo(np.int16).max:\n                    df[col] = df[col].astype(np.int16)\n                elif c_min &gt; np.iinfo(np.int32).min and c_max &lt; np.iinfo(np.int32).max:\n                    df[col] = df[col].astype(np.int32)\n                elif c_min &gt; np.iinfo(np.int64).min and c_max &lt; np.iinfo(np.int64).max:\n                    df[col] = df[col].astype(np.int64)\n            else:\n                if c_min &gt; np.finfo(np.float32).min and c_max &lt; np.finfo(np.float32).max:\n                    df[col] = df[col].astype(np.float32)\n                else:\n                    df[col] = df[col].astype(np.float64)\n        elif col_type == 'object':\n            # \u8f6c\u6362\u4e3acategory\u5982\u679c\u552f\u4e00\u503c\u6bd4\u4f8b\u4f4e\n            num_unique_values = len(df[col].unique())\n            num_total_values = len(df[col])\n            if num_unique_values / num_total_values &lt; 0.5:\n                df[col] = df[col].astype('category')\n\n    end_mem = df.memory_usage().sum() / 1024**2\n    if verbose:\n        print(f'\u5185\u5b58\u4f7f\u7528\u4ece {start_mem:.2f} MB \u51cf\u5c11\u5230 {end_mem:.2f} MB')\n        print(f'\u51cf\u5c11\u4e86 {(100 * (start_mem - end_mem) / start_mem):.1f}%')\n\n    return df\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#12","title":"\ud83d\udccb 12. \u5b9e\u6218\u9879\u76ee\u6a21\u677f","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%90%BC%20Python%20Pandas%20%E5%AE%8C%E5%85%A8%E6%95%99%E7%A8%8B/#_24","title":"\u6570\u636e\u5206\u6790\u9879\u76ee\u6a21\u677f","text":"<pre><code>\"\"\"\n\u6570\u636e\u5206\u6790\u9879\u76ee\u6a21\u677f\n\"\"\"\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom datetime import datetime\n\nclass DataAnalysisProject:\n    \"\"\"\u6570\u636e\u5206\u6790\u9879\u76ee\u6a21\u677f\u7c7b\"\"\"\n\n    def __init__(self, data_path=None):\n        self.data_path = data_path\n        self.df = None\n        self.report = {}\n\n    def load_data(self, **kwargs):\n        \"\"\"\u52a0\u8f7d\u6570\u636e\"\"\"\n        print(\"\ud83d\udcc2 \u52a0\u8f7d\u6570\u636e...\")\n\n        if self.data_path.endswith('.csv'):\n            self.df = pd.read_csv(self.data_path, **kwargs)\n        elif self.data_path.endswith('.xlsx'):\n            self.df = pd.read_excel(self.data_path, **kwargs)\n        elif self.data_path.endswith('.json'):\n            self.df = pd.read_json(self.data_path, **kwargs)\n        else:\n            raise ValueError(\"\u4e0d\u652f\u6301\u7684\u683c\u5f0f\")\n\n        print(f\"\u2705 \u52a0\u8f7d\u5b8c\u6210: {self.df.shape[0]} \u884c, {self.df.shape\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/","title":"\ud83d\udcca Matplotlib Pyplot \u5b8c\u5168\u53ef\u89c6\u5316\u6559\u7a0b","text":"<p>Matplotlib \u662f Python \u6700\u6d41\u884c\u7684\u7ed8\u56fe\u5e93\uff0c\u800c <code>pyplot</code> \u662f\u5176\u6838\u5fc3\u63a5\u53e3\u3002\u4ee5\u4e0b\u662f\u5b8c\u6574\u7684\u53ef\u89c6\u5316\u6559\u7a0b\uff1a</p>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#1","title":"\ud83d\udce6 1. \u5b89\u88c5\u4e0e\u57fa\u7840\u8bbe\u7f6e","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#_1","title":"\u5b89\u88c5","text":"<pre><code># \u5b89\u88c5 matplotlib\npip install matplotlib\n\n# \u5b8c\u6574\u6570\u636e\u79d1\u5b66\u5957\u4ef6\npip install matplotlib numpy pandas seaborn\n\n# Jupyter \u4e2d\u663e\u793a\u56fe\u5f62\n%matplotlib inline  # \u5728 Notebook \u4e2d\u663e\u793a\n%matplotlib notebook  # \u4ea4\u4e92\u5f0f\u56fe\u5f62\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#_2","title":"\u57fa\u7840\u5bfc\u5165\u4e0e\u8bbe\u7f6e","text":"<p>\ud83d\udd25\ud83d\udd25plt.style.use\u8bbe\u7f6e\u6837\u5f0f\u4f1a\u8986\u76d6rcParams\u914d\u7f6e\uff0c\u6240\u4ee5\u9700\u8981\u63d0\u524d\u8bbe\u7f6e</p> <pre><code>import matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\n\n# \u8bbe\u7f6e\u56fe\u5f62\u6837\u5f0f\nplt.style.use('seaborn-v0_8-darkgrid')  # \u4f7f\u7528\u5185\u7f6e\u6837\u5f0f\n# \u53ef\u7528\u6837\u5f0f: 'default', 'classic', 'ggplot', 'seaborn', 'seaborn-darkgrid', etc.\n\n# \u8bbe\u7f6e\u4e2d\u6587\u5b57\u4f53\uff08\u89e3\u51b3\u4e2d\u6587\u663e\u793a\u95ee\u9898\uff09\nplt.rcParams['font.sans-serif'] = ['SimHei', 'Microsoft YaHei', 'DejaVu Sans']\nplt.rcParams['axes.unicode_minus'] = False  # \u89e3\u51b3\u8d1f\u53f7\u663e\u793a\u95ee\u9898\n\n# \u8bbe\u7f6e\u56fe\u5f62\u5c3a\u5bf8\u548cDPI\nplt.rcParams['figure.figsize'] = (10, 6)  # \u9ed8\u8ba4\u56fe\u5f62\u5c3a\u5bf8\nplt.rcParams['figure.dpi'] = 100  # \u5206\u8fa8\u7387\nplt.rcParams['savefig.dpi'] = 300  # \u4fdd\u5b58\u5206\u8fa8\u7387\n\n# \u521b\u5efa\u6570\u636e\nx = np.linspace(0, 10, 100)\ny = np.sin(x)\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#2","title":"\ud83c\udfa8 2. \u57fa\u7840\u56fe\u5f62\u7ed8\u5236","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#line-plot","title":"\u6298\u7ebf\u56fe (Line Plot)","text":"<p>linestyle\u6837\u5f0f</p> <ul> <li> <p>- : \u5b9e\u7ebf</p> </li> <li> <p>- - \uff1a\u865a\u7ebf</p> </li> <li> <p>-. \uff1a\u865a\u5b9e\u7ebf</p> </li> <li> <p>: \uff1a\u70b9\u7ebf</p> </li> </ul> <p>marker\u6837\u5f0f</p> <ul> <li> <p>o: \u5706\u70b9</p> </li> <li> <p>s: \u65b9\u5f62</p> </li> <li> <p>^\uff1a\u4e09\u89d2\u5f62</p> </li> <li> <p>D\uff1a\u83f1\u5f62</p> </li> <li> <p>*\uff1a\u4e94\u89d2\u661f</p> </li> </ul> <pre><code># \u57fa\u7840\u6298\u7ebf\u56fe\nplt.figure(figsize=(10, 6))  # \u521b\u5efa\u56fe\u5f62\n\nplt.plot(x, y, \n         label='\u6b63\u5f26\u6ce2',      # \u56fe\u4f8b\u6807\u7b7e\n         color='blue',        # \u989c\u8272\n         linewidth=2,         # \u7ebf\u5bbd\n         linestyle='-',       # \u7ebf\u578b: '-', '--', '-.', ':'\n         marker='o',          # \u6807\u8bb0\u70b9: 'o', 's', '^', 'D', '*'\n         markersize=5,        # \u6807\u8bb0\u5927\u5c0f\n         markeredgecolor='red', # \u6807\u8bb0\u8fb9\u6846\u989c\u8272\n         markerfacecolor='yellow' # \u6807\u8bb0\u586b\u5145\u989c\u8272\n        )\n\n# \u6dfb\u52a0\u6807\u9898\u548c\u6807\u7b7e\nplt.title('\u6b63\u5f26\u51fd\u6570\u56fe\u50cf', fontsize=16, fontweight='bold')\nplt.xlabel('X\u8f74', fontsize=12)\nplt.ylabel('Y\u8f74', fontsize=12)\n\n# \u6dfb\u52a0\u56fe\u4f8b\nplt.legend(loc='best', fontsize=10)\n\n# \u7f51\u683c\u7ebf\nplt.grid(True, alpha=0.3, linestyle='--')\n\n# \u8bbe\u7f6e\u5750\u6807\u8f74\u8303\u56f4\nplt.xlim(0, 10)\nplt.ylim(-1.5, 1.5)\n\n# \u8bbe\u7f6e\u523b\u5ea6\nplt.xticks(np.arange(0, 11, 1))\nplt.yticks(np.arange(-1.5, 2, 0.5))\n\n# \u663e\u793a\u56fe\u5f62\nplt.tight_layout()  # \u81ea\u52a8\u8c03\u6574\u5e03\u5c40\nplt.show()\n\n# \u591a\u7ebf\u6761\u6298\u7ebf\u56fe\nplt.figure(figsize=(10, 6))\n\ny1 = np.sin(x)\ny2 = np.cos(x)\ny3 = np.sin(x) * np.cos(x)\n\nplt.plot(x, y1, label='sin(x)', linewidth=2)\nplt.plot(x, y2, label='cos(x)', linewidth=2, linestyle='--')\nplt.plot(x, y3, label='sin(x)*cos(x)', linewidth=2, linestyle=':')\n\nplt.title('\u591a\u4e2a\u51fd\u6570\u56fe\u50cf')\nplt.xlabel('X')\nplt.ylabel('Y')\nplt.legend()\nplt.grid(True, alpha=0.3)\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#scatter-plot","title":"\u6563\u70b9\u56fe (Scatter Plot)","text":"<pre><code># \u521b\u5efa\u6570\u636e\nnp.random.seed(42)\nx_scatter = np.random.randn(100)\ny_scatter = x_scatter + np.random.randn(100) * 0.5\n\nplt.figure(figsize=(10, 6))\n\n# \u57fa\u7840\u6563\u70b9\u56fe\nplt.scatter(x_scatter, y_scatter, \n           alpha=0.6,           # \u900f\u660e\u5ea6\n           c='blue',            # \u989c\u8272\n           edgecolors='black',  # \u8fb9\u7f18\u989c\u8272\n           linewidths=0.5,      # \u8fb9\u7f18\u7ebf\u5bbd\n           s=50,                # \u70b9\u7684\u5927\u5c0f\n           marker='o',          # \u70b9\u5f62\u72b6\n           label='\u6570\u636e\u70b9'\n          )\n\nplt.title('\u6563\u70b9\u56fe\u793a\u4f8b', fontsize=14)\nplt.xlabel('X\u503c')\nplt.ylabel('Y\u503c')\nplt.legend()\nplt.grid(True, alpha=0.3)\nplt.show()\n\n# \u6c14\u6ce1\u56fe\uff08\u5927\u5c0f\u548c\u989c\u8272\u6620\u5c04\uff09\nplt.figure(figsize=(10, 6))\n\n# \u521b\u5efa\u6c14\u6ce1\u5927\u5c0f\u548c\u989c\u8272\u6570\u636e\nsize = np.random.randint(10, 300, 100)  # \u6c14\u6ce1\u5927\u5c0f\ncolors = np.random.rand(100)           # \u989c\u8272\u503c\n\n# \u4f7f\u7528\u989c\u8272\u6620\u5c04\nscatter = plt.scatter(x_scatter, y_scatter, \n                      s=size,          # \u5927\u5c0f\u6570\u7ec4\n                      c=colors,        # \u989c\u8272\u6570\u7ec4\n                      alpha=0.6,\n                      cmap='viridis',  # \u989c\u8272\u6620\u5c04\n                      edgecolors='black',\n                      linewidths=0.5\n                     )\n\n# \u6dfb\u52a0\u989c\u8272\u6761\nplt.colorbar(scatter, label='\u989c\u8272\u503c')\n\nplt.title('\u6c14\u6ce1\u56fe\uff08\u5927\u5c0f\u548c\u989c\u8272\u8868\u793a\u4e0d\u540c\u7ef4\u5ea6\uff09')\nplt.xlabel('X\u8f74')\nplt.ylabel('Y\u8f74')\nplt.grid(True, alpha=0.3)\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#bar-chart","title":"\u67f1\u72b6\u56fe (Bar Chart)","text":"<pre><code># \u521b\u5efa\u6570\u636e\ncategories = ['A', 'B', 'C', 'D', 'E']\nvalues = [23, 45, 56, 78, 33]\ncolors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7']\nerrors = [2, 3, 4, 2, 3]  # \u8bef\u5dee\u503c\n\nplt.figure(figsize=(10, 6))\n\n# \u5782\u76f4\u67f1\u72b6\u56fe\nbars = plt.bar(categories, values,\n               color=colors,           # \u989c\u8272\u5217\u8868\n               edgecolor='black',      # \u8fb9\u7f18\u989c\u8272\n               linewidth=1.5,          # \u8fb9\u7f18\u7ebf\u5bbd\n               alpha=0.8,              # \u900f\u660e\u5ea6\n               yerr=errors,            # \u8bef\u5dee\u7ebf\n               capsize=5,              # \u8bef\u5dee\u7ebf\u5e3d\u5b50\u5927\u5c0f\n               label='\u6570\u636e'\n              )\n\n# \u5728\u67f1\u5b50\u4e0a\u6dfb\u52a0\u6570\u503c\u6807\u7b7e\nfor bar in bars:\n    height = bar.get_height()\n    plt.text(bar.get_x() + bar.get_width()/2., height + 0.5,\n             f'{height}', ha='center', va='bottom', fontsize=10)\n\nplt.title('\u5782\u76f4\u67f1\u72b6\u56fe', fontsize=14, fontweight='bold')\nplt.xlabel('\u7c7b\u522b', fontsize=12)\nplt.ylabel('\u503c', fontsize=12)\nplt.ylim(0, max(values) * 1.2)  # \u8bbe\u7f6eY\u8f74\u8303\u56f4\nplt.legend()\nplt.grid(axis='y', alpha=0.3, linestyle='--')\nplt.tight_layout()\nplt.show()\n\n# \u6c34\u5e73\u67f1\u72b6\u56fe\nplt.figure(figsize=(10, 6))\n\nbars_h = plt.barh(categories, values,\n                  color=colors,\n                  edgecolor='black',\n                  linewidth=1.5,\n                  alpha=0.8)\n\n# \u6dfb\u52a0\u6570\u503c\u6807\u7b7e\nfor bar in bars_h:\n    width = bar.get_width()\n    plt.text(width + 1, bar.get_y() + bar.get_height()/2.,\n             f'{width}', ha='left', va='center', fontsize=10)\n\nplt.title('\u6c34\u5e73\u67f1\u72b6\u56fe')\nplt.xlabel('\u503c')\nplt.ylabel('\u7c7b\u522b')\nplt.xlim(0, max(values) * 1.2)\nplt.grid(axis='x', alpha=0.3)\nplt.tight_layout()\nplt.show()\n\n# \u5206\u7ec4\u67f1\u72b6\u56fe\ncategories = ['Q1', 'Q2', 'Q3', 'Q4']\nproduct_a = [23, 34, 25, 40]\nproduct_b = [30, 28, 35, 30]\nproduct_c = [25, 32, 28, 35]\n\nx = np.arange(len(categories))\nwidth = 0.25  # \u67f1\u5bbd\n\nplt.figure(figsize=(10, 6))\n\nplt.bar(x - width, product_a, width, label='\u4ea7\u54c1A', color='#FF6B6B', alpha=0.8)\nplt.bar(x, product_b, width, label='\u4ea7\u54c1B', color='#4ECDC4', alpha=0.8)\nplt.bar(x + width, product_c, width, label='\u4ea7\u54c1C', color='#45B7D1', alpha=0.8)\n\nplt.title('\u5206\u7ec4\u67f1\u72b6\u56fe\uff08\u5b63\u5ea6\u9500\u91cf\uff09')\nplt.xlabel('\u5b63\u5ea6')\nplt.ylabel('\u9500\u91cf')\nplt.xticks(x, categories)\nplt.legend()\nplt.grid(axis='y', alpha=0.3)\nplt.tight_layout()\nplt.show()\n\n# \u5806\u53e0\u67f1\u72b6\u56fe\nplt.figure(figsize=(10, 6))\n\nplt.bar(categories, product_a, label='\u4ea7\u54c1A', color='#FF6B6B', alpha=0.8)\nplt.bar(categories, product_b, bottom=product_a, label='\u4ea7\u54c1B', color='#4ECDC4', alpha=0.8)\nplt.bar(categories, product_c, bottom=np.array(product_a)+np.array(product_b), \n        label='\u4ea7\u54c1C', color='#45B7D1', alpha=0.8)\n\nplt.title('\u5806\u53e0\u67f1\u72b6\u56fe\uff08\u5b63\u5ea6\u603b\u9500\u91cf\uff09')\nplt.xlabel('\u5b63\u5ea6')\nplt.ylabel('\u603b\u9500\u91cf')\nplt.legend()\nplt.grid(axis='y', alpha=0.3)\nplt.tight_layout()\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#histogram","title":"\u76f4\u65b9\u56fe (Histogram)","text":"<pre><code># \u521b\u5efa\u6b63\u6001\u5206\u5e03\u6570\u636e\nnp.random.seed(42)\ndata = np.random.normal(0, 1, 1000)\ndata2 = np.random.normal(2, 1.5, 800)\n\nplt.figure(figsize=(12, 5))\n\n# \u5b50\u56fe1\uff1a\u57fa\u7840\u76f4\u65b9\u56fe\nplt.subplot(1, 2, 1)\nplt.hist(data, \n         bins=30,                # \u67f1\u7684\u6570\u91cf\u6216\u8fb9\u754c\n         color='skyblue',        # \u989c\u8272\n         edgecolor='black',      # \u8fb9\u7f18\u989c\u8272\n         alpha=0.7,              # \u900f\u660e\u5ea6\n         density=True,           # \u663e\u793a\u5bc6\u5ea6\u800c\u4e0d\u662f\u8ba1\u6570\n         label='\u6570\u636e\u5206\u5e03'\n        )\n\n# \u6dfb\u52a0\u7406\u8bba\u6b63\u6001\u5206\u5e03\u66f2\u7ebf\nfrom scipy.stats import norm\nx = np.linspace(-4, 4, 100)\nplt.plot(x, norm.pdf(x, 0, 1), 'r-', linewidth=2, label='\u7406\u8bba\u5206\u5e03')\n\nplt.title('\u76f4\u65b9\u56fe\uff08\u5e26\u5bc6\u5ea6\u66f2\u7ebf\uff09')\nplt.xlabel('\u503c')\nplt.ylabel('\u5bc6\u5ea6')\nplt.legend()\nplt.grid(alpha=0.3)\n\n# \u5b50\u56fe2\uff1a\u591a\u4e2a\u6570\u636e\u96c6\u7684\u76f4\u65b9\u56fe\nplt.subplot(1, 2, 2)\nplt.hist([data, data2], \n         bins=30,\n         color=['skyblue', 'lightcoral'],\n         edgecolor='black',\n         alpha=0.7,\n         density=True,\n         label=['\u6570\u636e\u96c61', '\u6570\u636e\u96c62'],\n         stacked=True  # \u5806\u53e0\u663e\u793a\n        )\n\nplt.title('\u591a\u6570\u636e\u96c6\u76f4\u65b9\u56fe')\nplt.xlabel('\u503c')\nplt.ylabel('\u5bc6\u5ea6')\nplt.legend()\nplt.grid(alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n\n# \u7d2f\u79ef\u76f4\u65b9\u56fe\nplt.figure(figsize=(10, 6))\n\nplt.hist(data, \n         bins=30,\n         color='lightgreen',\n         edgecolor='black',\n         alpha=0.7,\n         density=True,\n         cumulative=True,  # \u7d2f\u79ef\u5206\u5e03\n         histtype='step',  # \u7ebf\u578b\n         linewidth=2,\n         label='\u7d2f\u79ef\u5206\u5e03'\n        )\n\nplt.title('\u7d2f\u79ef\u5206\u5e03\u76f4\u65b9\u56fe')\nplt.xlabel('\u503c')\nplt.ylabel('\u7d2f\u79ef\u6982\u7387')\nplt.legend()\nplt.grid(alpha=0.3)\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#box-plot","title":"\u7bb1\u7ebf\u56fe (Box Plot)","text":"<pre><code># \u521b\u5efa\u6570\u636e\nnp.random.seed(42)\ndata_box = [np.random.normal(0, 1, 100),\n            np.random.normal(2, 1.5, 100),\n            np.random.normal(-1, 0.8, 100),\n            np.random.normal(3, 2, 100)]\n\nlabels = ['\u7ec4A', '\u7ec4B', '\u7ec4C', '\u7ec4D']\n\nplt.figure(figsize=(10, 6))\n\n# \u57fa\u7840\u7bb1\u7ebf\u56fe\nbp = plt.boxplot(data_box,\n                 labels=labels,\n                 patch_artist=True,  # \u586b\u5145\u989c\u8272\n                 notch=True,         # \u663e\u793a\u51f9\u53e3\n                 showmeans=True,     # \u663e\u793a\u5747\u503c\n                 meanline=True,      # \u5747\u503c\u7ebf\n                 showfliers=True     # \u663e\u793a\u5f02\u5e38\u503c\n                )\n\n# \u81ea\u5b9a\u4e49\u989c\u8272\ncolors = ['lightblue', 'lightgreen', 'lightcoral', 'lightsalmon']\nfor patch, color in zip(bp['boxes'], colors):\n    patch.set_facecolor(color)\n    patch.set_alpha(0.6)\n\n# \u8bbe\u7f6e\u4e2d\u4f4d\u6570\u7ebf\u989c\u8272\nfor median in bp['medians']:\n    median.set(color='red', linewidth=2)\n\n# \u8bbe\u7f6e\u5747\u503c\u7ebf\nfor mean in bp['means']:\n    mean.set(color='green', linewidth=2, linestyle='--')\n\nplt.title('\u7bb1\u7ebf\u56fe\uff08\u663e\u793a\u5747\u503c\u548c\u4e2d\u4f4d\u6570\uff09')\nplt.ylabel('\u6570\u503c')\nplt.grid(axis='y', alpha=0.3)\nplt.tight_layout()\nplt.show()\n\n# \u5c0f\u63d0\u7434\u56fe\uff08\u589e\u5f3a\u7248\u7bb1\u7ebf\u56fe\uff09\nfrom matplotlib import cm\n\nplt.figure(figsize=(10, 6))\n\n# \u4f7f\u7528 seaborn \u66f4\u7b80\u5355\uff0c\u8fd9\u91cc\u7528 matplotlib \u5b9e\u73b0\nparts = plt.violinplot(data_box, showmeans=False, showmedians=True)\n\n# \u81ea\u5b9a\u4e49\u989c\u8272\nfor pc, color in zip(parts['bodies'], colors):\n    pc.set_facecolor(color)\n    pc.set_alpha(0.6)\n\nplt.xticks(range(1, len(labels) + 1), labels)\nplt.title('\u5c0f\u63d0\u7434\u56fe')\nplt.ylabel('\u6570\u503c')\nplt.grid(axis='y', alpha=0.3)\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#pie-chart","title":"\u997c\u56fe (Pie Chart)","text":"<pre><code># \u521b\u5efa\u6570\u636e\nsizes = [15, 30, 45, 10]\nlabels = ['\u82f9\u679c', '\u9999\u8549', '\u6a59\u5b50', '\u5176\u4ed6']\ncolors = ['#FF9999', '#66B2FF', '#99FF99', '#FFCC99']\nexplode = (0, 0.1, 0, 0)  # \u7a81\u51fa\u663e\u793a\u7b2c\u4e8c\u5757\n\nplt.figure(figsize=(8, 8))\n\n# \u57fa\u7840\u997c\u56fe\nwedges, texts, autotexts = plt.pie(sizes,\n                                   explode=explode,\n                                   labels=labels,\n                                   colors=colors,\n                                   autopct='%1.1f%%',  # \u767e\u5206\u6bd4\u683c\u5f0f\n                                   shadow=True,        # \u9634\u5f71\n                                   startangle=90,      # \u8d77\u59cb\u89d2\u5ea6\n                                   textprops={'fontsize': 12}\n                                  )\n\n# \u81ea\u5b9a\u4e49\u6587\u672c\nfor autotext in autotexts:\n    autotext.set_color('white')\n    autotext.set_fontsize(10)\n    autotext.set_fontweight('bold')\n\nplt.title('\u6c34\u679c\u9500\u552e\u5360\u6bd4', fontsize=14, fontweight='bold')\nplt.axis('equal')  # \u4fdd\u8bc1\u662f\u5706\u5f62\nplt.legend(wedges, labels, title=\"\u6c34\u679c\u79cd\u7c7b\", loc=\"center left\", bbox_to_anchor=(1, 0, 0.5, 1))\nplt.tight_layout()\nplt.show()\n\n# \u73af\u5f62\u56fe\nplt.figure(figsize=(8, 8))\n\n# \u5185\u73af\nplt.pie(sizes, \n        colors=colors,\n        startangle=90,\n        wedgeprops=dict(width=0.3, edgecolor='w')\n       )\n\n# \u5916\u73af\nplt.pie([i*2 for i in sizes], \n        colors=colors,\n        radius=0.7,\n        startangle=90,\n        wedgeprops=dict(width=0.3, edgecolor='w')\n       )\n\nplt.title('\u73af\u5f62\u56fe\u793a\u4f8b')\nplt.axis('equal')\nplt.legend(labels, loc='upper right')\nplt.tight_layout()\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#3","title":"\ud83d\udcc8 3. \u9ad8\u7ea7\u56fe\u5f62\u529f\u80fd","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#subplots","title":"\u5b50\u56fe\u7cfb\u7edf (Subplots)","text":"<pre><code># \u65b9\u6cd51\uff1a\u4f7f\u7528 plt.subplot()\nplt.figure(figsize=(12, 8))\n\n# 2x2 \u7f51\u683c\nplt.subplot(2, 2, 1)  # (\u884c, \u5217, \u4f4d\u7f6e)\nx = np.linspace(0, 10, 100)\nplt.plot(x, np.sin(x), 'b-')\nplt.title('\u6b63\u5f26\u51fd\u6570')\nplt.grid(True, alpha=0.3)\n\nplt.subplot(2, 2, 2)\nplt.plot(x, np.cos(x), 'r--')\nplt.title('\u4f59\u5f26\u51fd\u6570')\nplt.grid(True, alpha=0.3)\n\nplt.subplot(2, 2, 3)\nplt.scatter(np.random.randn(100), np.random.randn(100), alpha=0.6)\nplt.title('\u968f\u673a\u6563\u70b9\u56fe')\nplt.grid(True, alpha=0.3)\n\nplt.subplot(2, 2, 4)\ncategories = ['A', 'B', 'C', 'D']\nvalues = [20, 35, 30, 15]\nplt.bar(categories, values, color=['red', 'green', 'blue', 'yellow'])\nplt.title('\u67f1\u72b6\u56fe')\nplt.grid(axis='y', alpha=0.3)\n\nplt.suptitle('\u591a\u5b50\u56fe\u793a\u4f8b', fontsize=16, fontweight='bold')\nplt.tight_layout()\nplt.show()\n\n# \u65b9\u6cd52\uff1a\u4f7f\u7528 plt.subplots()\uff08\u63a8\u8350\uff09\nfig, axes = plt.subplots(2, 3, figsize=(15, 10), sharex=False, sharey=False)\n\n# \u8bbf\u95ee\u5404\u4e2a\u5b50\u56fe\naxes[0, 0].plot(x, np.sin(x), 'b-')\naxes[0, 0].set_title('\u6b63\u5f26\u51fd\u6570')\naxes[0, 0].grid(True, alpha=0.3)\n\naxes[0, 1].plot(x, np.cos(x), 'r--')\naxes[0, 1].set_title('\u4f59\u5f26\u51fd\u6570')\naxes[0, 1].grid(True, alpha=0.3)\n\naxes[0, 2].scatter(np.random.randn(100), np.random.randn(100), alpha=0.6)\naxes[0, 2].set_title('\u6563\u70b9\u56fe')\naxes[0, 2].grid(True, alpha=0.3)\n\naxes[1, 0].bar(categories, values)\naxes[1, 0].set_title('\u67f1\u72b6\u56fe')\naxes[1, 0].grid(axis='y', alpha=0.3)\n\naxes[1, 1].hist(np.random.randn(1000), bins=30, alpha=0.7, edgecolor='black')\naxes[1, 1].set_title('\u76f4\u65b9\u56fe')\naxes[1, 1].grid(True, alpha=0.3)\n\naxes[1, 2].pie(sizes, labels=labels, autopct='%1.1f%%')\naxes[1, 2].set_title('\u997c\u56fe')\n\n# \u8bbe\u7f6e\u603b\u6807\u9898\nfig.suptitle('\u9ad8\u7ea7\u5b50\u56fe\u5e03\u5c40', fontsize=16, fontweight='bold', y=1.02)\n\nplt.tight_layout()\nplt.show()\n\n# \u590d\u6742\u5b50\u56fe\u5e03\u5c40\nfig = plt.figure(figsize=(12, 8))\n\n# \u4f7f\u7528 GridSpec \u521b\u5efa\u590d\u6742\u5e03\u5c40\ngs = fig.add_gridspec(3, 3)\n\n# \u5360\u636e\u7b2c\u4e00\u884c\u6240\u6709\u5217\nax1 = fig.add_subplot(gs[0, :])\nax1.plot(x, np.sin(x) * np.cos(x), 'g-')\nax1.set_title('\u7b2c\u4e00\u884c\uff1a\u5b8c\u6574\u5bbd\u5ea6')\nax1.grid(True, alpha=0.3)\n\n# \u7b2c\u4e8c\u884c\u7b2c\u4e00\u5217\uff0c\u5360\u4e24\u884c\u9ad8\nax2 = fig.add_subplot(gs[1:, 0])\nax2.scatter(np.random.randn(50), np.random.randn(50), c='red', alpha=0.6)\nax2.set_title('\u7b2c\u4e8c\u5217\uff1a\u4e24\u884c\u9ad8\u5ea6')\n\n# \u7b2c\u4e8c\u884c\u7b2c\u4e8c\u3001\u4e09\u5217\nax3 = fig.add_subplot(gs[1, 1])\nax3.bar(['A', 'B', 'C'], [10, 20, 15])\nax3.set_title('\u67f1\u72b6\u56fe')\n\nax4 = fig.add_subplot(gs[1, 2])\nax4.hist(np.random.randn(500), bins=20, alpha=0.7, color='orange')\nax4.set_title('\u76f4\u65b9\u56fe')\n\n# \u7b2c\u4e09\u884c\u7b2c\u4e8c\u3001\u4e09\u5217\nax5 = fig.add_subplot(gs[2, 1:])\nax5.plot(x, np.tan(x), 'purple')\nax5.set_title('\u7b2c\u4e09\u884c\uff1a\u4e24\u5217\u5bbd\u5ea6')\nax5.grid(True, alpha=0.3)\nax5.set_ylim(-10, 10)\n\nplt.suptitle('\u590d\u6742\u7f51\u683c\u5e03\u5c40\u793a\u4f8b', fontsize=16, fontweight='bold')\nplt.tight_layout()\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#y","title":"\u53ccY\u8f74\u56fe\u5f62","text":"<pre><code># \u521b\u5efa\u6570\u636e\nx = np.arange(0, 10, 0.1)\ny1 = np.sin(x)\ny2 = np.exp(x/3)\n\nfig, ax1 = plt.subplots(figsize=(10, 6))\n\n# \u7b2c\u4e00\u4e2aY\u8f74\ncolor1 = 'tab:blue'\nax1.set_xlabel('X\u8f74')\nax1.set_ylabel('sin(x)', color=color1)\nline1 = ax1.plot(x, y1, color=color1, linewidth=2, label='sin(x)')\nax1.tick_params(axis='y', labelcolor=color1)\n\n# \u7b2c\u4e8c\u4e2aY\u8f74\nax2 = ax1.twinx()\ncolor2 = 'tab:red'\nax2.set_ylabel('exp(x/3)', color=color2)\nline2 = ax2.plot(x, y2, color=color2, linewidth=2, linestyle='--', label='exp(x/3)')\nax2.tick_params(axis='y', labelcolor=color2)\n\n# \u7ec4\u5408\u56fe\u4f8b\nlines = line1 + line2\nlabels = [l.get_label() for l in lines]\nax1.legend(lines, labels, loc='upper left')\n\nplt.title('\u53ccY\u8f74\u56fe\u5f62\u793a\u4f8b')\nplt.grid(True, alpha=0.3)\nplt.tight_layout()\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#3d","title":"3D \u56fe\u5f62","text":"<pre><code>from mpl_toolkits.mplot3d import Axes3D\n\n# \u521b\u5efa\u6570\u636e\nx = np.linspace(-5, 5, 100)\ny = np.linspace(-5, 5, 100)\nX, Y = np.meshgrid(x, y)\nZ = np.sin(np.sqrt(X**2 + Y**2))\n\nfig = plt.figure(figsize=(14, 10))\n\n# 3D\u66f2\u9762\u56fe\nax1 = fig.add_subplot(221, projection='3d')\nsurf = ax1.plot_surface(X, Y, Z, cmap='viridis', alpha=0.8)\nax1.set_title('3D\u66f2\u9762\u56fe')\nax1.set_xlabel('X\u8f74')\nax1.set_ylabel('Y\u8f74')\nax1.set_zlabel('Z\u8f74')\nfig.colorbar(surf, ax=ax1, shrink=0.5, aspect=5)\n\n# 3D\u7ebf\u6846\u56fe\nax2 = fig.add_subplot(222, projection='3d')\nax2.plot_wireframe(X, Y, Z, color='blue', alpha=0.6)\nax2.set_title('3D\u7ebf\u6846\u56fe')\nax2.set_xlabel('X\u8f74')\nax2.set_ylabel('Y\u8f74')\nax2.set_zlabel('Z\u8f74')\n\n# 3D\u6563\u70b9\u56fe\nax3 = fig.add_subplot(223, projection='3d')\nnp.random.seed(42)\nn_points = 200\nx_scatter = np.random.randn(n_points)\ny_scatter = np.random.randn(n_points)\nz_scatter = np.random.randn(n_points)\ncolors = np.random.rand(n_points)\nsizes = 100 * np.random.rand(n_points)\n\nscatter = ax3.scatter(x_scatter, y_scatter, z_scatter, \n                      c=colors, s=sizes, alpha=0.6, cmap='plasma')\nax3.set_title('3D\u6563\u70b9\u56fe')\nax3.set_xlabel('X\u8f74')\nax3.set_ylabel('Y\u8f74')\nax3.set_zlabel('Z\u8f74')\n\n# 3D\u7b49\u9ad8\u7ebf\u56fe\nax4 = fig.add_subplot(224, projection='3d')\ncontour = ax4.contour3D(X, Y, Z, 50, cmap='coolwarm')\nax4.set_title('3D\u7b49\u9ad8\u7ebf\u56fe')\nax4.set_xlabel('X\u8f74')\nax4.set_ylabel('Y\u8f74')\nax4.set_zlabel('Z\u8f74')\n\nplt.suptitle('3D\u56fe\u5f62\u793a\u4f8b', fontsize=16, fontweight='bold')\nplt.tight_layout()\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#_3","title":"\u6781\u5750\u6807\u56fe","text":"<pre><code># \u521b\u5efa\u6570\u636e\ntheta = np.linspace(0, 2*np.pi, 100)\nr = 1 + 0.5 * np.sin(5*theta)\n\nfig = plt.figure(figsize=(12, 6))\n\n# \u6781\u5750\u6807\u6298\u7ebf\u56fe\nax1 = fig.add_subplot(131, projection='polar')\nax1.plot(theta, r, 'b-', linewidth=2)\nax1.set_title('\u6781\u5750\u6807\u6298\u7ebf\u56fe', pad=20)\nax1.grid(True)\n\n# \u6781\u5750\u6807\u6563\u70b9\u56fe\nax2 = fig.add_subplot(132, projection='polar')\nax2.scatter(theta, r, c=theta, s=50, cmap='hsv', alpha=0.7)\nax2.set_title('\u6781\u5750\u6807\u6563\u70b9\u56fe', pad=20)\nax2.grid(True)\n\n# \u6781\u5750\u6807\u67f1\u72b6\u56fe\nax3 = fig.add_subplot(133, projection='polar')\nbars = ax3.bar(theta, r, width=0.1, alpha=0.7, color=plt.cm.viridis(r/2))\nax3.set_title('\u6781\u5750\u6807\u67f1\u72b6\u56fe', pad=20)\nax3.grid(True)\n\nplt.suptitle('\u6781\u5750\u6807\u56fe\u5f62\u793a\u4f8b', fontsize=14, fontweight='bold')\nplt.tight_layout()\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#heatmap","title":"\u70ed\u529b\u56fe (Heatmap)","text":"<pre><code># \u521b\u5efa\u6570\u636e\nnp.random.seed(42)\ndata = np.random.rand(10, 12)\nrows = [f'Row_{i}' for i in range(1, 11)]\ncols = [f'Col_{j}' for j in range(1, 13)]\n\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 6))\n\n# \u57fa\u7840\u70ed\u529b\u56fe\nim1 = ax1.imshow(data, cmap='viridis', aspect='auto')\nax1.set_title('\u57fa\u7840\u70ed\u529b\u56fe', fontsize=14)\nax1.set_xlabel('\u5217')\nax1.set_ylabel('\u884c')\n\n# \u8bbe\u7f6e\u523b\u5ea6\nax1.set_xticks(np.arange(len(cols)))\nax1.set_yticks(np.arange(len(rows)))\nax1.set_xticklabels(cols, rotation=45, ha='right')\nax1.set_yticklabels(rows)\n\n# \u6dfb\u52a0\u6570\u503c\u6807\u7b7e\nfor i in range(len(rows)):\n    for j in range(len(cols)):\n        text = ax1.text(j, i, f'{data[i, j]:.2f}',\n                       ha=\"center\", va=\"center\", color=\"w\", fontsize=8)\n\n# \u76f8\u5173\u6027\u70ed\u529b\u56fe\nnp.random.seed(42)\ncorr_data = np.random.randn(100, 6)\ncorr_matrix = np.corrcoef(corr_data.T)\n\nim2 = ax2.imshow(corr_matrix, cmap='coolwarm', vmin=-1, vmax=1, aspect='auto')\nax2.set_title('\u76f8\u5173\u6027\u70ed\u529b\u56fe', fontsize=14)\nax2.set_xlabel('\u53d8\u91cf')\nax2.set_ylabel('\u53d8\u91cf')\n\n# \u8bbe\u7f6e\u523b\u5ea6\nvar_labels = [f'Var_{i}' for i in range(1, 7)]\nax2.set_xticks(np.arange(len(var_labels)))\nax2.set_yticks(np.arange(len(var_labels)))\nax2.set_xticklabels(var_labels, rotation=45, ha='right')\nax2.set_yticklabels(var_labels)\n\n# \u6dfb\u52a0\u6570\u503c\u6807\u7b7e\nfor i in range(len(var_labels)):\n    for j in range(len(var_labels)):\n        text = ax2.text(j, i, f'{corr_matrix[i, j]:.2f}',\n                       ha=\"center\", va=\"center\", \n                       color=\"white\" if abs(corr_matrix[i, j]) &gt; 0.5 else \"black\",\n                       fontsize=9, fontweight='bold')\n\n# \u6dfb\u52a0\u989c\u8272\u6761\nplt.colorbar(im1, ax=ax1, shrink=0.8)\nplt.colorbar(im2, ax=ax2, shrink=0.8)\n\nplt.tight_layout()\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#contour-plot","title":"\u7b49\u9ad8\u7ebf\u56fe (Contour Plot)","text":"<pre><code># \u521b\u5efa\u6570\u636e\nx = np.linspace(-3, 3, 100)\ny = np.linspace(-3, 3, 100)\nX, Y = np.meshgrid(x, y)\nZ = np.sin(X) * np.cos(Y)  # \u4e8c\u7ef4\u51fd\u6570\n\nfig, axes = plt.subplots(1, 3, figsize=(15, 5))\n\n# \u7b49\u9ad8\u7ebf\u56fe\ncontour = axes[0].contour(X, Y, Z, 20, cmap='RdGy')\naxes[0].clabel(contour, inline=True, fontsize=8)\naxes[0].set_title('\u7b49\u9ad8\u7ebf\u56fe')\naxes[0].set_xlabel('X')\naxes[0].set_ylabel('Y')\naxes[0].grid(True, alpha=0.3)\n\n# \u586b\u5145\u7b49\u9ad8\u7ebf\u56fe\ncontourf = axes[1].contourf(X, Y, Z, 20, cmap='viridis')\naxes[1].set_title('\u586b\u5145\u7b49\u9ad8\u7ebf\u56fe')\naxes[1].set_xlabel('X')\naxes[1].set_ylabel('Y')\naxes[1].grid(True, alpha=0.3)\nplt.colorbar(contourf, ax=axes[1], shrink=0.8)\n\n# \u7b49\u9ad8\u7ebf+\u586b\u5145\u7ec4\u5408\ncontour = axes[2].contour(X, Y, Z, 20, colors='black', linewidths=0.5)\ncontourf = axes[2].contourf(X, Y, Z, 20, cmap='coolwarm', alpha=0.7)\naxes[2].clabel(contour, inline=True, fontsize=8)\naxes[2].set_title('\u7ec4\u5408\u7b49\u9ad8\u7ebf\u56fe')\naxes[2].set_xlabel('X')\naxes[2].set_ylabel('Y')\naxes[2].grid(True, alpha=0.3)\nplt.colorbar(contourf, ax=axes[2], shrink=0.8)\n\nplt.tight_layout()\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#4","title":"\ud83c\udfad 4. \u56fe\u5f62\u7f8e\u5316\u4e0e\u81ea\u5b9a\u4e49","text":""},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#_4","title":"\u989c\u8272\u548c\u6837\u5f0f","text":"<pre><code># \u5185\u7f6e\u989c\u8272\ncolors = plt.cm.tab10(np.arange(0, 1, 0.1))  # tab10 \u8c03\u8272\u677f\ncolors = plt.cm.viridis(np.linspace(0, 1, 10))  # viridis \u8c03\u8272\u677f\n\n# \u81ea\u5b9a\u4e49\u989c\u8272\u6620\u5c04\nfrom matplotlib.colors import LinearSegmentedColormap\n\n# \u521b\u5efa\u81ea\u5b9a\u4e49\u989c\u8272\u6620\u5c04\ncolors_custom = ['#FF6B6B', '#FFE66D', '#4ECDC4', '#1A535C']\ncmap_custom = LinearSegmentedColormap.from_list('custom', colors_custom)\n\n# \u4f7f\u7528\u793a\u4f8b\nfig, axes = plt.subplots(2, 2, figsize=(12, 10))\n\n# \u5185\u7f6e\u8c03\u8272\u677f\u793a\u4f8b\ncolormaps = ['viridis', 'plasma', 'coolwarm', 'RdYlBu']\nfor ax, cmap_name in zip(axes.flat, colormaps):\n    data = np.random.rand(10, 10)\n    im = ax.imshow(data, cmap=cmap_name)\n    ax.set_title(cmap_name)\n    plt.colorbar(im, ax=ax, shrink=0.8)\n\nplt.suptitle('\u4e0d\u540c\u989c\u8272\u6620\u5c04\u793a\u4f8b', fontsize=14, fontweight='bold')\nplt.tight_layout()\nplt.show()\n\n# \u7ebf\u578b\u548c\u6807\u8bb0\u6837\u5f0f\nfig, ax = plt.subplots(figsize=(12, 6))\n\n# \u7ebf\u578b\nlinestyles = ['-', '--', '-.', ':']\nfor i, ls in enumerate(linestyles):\n    ax.plot([i, i+1], [0, 1], ls=ls, linewidth=2, label=f'\u7ebf\u578b: {ls}')\n\n# \u6807\u8bb0\nmarkers = ['o', 's', '^', 'D', '*', '+', 'x']\nx_pos = np.arange(len(markers)) + 3\nfor i, marker in enumerate(markers):\n    ax.scatter(x_pos[i], 0.5, s=100, marker=marker, label=f'\u6807\u8bb0: {marker}')\n\nax.set_xlim(-1, len(markers)+3)\nax.set_ylim(-0.5, 1.5)\nax.set_title('\u7ebf\u578b\u548c\u6807\u8bb0\u6837\u5f0f')\nax.legend(loc='upper left', bbox_to_anchor=(1, 1))\nax.grid(True, alpha=0.3)\nplt.tight_layout()\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#_5","title":"\u6587\u672c\u548c\u6807\u6ce8","text":"<pre><code>fig, ax = plt.subplots(figsize=(12, 8))\n\n# \u7ed8\u5236\u4e00\u4e9b\u6570\u636e\nx = np.linspace(0, 10, 100)\ny = np.sin(x)\nax.plot(x, y, 'b-', linewidth=2, label='sin(x)')\n\n# 1. \u57fa\u672c\u6587\u672c\nax.text(5, 0.5, '\u8fd9\u662f\u6587\u672c', fontsize=12, color='red',\n        bbox=dict(boxstyle='round', facecolor='yellow', alpha=0.5))\n\n# 2. \u5e26\u7bad\u5934\u7684\u6807\u6ce8\nax.annotate('\u6700\u5927\u503c', xy=(np.pi/2, 1), xytext=(3, 1.5),\n            arrowprops=dict(arrowstyle='-&gt;', connectionstyle='arc3', color='green', linewidth=2),\n            fontsize=12, color='green',\n            bbox=dict(boxstyle='round', facecolor='lightgreen', alpha=0.5))\n\n# 3. \u6570\u5b66\u516c\u5f0f\uff08LaTeX\uff09\nax.text(7, -0.5, r'$f(x) = \\sin(x)$', fontsize=14, color='purple',\n        bbox=dict(boxstyle='round', facecolor='lavender', alpha=0.5))\n\n# 4. \u5e26\u8fb9\u6846\u7684\u6587\u672c\nax.text(2, -0.7, '\u5e26\u8fb9\u6846\u6587\u672c', fontsize=12, color='blue',\n        bbox=dict(boxstyle='round,pad=0.5', edgecolor='blue', facecolor='lightblue'))\n\n# 5. \u65cb\u8f6c\u6587\u672c\nax.text(8, 0, '\u65cb\u8f6c45\u5ea6', fontsize=12, color='orange', rotation=45,\n        bbox=dict(boxstyle='round', facecolor='peachpuff', alpha=0.5))\n\n# 6. \u591a\u884c\u6587\u672c\nax.text(0.5, -0.8, '\u8fd9\u662f\u7b2c\u4e00\u884c\\n\u8fd9\u662f\u7b2c\u4e8c\u884c\\n\u8fd9\u662f\u7b2c\u4e09\u884c', \n        fontsize=10, color='brown',\n        bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.5))\n\n# \u8bbe\u7f6e\u56fe\u5f62\nax.set_title('\u6587\u672c\u548c\u6807\u6ce8\u793a\u4f8b', fontsize=16, fontweight='bold')\nax.set_xlabel('X\u8f74', fontsize=12)\nax.set_ylabel('Y\u8f74', fontsize=12)\nax.legend()\nax.grid(True, alpha=0.3)\nax.set_xlim(0, 10)\nax.set_ylim(-1.5, 1.5)\n\nplt.tight_layout()\nplt.show()\n</code></pre>"},{"location":"wiki/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%F0%9F%93%8A%20Matplotlib%20Pyplot%20%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/#_6","title":"\u56fe\u4f8b\u9ad8\u7ea7\u8bbe\u7f6e","text":"<pre><code>fig, axes = plt.subplots(2, 2, figsize=(14, 10))\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/","title":"\ud83c\udfad Playwright \u7b80\u6d01\u4f7f\u7528\u6559\u7a0b","text":""},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#1","title":"\ud83d\udce6 1. \u5b89\u88c5\u4e0e\u914d\u7f6e","text":""},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_1","title":"\u5b89\u88c5","text":"<pre><code># \u5b89\u88c5 Playwright\npip install playwright\n\n# \u5b89\u88c5\u6d4f\u89c8\u5668\uff08\u63a8\u8350\uff09\nplaywright install          # \u5b89\u88c5\u6240\u6709\u6d4f\u89c8\u5668\nplaywright install chromium # \u53ea\u5b89\u88c5 Chromium\n\n# \u5b89\u88c5 Pytest \u96c6\u6210\uff08\u53ef\u9009\uff09\npip install pytest-playwright\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_2","title":"\u9a8c\u8bc1\u5b89\u88c5","text":"<pre><code># \u9a8c\u8bc1\u811a\u672c\nfrom playwright.sync_api import sync_playwright\n\nwith sync_playwright() as p:\n    browser = p.chromium.launch(headless=False)\n    page = browser.new_page()\n    page.goto(\"https://www.google.com\")\n    print(f\"\u9875\u9762\u6807\u9898: {page.title()}\")\n    browser.close()\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#2","title":"\ud83d\ude80 2. \u6838\u5fc3\u6982\u5ff5\u901f\u67e5","text":""},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_3","title":"\u4e09\u79cd\u6d4f\u89c8\u5668\u5f15\u64ce","text":"<pre><code>from playwright.sync_api import sync_playwright\n\nwith sync_playwright() as p:\n    # Chromium (Google Chrome/Edge \u57fa\u7840)\n    browser = p.chromium.launch()\n\n    # Firefox\n    browser = p.firefox.launch()\n\n    # WebKit (Safari \u57fa\u7840)\n    browser = p.webkit.launch()\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#vs-api","title":"\u540c\u6b65 vs \u5f02\u6b65 API","text":"<pre><code># \u540c\u6b65 API\uff08\u63a8\u8350\u521d\u5b66\u8005\uff09\nfrom playwright.sync_api import sync_playwright\n\nwith sync_playwright() as p:\n    browser = p.chromium.launch()\n    page = browser.new_page()\n    page.goto(\"https://example.com\")\n    browser.close()\n\n# \u5f02\u6b65 API\nimport asyncio\nfrom playwright.async_api import async_playwright\n\nasync def main():\n    async with async_playwright() as p:\n        browser = await p.chromium.launch()\n        page = await browser.new_page()\n        await page.goto(\"https://example.com\")\n        await browser.close()\n\nasyncio.run(main())\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#3","title":"\ud83c\udfaf 3. \u57fa\u7840\u64cd\u4f5c","text":""},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_4","title":"\u9875\u9762\u5bfc\u822a","text":"<pre><code>from playwright.sync_api import sync_playwright\n\nwith sync_playwright() as p:\n    browser = p.chromium.launch(headless=False)  # \u663e\u793a\u6d4f\u89c8\u5668\n    page = browser.new_page()\n\n    # \u57fa\u672c\u5bfc\u822a\n    page.goto(\"https://example.com\")  # \u8df3\u8f6c\n    page.reload()                     # \u5237\u65b0\n    page.go_back()                    # \u540e\u9000\n    page.go_forward()                 # \u524d\u8fdb\n\n    # \u7b49\u5f85\u7b56\u7565\n    page.goto(\"https://example.com\", wait_until=\"networkidle\")  # \u7f51\u7edc\u7a7a\u95f2\n    page.goto(\"https://example.com\", wait_until=\"domcontentloaded\")  # DOM\u52a0\u8f7d\n    page.goto(\"https://example.com\", wait_until=\"load\")  # \u9875\u9762\u5b8c\u5168\u52a0\u8f7d\n\n    # \u83b7\u53d6\u9875\u9762\u4fe1\u606f\n    title = page.title()            # \u6807\u9898\n    url = page.url                  # \u5f53\u524dURL\n    content = page.content()        # HTML\u5185\u5bb9\n\n    browser.close()\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_5","title":"\u5143\u7d20\u5b9a\u4f4d\u4e0e\u4ea4\u4e92","text":"<pre><code># \u5b9a\u4f4d\u65b9\u6cd5\uff08\u6700\u5e38\u7528\u7684\uff09\npage.click(\"button#submit\")                    # \u70b9\u51fb\npage.fill(\"input[name='username']\", \"admin\")   # \u586b\u5199\u8868\u5355\npage.type(\"textarea\", \"Hello World\")           # \u6a21\u62df\u6253\u5b57\npage.press(\"input\", \"Enter\")                   # \u6309\u952e\n\n# \u591a\u79cd\u9009\u62e9\u5668\npage.click(\"#id\")                       # ID\npage.click(\".class\")                    # \u7c7b\u540d\npage.click(\"text=Login\")                # \u6587\u672c\u5185\u5bb9\npage.click(\"button:has-text('Submit')\") # \u5305\u542b\u6587\u672c\npage.click(\"input[name='email']\")       # \u5c5e\u6027\npage.click(\"//button[@type='submit']\")  # XPath\n\n# \u7b49\u5f85\u5143\u7d20\npage.wait_for_selector(\"#loading\", state=\"hidden\")  # \u7b49\u5f85\u9690\u85cf\npage.wait_for_selector(\".result\", state=\"visible\")  # \u7b49\u5f85\u663e\u793a\npage.wait_for_timeout(3000)                         # \u5f3a\u5236\u7b49\u5f85\uff08\u4e0d\u63a8\u8350\uff09\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_6","title":"\u8868\u5355\u64cd\u4f5c","text":"<pre><code># \u8868\u5355\u586b\u5199\npage.fill(\"#username\", \"testuser\")\npage.fill(\"#password\", \"password123\")\npage.select_option(\"#country\", \"US\")            # \u4e0b\u62c9\u6846\npage.check(\"#agree-terms\")                      # \u52fe\u9009\npage.uncheck(\"#newsletter\")                     # \u53d6\u6d88\u52fe\u9009\npage.set_checked(\"#remember\", True)             # \u8bbe\u7f6e\u590d\u9009\u6846\u72b6\u6001\n\n# \u6587\u4ef6\u4e0a\u4f20\npage.set_input_files(\"input[type='file']\", \"path/to/file.pdf\")\n\n# \u63d0\u4ea4\u8868\u5355\npage.click(\"button[type='submit']\")\n# \u6216\npage.press(\"#password\", \"Enter\")\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#4","title":"\ud83d\udd0d 4. \u9ad8\u7ea7\u5143\u7d20\u64cd\u4f5c","text":""},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_7","title":"\u591a\u79cd\u5b9a\u4f4d\u65b9\u5f0f","text":"<pre><code># \u5355\u5143\u7d20\u5b9a\u4f4d\nelement = page.query_selector(\".item\")          # \u7b2c\u4e00\u4e2a\u5339\u914d\u5143\u7d20\nelement = page.locator(\".item\").first          # \u4f7f\u7528locator\n\n# \u591a\u5143\u7d20\u5b9a\u4f4d\nelements = page.query_selector_all(\".item\")     # \u6240\u6709\u5339\u914d\u5143\u7d20\nelements = page.locator(\".item\").all()         # \u4f7f\u7528locator\n\n# \u7cbe\u786e\u7684\u6587\u672c\u5b9a\u4f4d\npage.click(\"text=Submit\")                      # \u7cbe\u786e\u6587\u672c\npage.click(\"text=/submit/i\")                   # \u6b63\u5219\u5339\u914d\npage.click(\"text='Log in'\")                    # \u5305\u542b\u6587\u672c\n\n# \u76f8\u5bf9\u5b9a\u4f4d\npage.locator(\"form\").locator(\"button\").click()  # \u5728form\u4e2d\u627ebutton\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_8","title":"\u5143\u7d20\u72b6\u6001\u68c0\u67e5","text":"<pre><code># \u68c0\u67e5\u53ef\u89c1\u6027\nis_visible = page.is_visible(\"#element\")\nis_hidden = page.is_hidden(\"#element\")\n\n# \u68c0\u67e5\u5b58\u5728\nis_present = page.locator(\"#element\").count() &gt; 0\n\n# \u68c0\u67e5\u72b6\u6001\nis_enabled = page.is_enabled(\"button\")\nis_checked = page.is_checked(\"#checkbox\")\nis_editable = page.is_editable(\"input\")\n\n# \u83b7\u53d6\u5c5e\u6027\ntext = page.text_content(\".title\")              # \u6587\u672c\u5185\u5bb9\nvalue = page.input_value(\"#input\")              # \u8f93\u5165\u503c\nattribute = page.get_attribute(\"img\", \"src\")    # \u5c5e\u6027\u503c\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#5","title":"\ud83d\udcca 5. \u9875\u9762\u7b49\u5f85\u7b56\u7565","text":""},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_9","title":"\u667a\u80fd\u7b49\u5f85","text":"<pre><code># \u7b49\u5f85\u5143\u7d20\u51fa\u73b0\npage.wait_for_selector(\".result\")\n\n# \u7b49\u5f85\u5143\u7d20\u72b6\u6001\npage.wait_for_selector(\"#loading\", state=\"hidden\")    # \u7b49\u5f85\u6d88\u5931\npage.wait_for_selector(\"#content\", state=\"visible\")   # \u7b49\u5f85\u663e\u793a\npage.wait_for_selector(\"#button\", state=\"enabled\")    # \u7b49\u5f85\u53ef\u7528\n\n# \u7b49\u5f85\u51fd\u6570\npage.wait_for_function(\"window.dataLoaded\")          # JS\u51fd\u6570\u8fd4\u56detrue\npage.wait_for_function(\"document.querySelectorAll('.item').length &gt; 5\")\n\n# \u7b49\u5f85\u4e8b\u4ef6\npage.wait_for_event(\"load\")                          # \u9875\u9762\u52a0\u8f7d\npage.wait_for_event(\"domcontentloaded\")\n\n# \u7ec4\u5408\u7b49\u5f85\nfrom playwright.sync_api import expect\nexpect(page.locator(\".result\")).to_be_visible()\nexpect(page.locator(\"#count\")).to_have_text(\"10\")\nexpect(page.locator(\"#status\")).to_have_value(\"completed\")\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_10","title":"\u8d85\u65f6\u63a7\u5236","text":"<pre><code># \u5168\u5c40\u8d85\u65f6\ncontext.set_default_timeout(30000)  # 30\u79d2\n\n# \u5355\u4e2a\u64cd\u4f5c\u8d85\u65f6\npage.click(\"button\", timeout=10000)            # 10\u79d2\npage.wait_for_selector(\".item\", timeout=5000)  # 5\u79d2\n\n# \u81ea\u5b9a\u4e49\u91cd\u8bd5\u903b\u8f91\nimport time\nfor attempt in range(3):\n    try:\n        page.click(\"#unstable-button\", timeout=2000)\n        break\n    except:\n        if attempt == 2:\n            raise\n        time.sleep(1)\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#6","title":"\ud83c\udf10 6. \u7f51\u7edc\u4e0e\u8bf7\u6c42\u5904\u7406","text":""},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_11","title":"\u62e6\u622a\u8bf7\u6c42","text":"<pre><code># \u8bf7\u6c42\u62e6\u622a\ndef handle_request(route, request):\n    if \"analytics\" in request.url:\n        route.abort()  # \u963b\u6b62\u8bf7\u6c42\n    else:\n        route.continue_()\n\npage.route(\"**/*\", handle_request)\n\n# \u4fee\u6539\u54cd\u5e94\ndef handle_response(route, request):\n    response = route.fulfill(\n        status=200,\n        content_type=\"text/html\",\n        body=\"&lt;html&gt;&lt;body&gt;Custom Response&lt;/body&gt;&lt;/html&gt;\"\n    )\n\npage.route(\"**/api/data\", handle_response)\n\n# \u79fb\u9664\u62e6\u622a\npage.unroute(\"**/*\", handle_request)\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#api","title":"API \u6d4b\u8bd5","text":"<pre><code># \u76d1\u542c\u7f51\u7edc\u8bf7\u6c42\napi_responses = []\n\ndef log_response(response):\n    if \"/api/\" in response.url:\n        api_responses.append(response)\n\npage.on(\"response\", log_response)\n\n# \u83b7\u53d6\u8bf7\u6c42\u6570\u636e\nrequest = page.wait_for_request(\"**/api/login\")\nprint(f\"Method: {request.method}\")\nprint(f\"Headers: {request.headers}\")\nprint(f\"Post Data: {request.post_data}\")\n\n# \u83b7\u53d6\u54cd\u5e94\u6570\u636e\nresponse = page.wait_for_response(\"**/api/data\")\nprint(f\"Status: {response.status}\")\nprint(f\"Body: {response.json()}\")\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#7","title":"\ud83d\udcc1 7. \u6587\u4ef6\u4e0e\u4e0b\u8f7d","text":""},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_12","title":"\u6587\u4ef6\u4e0b\u8f7d","text":"<pre><code># \u7b49\u5f85\u4e0b\u8f7d\nwith page.expect_download() as download_info:\n    page.click(\"a.download-link\")\n\ndownload = download_info.value\npath = download.path()                      # \u4e34\u65f6\u8def\u5f84\nsave_path = f\"downloads/{download.suggested_filename}\"\ndownload.save_as(save_path)                # \u4fdd\u5b58\u6587\u4ef6\n\n# \u81ea\u52a8\u63a5\u53d7\u4e0b\u8f7d\ncontext = browser.new_context(\n    accept_downloads=True\n)\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#pdf","title":"\u622a\u56fe\u4e0ePDF","text":"<pre><code># \u622a\u56fe\npage.screenshot(path=\"screenshot.png\")           # \u5168\u5c4f\npage.screenshot(path=\"element.png\", clip={\"x\": 10, \"y\": 10, \"width\": 100, \"height\": 100})\nelement.screenshot(path=\"button.png\")            # \u5143\u7d20\u622a\u56fe\n\n# PDF\u5bfc\u51fa\npage.pdf(path=\"page.pdf\", format=\"A4\")\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#8","title":"\ud83e\uddea 8. \u6d4b\u8bd5\u6846\u67b6\u96c6\u6210","text":""},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#pytest","title":"Pytest \u793a\u4f8b","text":"<pre><code># test_example.py\nimport pytest\nfrom playwright.sync_api import Page, expect\n\n@pytest.fixture(scope=\"function\")\ndef page(context):\n    page = context.new_page()\n    yield page\n    page.close()\n\ndef test_login(page: Page):\n    \"\"\"\u6d4b\u8bd5\u767b\u5f55\u529f\u80fd\"\"\"\n    page.goto(\"https://example.com/login\")\n\n    page.fill(\"#username\", \"testuser\")\n    page.fill(\"#password\", \"password123\")\n    page.click(\"#login-button\")\n\n    # \u4f7f\u7528expect\u8fdb\u884c\u65ad\u8a00\n    expect(page).to_have_url(\"https://example.com/dashboard\")\n    expect(page.locator(\".welcome\")).to_have_text(\"Welcome, testuser!\")\n\ndef test_search(page: Page):\n    \"\"\"\u6d4b\u8bd5\u641c\u7d22\u529f\u80fd\"\"\"\n    page.goto(\"https://example.com\")\n\n    page.fill(\"[placeholder='Search']\", \"Playwright\")\n    page.press(\"[placeholder='Search']\", \"Enter\")\n\n    # \u7b49\u5f85\u5e76\u9a8c\u8bc1\u7ed3\u679c\n    results = page.locator(\".search-result\")\n    expect(results).to_have_count(10)\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_13","title":"\u6d4b\u8bd5\u914d\u7f6e","text":"<pre><code># conftest.py\nimport pytest\nfrom playwright.sync_api import Playwright, Browser, BrowserContext\n\n@pytest.fixture(scope=\"session\")\ndef playwright():\n    with sync_playwright() as p:\n        yield p\n\n@pytest.fixture(scope=\"session\")\ndef browser(playwright: Playwright):\n    browser = playwright.chromium.launch(\n        headless=True,      # \u65e0\u5934\u6a21\u5f0f\n        slow_mo=50,         # \u6162\u52a8\u4f5c\uff08\u8c03\u8bd5\u7528\uff09\n        devtools=True       # \u6253\u5f00\u5f00\u53d1\u8005\u5de5\u5177\n    )\n    yield browser\n    browser.close()\n\n@pytest.fixture\ndef context(browser: Browser):\n    context = browser.new_context(\n        viewport={\"width\": 1920, \"height\": 1080},\n        locale=\"en-US\",\n        timezone_id=\"America/New_York\"\n    )\n    yield context\n    context.close()\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#8_1","title":"\ud83d\udee1\ufe0f 8. \u6700\u4f73\u5b9e\u8df5","text":""},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_14","title":"\u4ee3\u7801\u7ec4\u7ec7","text":"<pre><code># page_objects/login_page.py\nclass LoginPage:\n    def __init__(self, page):\n        self.page = page\n        self.username_input = page.locator(\"#username\")\n        self.password_input = page.locator(\"#password\")\n        self.login_button = page.locator(\"#login-button\")\n        self.error_message = page.locator(\".error\")\n\n    def navigate(self):\n        self.page.goto(\"https://example.com/login\")\n\n    def login(self, username, password):\n        self.username_input.fill(username)\n        self.password_input.fill(password)\n        self.login_button.click()\n\n    def get_error(self):\n        return self.error_message.text_content()\n\n# \u4f7f\u7528\u793a\u4f8b\ndef test_login():\n    page = browser.new_page()\n    login_page = LoginPage(page)\n    login_page.navigate()\n    login_page.login(\"user\", \"pass\")\n    assert login_page.get_error() == \"Invalid credentials\"\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_15","title":"\u914d\u7f6e\u7ba1\u7406","text":"<pre><code># playwright.config.py\nimport pytest\nfrom playwright.sync_api import Browser, BrowserContext\n\ndef pytest_configure(config):\n    config.option.headless = True\n    config.option.screenshot = \"only-on-failure\"\n    config.option.video = \"retain-on-failure\"\n\n@pytest.fixture\ndef browser_context_args(browser_context_args):\n    return {\n        **browser_context_args,\n        \"viewport\": {\"width\": 1920, \"height\": 1080},\n        \"ignore_https_errors\": True,\n        \"record_video_dir\": \"videos/\"\n    }\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#9","title":"\ud83d\udea8 9. \u5e38\u89c1\u95ee\u9898\u89e3\u51b3","text":""},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_16","title":"\u8c03\u8bd5\u6280\u5de7","text":"<pre><code># 1. \u6682\u505c\u8c03\u8bd5\npage.pause()  # \u6253\u5f00Playwright Inspector\n\n# 2. \u63a7\u5236\u53f0\u8f93\u51fa\npage.on(\"console\", lambda msg: print(f\"CONSOLE: {msg.text}\"))\n\n# 3. \u8be6\u7ec6\u65e5\u5fd7\nimport logging\nlogging.basicConfig(level=logging.DEBUG)\n\n# 4. \u6162\u52a8\u4f5c\u6a21\u5f0f\nbrowser = p.chromium.launch(headless=False, slow_mo=1000)\n\n# 5. \u5f55\u5236\u811a\u672c\nplaywright codegen https://example.com\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_17","title":"\u5e38\u89c1\u9519\u8bef\u5904\u7406","text":"<pre><code>try:\n    page.click(\"#unstable-element\", timeout=3000)\nexcept TimeoutError:\n    print(\"\u5143\u7d20\u672a\u627e\u5230\uff0c\u5c1d\u8bd5\u5176\u4ed6\u65b9\u5f0f\")\n    page.reload()\n    page.wait_for_selector(\"#unstable-element\", state=\"visible\")\n    page.click(\"#unstable-element\")\n\n# \u5904\u7406\u5f39\u7a97\npage.on(\"dialog\", lambda dialog: dialog.accept())\n\n# \u5904\u7406\u6846\u67b6\nframe = page.frame(name=\"iframe-name\")\nframe.click(\"button\")\n</code></pre>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#10","title":"\ud83d\udccb 10. \u901f\u67e5\u8868","text":"\u4efb\u52a1 \u4ee3\u7801\u793a\u4f8b \u542f\u52a8\u6d4f\u89c8\u5668 <code>browser = p.chromium.launch(headless=False)</code> \u65b0\u5efa\u9875\u9762 <code>page = browser.new_page()</code> \u9875\u9762\u8df3\u8f6c <code>page.goto(\"https://example.com\")</code> \u70b9\u51fb\u5143\u7d20 <code>page.click(\"button#submit\")</code> \u586b\u5199\u8868\u5355 <code>page.fill(\"input[name='email']\", \"test@example.com\")</code> \u83b7\u53d6\u6587\u672c <code>text = page.text_content(\".title\")</code> \u7b49\u5f85\u5143\u7d20 <code>page.wait_for_selector(\".result\")</code> \u622a\u56fe <code>page.screenshot(path=\"screenshot.png\")</code> \u6267\u884cJS <code>page.evaluate(\"window.scrollTo(0, document.body.scrollHeight)\")</code> \u83b7\u53d6URL <code>current_url = page.url</code>"},{"location":"wiki/Python/%E8%87%AA%E5%8A%A8%E5%8C%96/%F0%9F%8E%AD%20Playwright%20%E7%AE%80%E6%B4%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/#_18","title":"\ud83c\udfaf \u5feb\u901f\u5f00\u59cb\u6a21\u677f","text":"<pre><code>#!/usr/bin/env python3\n\"\"\"\nPlaywright \u5feb\u901f\u5f00\u59cb\u6a21\u677f\n\"\"\"\n\nfrom playwright.sync_api import sync_playwright\n\ndef main():\n    with sync_playwright() as p:\n        # 1. \u542f\u52a8\u6d4f\u89c8\u5668\n        browser = p.chromium.launch(\n            headless=False,      # \u663e\u793a\u6d4f\u89c8\u5668\u7a97\u53e3\n            slow_mo=100,         # \u6162\u52a8\u4f5c\uff0c\u65b9\u4fbf\u89c2\u5bdf\n        )\n\n        # 2. \u521b\u5efa\u9875\u9762\n        page = browser.new_page()\n\n        # 3. \u8bbe\u7f6e\u89c6\u53e3\u5927\u5c0f\n        page.set_viewport_size({\"width\": 1920, \"height\": 1080})\n\n        try:\n            # 4. \u8bbf\u95ee\u7f51\u7ad9\n            page.goto(\"https://www.baidu.com\")\n\n            # 5. \u9875\u9762\u64cd\u4f5c\n            page.fill(\"#kw\", \"Playwright\u6559\u7a0b\")\n            page.press(\"#kw\", \"Enter\")\n\n            # 6. \u7b49\u5f85\u7ed3\u679c\n            page.wait_for_selector(\".result\")\n\n            # 7. \u83b7\u53d6\u6570\u636e\n            results = page.query_selector_all(\".result h3 a\")\n            for result in results[:5]:\n                print(f\"\u6807\u9898: {result.text_content()}\")\n                print(f\"\u94fe\u63a5: {result.get_attribute('href')}\")\n\n            # 8. \u622a\u56fe\n            page.screenshot(path=\"search_results.png\")\n\n        finally:\n            # 9. \u5173\u95ed\u6d4f\u89c8\u5668\n            browser.close()\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"wiki/nginx/HttpAuthBasic%E6%A8%A1%E5%9D%97/","title":"\u57fa\u672c\u6a21\u5757","text":""},{"location":"wiki/nginx/HttpAuthBasic%E6%A8%A1%E5%9D%97/#httpauthbasic","title":"HttpAuthBasic\u6a21\u5757","text":"<p>\u8be5\u6a21\u5757\u53ef\u4ee5\u4f7f\u4f60\u4f7f\u7528\u7528\u6237\u540d\u548c\u5bc6\u7801\u57fa\u4e8e HTTP \u57fa\u672c\u8ba4\u8bc1\u65b9\u6cd5\u6765\u4fdd\u62a4\u4f60\u7684\u7ad9\u70b9\u6216\u5176\u90e8\u5206\u5185\u5bb9\u3002</p> <p>\u5b9e\u4f8b\u914d\u7f6e</p> <pre><code>location / {\n    auth_basic on;\n    auth_basic_user_file /etc/yourpass_file;\n}\n</code></pre> <p>auth_basic \u6587\u4ef6\u683c\u5f0f\u7c7b\u4f3c\u4e8e\u4e0b\u9762\u7684\u5185\u5bb9\uff1a</p> <pre><code>\u7528\u6237\u540d:\u5bc6\u7801\n\u7528\u6237\u540d2:\u5bc6\u78012:\u6ce8\u91ca\n\u7528\u6237\u540d3:\u5bc6\u78013\n</code></pre> <p>auth_basic_user_file \u5bc6\u7801\u5fc5\u987b\u4f7f\u7528\u51fd\u6570 crypt(3) \u52a0\u5bc6\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528\u6765\u81ea Apache \u7684 htpasswd \u5de5\u5177\u6765\u521b\u5efa\u5bc6\u7801\u6587\u4ef6\u3002</p> <p>\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528perl \u521b\u5efa\u5bc6\u7801\u6587\u4ef6,pw.pl \u7684\u5185\u5bb9\uff1a</p> <pre><code>#!/usr/bin/perl\nuse strict;\n\nmy $pw=$ARGV[0] ;\nprint crypt($pw,$pw).\"\\n\";\n</code></pre> <p>\u7136\u540e\u6267\u884c</p> <pre><code>chmod +x pw.pl\n./pw.pl password\npapAq5PwY/QQM\n</code></pre> <p>papAq5PwY/QQM\u5c31\u662fpassword \u7684crypt()\u5bc6\u7801</p> <p>\u539f\u59cb\u6587\u6863</p>"},{"location":"wiki/nginx/%E6%B7%BB%E5%8A%A0%E6%A8%A1%E5%9D%97/","title":"\u6dfb\u52a0\u6a21\u5757","text":"<p>\u62a5\u9519\uff1a HTTP rewrite module requires the PCRE library</p> <pre><code>yum -y install pcre-devel\n</code></pre> <pre><code>yum -y install openssl openssl-devel\n</code></pre>"},{"location":"wiki/nginx/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/","title":"\u8d1f\u8f7d\u5747\u8861","text":"<p>nginx\u4f7f\u7528upstream\u914d\u7f6e\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\uff0c\u81ea\u5e26\u7b80\u5355\u7684\u8f6e\u8be2\u5747\u8861 1. \u8f6e\u8be2 2. ip_hash</p>"},{"location":"wiki/nginx/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#upstream","title":"upstream\u914d\u7f6e","text":""},{"location":"wiki/nginx/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#_2","title":"\u8f6e\u8be2","text":"<p>\u901a\u8fc7weight\u8fdb\u884c\u6743\u91cd\u7684\u914d\u7f6e</p> <pre><code>upstream backend {\n    server localhost:8080 weight=3;\n    server localhost:8082;\n}\n</code></pre>"},{"location":"wiki/nginx/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#ip_hash","title":"ip_hash","text":"<p>\u4f7f\u7528down\u4e0b\u7ebf\u670d\u52a1</p> <pre><code>upstream backend{\n    ip_hash;\n    server localhost:8080;\n    server localhost:8082 down;\n}\n</code></pre>"},{"location":"wiki/nginx/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#server","title":"server\u914d\u7f6e","text":"<pre><code>server {\n    location / {\n        proxy_pass http://backend;\n    }\n}\n</code></pre>"},{"location":"wiki/nginx/%E9%85%8D%E7%BD%AEhttps/","title":"nginx\u914d\u7f6ehttps\u53ca\u8bc1\u4e66","text":""},{"location":"wiki/nginx/%E9%85%8D%E7%BD%AEhttps/#_1","title":"\u8bbe\u7f6e\u7ad9\u70b9","text":"<pre><code>    server {\n        listen       80;\n        server_name  www.xxx.com;\n        #\u5c06\u6240\u6709HTTP\u8bf7\u6c42\u901a\u8fc7rewrite\u6307\u4ee4\u91cd\u5b9a\u5411\u5230HTTPS\u3002\n        rewrite ^(.*)$ https://$host$1;\n        #charset koi8-r;\n\n        #access_log  logs/host.access.log  main;\n\n        location / {\n            root /usr/share/nginx/html;\n            index  index.html index.htm;\n        }\n\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n    }\n</code></pre>"},{"location":"wiki/nginx/%E9%85%8D%E7%BD%AEhttps/#_2","title":"\u8bc1\u4e66\u914d\u7f6e","text":"<pre><code>server {\n    listen 443;\n    ssl on;\n    #\u914d\u7f6eHTTPS\u7684\u9ed8\u8ba4\u8bbf\u95ee\u7aef\u53e3\u4e3a443\u3002\n    #\u5982\u679c\u672a\u5728\u6b64\u5904\u914d\u7f6eHTTPS\u7684\u9ed8\u8ba4\u8bbf\u95ee\u7aef\u53e3\uff0c\u53ef\u80fd\u4f1a\u9020\u6210Nginx\u65e0\u6cd5\u542f\u52a8\u3002\n    #\u5982\u679c\u60a8\u4f7f\u7528Nginx 1.15.0\u53ca\u4ee5\u4e0a\u7248\u672c\uff0c\u8bf7\u4f7f\u7528listen 443 ssl\u4ee3\u66fflisten 443\u548cssl on\u3002\n    server_name www.tradebong.com; #\u9700\u8981\u5c06xxxx.com\u66ff\u6362\u6210\u8bc1\u4e66\u7ed1\u5b9a\u7684\u57df\u540d\u3002\n    root html;\n    index index.html index.htm;\n    ssl_certificate /root/cert/xxx.pem;  #\u9700\u8981\u5c06cert-file-name.pem\u66ff\u6362\u6210\u5df2\u4e0a\u4f20\u7684\u8bc1\u4e66\u6587\u4ef6\u7684\u540d\u79f0\u3002\n    ssl_certificate_key /root/cert/xxx.key; #\u9700\u8981\u5c06cert-file-name.key\u66ff\u6362\u6210\u5df2\u4e0a\u4f20\u7684\u8bc1\u4e66\u5bc6\u94a5\u6587\u4ef6\u7684\u540d\u79f0\u3002\n    ssl_session_timeout 5m;\n    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;\n    #\u8868\u793a\u4f7f\u7528\u7684\u52a0\u5bc6\u5957\u4ef6\u7684\u7c7b\u578b\u3002\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2; #\u8868\u793a\u4f7f\u7528\u7684TLS\u534f\u8bae\u7684\u7c7b\u578b\u3002\n    ssl_prefer_server_ciphers on;\n    location / {\n        #root   /;  #\u7ad9\u70b9\u76ee\u5f55\u3002\n        index index.html index.htm;\n    }\n}\n</code></pre> <p>\u8d44\u6599</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/","title":"\u5728 Mac \u4e0a\u5b9a\u65f6\u6267\u884c\u811a\u672c\u7684\u5b8c\u6574\u6307\u5357","text":"<p>\u5728 macOS \u4e0a\u5b9a\u65f6\u6267\u884c\u811a\u672c\u6709\u591a\u79cd\u65b9\u6cd5\uff0c\u4ee5\u4e0b\u662f\u4e09\u79cd\u4e3b\u8981\u65b9\u5f0f\u53ca\u5176\u8be6\u7ec6\u8bf4\u660e\uff1a</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#1-launchd","title":"1. \u4f7f\u7528 launchd\uff08\u63a8\u8350\u65b9\u6cd5\uff09","text":"<p>launchd \u662f macOS \u7684\u539f\u751f\u5b88\u62a4\u8fdb\u7a0b\u7ba1\u7406\u7cfb\u7edf\uff0c\u6bd4 cron \u66f4\u5f3a\u5927\u4e14\u652f\u6301\u66f4\u591a\u529f\u80fd\u3002</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#plist","title":"\u521b\u5efa plist \u6587\u4ef6","text":"<ol> <li>\u5728 <code>~/Library/LaunchAgents/</code> \u76ee\u5f55\u521b\u5efa plist \u6587\u4ef6\uff1a</li> </ol> <pre><code>nano ~/Library/LaunchAgents/com.user.myscript.plist\n</code></pre> <ol> <li>\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff08\u6bcf\u65e5\u4e2d\u534812\u70b9\u6267\u884c\uff09\uff1a</li> </ol> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;\n&lt;plist version=\"1.0\"&gt;\n&lt;dict&gt;\n    &lt;key&gt;Label&lt;/key&gt;\n    &lt;string&gt;com.user.myscript&lt;/string&gt;\n\n    &lt;key&gt;ProgramArguments&lt;/key&gt;\n    &lt;array&gt;\n        &lt;string&gt;/bin/zsh&lt;/string&gt;  &lt;!-- \u4f7f\u7528 zsh \u6216 bash --&gt;\n        &lt;string&gt;/Users/YourUsername/path/to/your_script.sh&lt;/string&gt;\n    &lt;/array&gt;\n\n    &lt;key&gt;StartCalendarInterval&lt;/key&gt;\n    &lt;dict&gt;\n        &lt;key&gt;Hour&lt;/key&gt;\n        &lt;integer&gt;12&lt;/integer&gt;  &lt;!-- \u4e2d\u534812\u70b9 --&gt;\n        &lt;key&gt;Minute&lt;/key&gt;\n        &lt;integer&gt;0&lt;/integer&gt;\n    &lt;/dict&gt;\n\n    &lt;key&gt;StandardOutPath&lt;/key&gt;\n    &lt;string&gt;/tmp/myscript.log&lt;/string&gt;\n    &lt;key&gt;StandardErrorPath&lt;/key&gt;\n    &lt;string&gt;/tmp/myscript_error.log&lt;/string&gt;\n&lt;/dict&gt;\n&lt;/plist&gt;\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_1","title":"\u52a0\u8f7d\u5e76\u542f\u7528\u670d\u52a1","text":"<pre><code># \u52a0\u8f7d\u670d\u52a1\nlaunchctl load ~/Library/LaunchAgents/com.user.myscript.plist\n\n# \u7acb\u5373\u542f\u52a8\u4e00\u6b21\uff08\u53ef\u9009\uff09\nlaunchctl start com.user.myscript\n\n# \u68c0\u67e5\u72b6\u6001\nlaunchctl list | grep com.user.myscript\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_2","title":"\u5e38\u7528\u65f6\u95f4\u8bbe\u7f6e","text":"\u95f4\u9694 \u8bbe\u7f6e\u793a\u4f8b \u6bcf\u5929 <code>&lt;key&gt;StartCalendarInterval&lt;/key&gt;</code> + Hour/Minute \u6bcf\u5468 \u6dfb\u52a0 <code>&lt;key&gt;Weekday&lt;/key&gt;</code> (1=\u5468\u65e5,7=\u5468\u516d) \u6bcf\u6708 \u6dfb\u52a0 <code>&lt;key&gt;Day&lt;/key&gt;</code> \u6bcf\u5206\u949f \u4f7f\u7528 <code>&lt;key&gt;StartInterval&lt;/key&gt;&lt;integer&gt;60&lt;/integer&gt;</code>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#2-crontab","title":"2. \u4f7f\u7528 crontab\uff08\u4f20\u7edf\u65b9\u6cd5\uff09","text":"<p>\u867d\u7136 launchd \u662f\u63a8\u8350\u65b9\u5f0f\uff0c\u4f46 cron \u4ecd\u7136\u53ef\u7528\uff1a</p> <ol> <li>\u7f16\u8f91 crontab\uff1a</li> </ol> <pre><code>crontab -e\n</code></pre> <ol> <li>\u6dfb\u52a0\u5b9a\u65f6\u4efb\u52a1\uff08\u6bcf\u5929\u4e2d\u534812\u70b9\u6267\u884c\uff09\uff1a</li> </ol> <pre><code>0 12 * * * /bin/zsh /Users/YourUsername/path/to/your_script.sh &gt;&gt; /tmp/cron.log 2&gt;&amp;1\n</code></pre> <ol> <li>\u4fdd\u5b58\u5e76\u9000\u51fa\uff08\u5728 nano \u4e2d\u6309 Ctrl+O, Enter, Ctrl+X\uff09</li> </ol>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#cron","title":"cron \u65f6\u95f4\u683c\u5f0f","text":"<pre><code>* * * * * \u547d\u4ee4\n\u2502 \u2502 \u2502 \u2502 \u2502\n\u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500 \u661f\u671f\u51e0 (0 - 6) (0\u4e3a\u661f\u671f\u65e5)\n\u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500 \u6708\u4efd (1 - 12)\n\u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500 \u65e5 (1 - 31)\n\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5c0f\u65f6 (0 - 23)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5206\u949f (0 - 59)\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_3","title":"\u8c03\u8bd5\u5355\u4e2a\u4efb\u52a1","text":"<pre><code># 1. \u624b\u52a8\u6a21\u62df cron \u73af\u5883\nenv -i /bin/bash -c \"cd / &amp;&amp; /path/to/script.sh\"\n\n# 2. \u4f7f\u7528 cron \u8c03\u8bd5\u6a21\u5f0f\n# \u521b\u5efa\u6d4b\u8bd5 crontab\necho \"* * * * * echo '\u6d4b\u8bd5: \\$(date)' &gt;&gt; /tmp/cron_test.log\" | crontab -\n\n# 3. \u68c0\u67e5\u4e00\u5206\u949f\u540e\u7684\u7ed3\u679c\nsleep 61\ncat /tmp/cron_test.log\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#3-automator","title":"3. \u4f7f\u7528 Automator \u5e94\u7528\u7a0b\u5e8f\uff08\u56fe\u5f62\u754c\u9762\uff09","text":"<p>\u9002\u5408\u4e0d\u9700\u8981\u590d\u6742\u8c03\u5ea6\u7684\u7b80\u5355\u4efb\u52a1\uff1a</p> <ol> <li> <p>\u6253\u5f00 Automator\uff08\u5e94\u7528\u7a0b\u5e8f \u2192 \u5b9e\u7528\u5de5\u5177\uff09</p> </li> <li> <p>\u9009\u62e9 \"\u5e94\u7528\u7a0b\u5e8f\" \u7c7b\u578b</p> </li> <li> <p>\u6dfb\u52a0 \"\u8fd0\u884c Shell \u811a\u672c\" \u64cd\u4f5c</p> </li> <li> <p>\u8f93\u5165\u811a\u672c\u5185\u5bb9</p> </li> <li> <p>\u4fdd\u5b58\u4e3a\u5e94\u7528\u7a0b\u5e8f\uff08\u5982\uff1aMyScript.app\uff09</p> </li> <li> <p>\u5728\u7cfb\u7edf\u8bbe\u7f6e\u4e2d\u8bbe\u7f6e\u5b9a\u65f6\uff1a</p> </li> <li> <p>\u6253\u5f00 \"\u7cfb\u7edf\u8bbe\u7f6e\" \u2192 \"\u901a\u7528\" \u2192 \"\u767b\u5f55\u9879\"</p> </li> <li> <p>\u6dfb\u52a0 MyScript.app</p> </li> <li> <p>\u70b9\u51fb \"i\" \u56fe\u6807\u8bbe\u7f6e\u6267\u884c\u65f6\u95f4</p> </li> </ol>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_4","title":"\u811a\u672c\u8c03\u8bd5\u6280\u5de7","text":"<ol> <li>\u6d4b\u8bd5\u811a\u672c\uff1a</li> </ol> <pre><code># \u76f4\u63a5\u8fd0\u884c\u6d4b\u8bd5\n/bin/zsh /path/to/your_script.sh\n\n# \u68c0\u67e5\u8f93\u51fa\necho $?\n</code></pre> <ol> <li>\u67e5\u770b\u65e5\u5fd7\uff1a</li> </ol> <pre><code># launchd \u65e5\u5fd7\ntail -f /tmp/myscript.log\ntail -f /tmp/myscript_error.log\n\n# cron \u65e5\u5fd7\ntail -f /tmp/cron.log\n</code></pre> <ol> <li>\u73af\u5883\u53d8\u91cf\u95ee\u9898\uff1a \u5728\u811a\u672c\u5f00\u5934\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\uff1a</li> </ol> <pre><code>#!/bin/zsh\n\n# \u52a0\u8f7d\u7528\u6237\u73af\u5883\nsource ~/.zshrc\n\n# \u811a\u672c\u5185\u5bb9...\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_5","title":"\u9ad8\u7ea7\u6280\u5de7","text":""},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_6","title":"\u7f51\u7edc\u4f9d\u8d56\u68c0\u6d4b","text":"<pre><code>#!/bin/zsh\n\n# \u7b49\u5f85\u7f51\u7edc\u8fde\u63a5\nwhile ! ping -c 1 -W 5 8.8.8.8 &amp;&gt; /dev/null; do\n    sleep 10\ndone\n\n# \u6267\u884c\u7f51\u7edc\u76f8\u5173\u64cd\u4f5c\ncurl -O https://example.com/file\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_7","title":"\u9632\u6b62\u811a\u672c\u91cd\u590d\u8fd0\u884c","text":"<pre><code>#!/bin/zsh\n\nLOCK_FILE=\"/tmp/myscript.lock\"\n\nif [ -e \"$LOCK_FILE\" ]; then\n    echo \"Script is already running. Exiting.\"\n    exit 1\nfi\n\n# \u521b\u5efa\u9501\u6587\u4ef6\ntouch \"$LOCK_FILE\"\n\n# \u4e3b\u811a\u672c\u5185\u5bb9...\n\n# \u6e05\u7406\u9501\u6587\u4ef6\nrm -f \"$LOCK_FILE\"\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_8","title":"\u90ae\u4ef6\u901a\u77e5","text":"<pre><code>#!/bin/zsh\n\n# \u6267\u884c\u811a\u672c\n/path/to/your_script.sh\n\n# \u68c0\u67e5\u9000\u51fa\u72b6\u6001\nif [ $? -ne 0 ]; then\n    # \u53d1\u9001\u9519\u8bef\u901a\u77e5\n    echo \"Script failed!\" | mail -s \"Script Error\" your@email.com\nfi\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_9","title":"\u5e38\u89c1\u95ee\u9898\u89e3\u51b3","text":"<ol> <li> <p>\u811a\u672c\u4e0d\u6267\u884c\uff1a</p> </li> <li> <p>\u68c0\u67e5\u6587\u4ef6\u6743\u9650\uff1a<code>chmod +x /path/to/your_script.sh</code></p> </li> <li> <p>\u68c0\u67e5\u811a\u672c\u8def\u5f84\u662f\u5426\u6b63\u786e</p> </li> <li> <p>\u9a8c\u8bc1\u73af\u5883\u53d8\u91cf\uff1a\u5728\u811a\u672c\u4e2d\u6dfb\u52a0 <code>env &gt; /tmp/script_env.log</code></p> </li> <li> <p>launchd \u4efb\u52a1\u4e0d\u8fd0\u884c\uff1a</p> </li> </ol> <pre><code># \u91cd\u65b0\u52a0\u8f7d\nlaunchctl unload ~/Library/LaunchAgents/com.user.myscript.plist\nlaunchctl load ~/Library/LaunchAgents/com.user.myscript.plist\n\n# \u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\nlog show --predicate 'process == \"launchd\"' --last 24h\n</code></pre> <ol> <li>cron \u4efb\u52a1\u4e0d\u8fd0\u884c\uff1a</li> </ol> <pre><code># \u68c0\u67e5 cron \u670d\u52a1\u72b6\u6001\nlaunchctl list | grep cron\n\n# \u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\ngrep cron /var/log/system.log\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_10","title":"\u5b89\u5168\u6ce8\u610f\u4e8b\u9879","text":"<ol> <li> <p>\u907f\u514d\u5728\u811a\u672c\u4e2d\u4f7f\u7528\u660e\u6587\u5bc6\u7801</p> </li> <li> <p>\u5bf9\u654f\u611f\u64cd\u4f5c\u4f7f\u7528\u6743\u9650\u63a7\u5236</p> </li> <li> <p>\u5b9a\u671f\u5ba1\u67e5\u5b9a\u65f6\u4efb\u52a1</p> </li> <li> <p>\u4f7f\u7528\u4e13\u7528\u7528\u6237\u8d26\u6237\u6267\u884c\u7279\u6743\u64cd\u4f5c</p> </li> </ol> <p>\u9009\u62e9\u5408\u9002\u7684\u65b9\u6cd5\u53d6\u51b3\u4e8e\u60a8\u7684\u9700\u6c42\uff1a</p> <ul> <li> <p>\u9700\u8981\u590d\u6742\u8c03\u5ea6 \u2192 \u4f7f\u7528 launchd</p> </li> <li> <p>\u7b80\u5355\u5b9a\u65f6\u4efb\u52a1 \u2192 \u4f7f\u7528 crontab</p> </li> <li> <p>\u56fe\u5f62\u754c\u9762\u504f\u597d \u2192 \u4f7f\u7528 Automator</p> </li> </ul>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/","title":"\ud83d\udd12 Certbot \u751f\u6210 Let\u2019s Encrypt \u8bc1\u4e66\u6559\u7a0b","text":""},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#_1","title":"\ud83d\udccc \u524d\u7f6e\u6761\u4ef6","text":"<ul> <li> <p>\u4e00\u53f0 Linux \u670d\u52a1\u5668\uff08Ubuntu/Debian/CentOS/RHEL \u5747\u53ef\uff09</p> </li> <li> <p>\u57df\u540d\u5df2\u89e3\u6790\u5230\u670d\u52a1\u5668\u516c\u7f51 IP</p> </li> <li> <p>\u670d\u52a1\u5668\u5f00\u653e 80\uff08HTTP\uff09\u7aef\u53e3\u7528\u4e8e\u57df\u540d\u9a8c\u8bc1</p> </li> <li> <p>\u5b89\u88c5\u5bf9\u5e94 Web \u670d\u52a1\u5668\uff08Nginx \u6216 Apache\uff09\u6216\u6253\u7b97\u7528 Standalone \u6a21\u5f0f</p> </li> </ul>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#1-certbot","title":"1\ufe0f\u20e3 \u5b89\u88c5 Certbot","text":""},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#ubuntu-debian","title":"Ubuntu / Debian","text":"<pre><code>sudo apt update\nsudo apt install certbot -y\n# \u5b89\u88c5 Nginx \u63d2\u4ef6\uff08\u53ef\u9009\uff09\nsudo apt install python3-certbot-nginx -y\n# \u5b89\u88c5 Apache \u63d2\u4ef6\uff08\u53ef\u9009\uff09\nsudo apt install python3-certbot-apache -y\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#centos-rhel","title":"CentOS / RHEL","text":"<pre><code>sudo yum install epel-release -y\nsudo yum install certbot python3-certbot-nginx -y\nsudo yum install python3-certbot-apache -y\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#2","title":"2\ufe0f\u20e3 \u751f\u6210\u8bc1\u4e66","text":"<p>Certbot \u652f\u6301\u591a\u79cd\u9a8c\u8bc1\u6a21\u5f0f\uff1a</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#awebroot-web","title":"\u65b9\u5f0f A\uff1aWebroot \u6a21\u5f0f\uff08\u9002\u5408\u5df2\u6709 Web \u670d\u52a1\uff09","text":"<pre><code>sudo certbot certonly \\\n  --webroot -w /var/www/html \\\n  -d example.com -d www.example.com\n</code></pre> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <ul> <li> <p><code>--webroot -w /var/www/html</code>\uff1a\u7f51\u7ad9\u6839\u76ee\u5f55\uff0c\u7528\u4e8e\u653e\u7f6e\u9a8c\u8bc1\u6587\u4ef6</p> </li> <li> <p><code>-d example.com -d www.example.com</code>\uff1a\u57df\u540d\u5217\u8868\uff0c\u53ef\u591a\u4e2a</p> </li> <li> <p>\u6267\u884c\u540e\u4f1a\u751f\u6210\u8bc1\u4e66\uff0c\u9ed8\u8ba4\u8def\u5f84\uff1a</p> <ul> <li> <p><code>/etc/letsencrypt/live/example.com/fullchain.pem</code>\uff08\u5b8c\u6574\u8bc1\u4e66\uff09</p> </li> <li> <p><code>/etc/letsencrypt/live/example.com/privkey.pem</code>\uff08\u79c1\u94a5\uff09</p> </li> </ul> </li> </ul>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#bstandalone-web","title":"\u65b9\u5f0f B\uff1aStandalone \u6a21\u5f0f\uff08\u65e0 Web \u670d\u52a1\u6216\u6d4b\u8bd5\u7528\uff09","text":"<pre><code>sudo certbot certonly --standalone -d example.com -d www.example.com\n</code></pre> <ul> <li> <p>Certbot \u4f1a\u542f\u52a8\u4e34\u65f6 HTTP \u670d\u52a1\u76d1\u542c 80 \u7aef\u53e3\u5b8c\u6210\u9a8c\u8bc1</p> </li> <li> <p>\u6210\u529f\u540e\u8bc1\u4e66\u540c\u6837\u5b58\u653e\u5728 <code>/etc/letsencrypt/live/</code> \u4e0b</p> </li> </ul>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#c-nginx-apache","title":"\u65b9\u5f0f C\uff1a\u81ea\u52a8\u914d\u7f6e Nginx / Apache\uff08\u63a8\u8350\u751f\u4ea7\u73af\u5883\uff09","text":""},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#nginx","title":"Nginx","text":"<pre><code>sudo certbot --nginx -d example.com -d www.example.com\n</code></pre> <ul> <li> <p>Certbot \u4f1a\u81ea\u52a8\u4fee\u6539 Nginx \u914d\u7f6e\uff0c\u52a0\u5165 HTTPS \u914d\u7f6e</p> </li> <li> <p>\u8bc1\u4e66\u81ea\u52a8\u751f\u6548\uff0c\u4e14\u751f\u6210\u81ea\u52a8\u7eed\u671f\u4efb\u52a1</p> </li> </ul>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#apache","title":"Apache","text":"<pre><code>sudo certbot --apache -d example.com -d www.example.com\n</code></pre> <ul> <li>\u529f\u80fd\u4e0e Nginx \u7c7b\u4f3c\uff0c\u4f1a\u81ea\u52a8\u542f\u7528 HTTPS</li> </ul>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#3","title":"3\ufe0f\u20e3 \u6d4b\u8bd5\u8bc1\u4e66\u7eed\u671f","text":"<p>Let\u2019s Encrypt \u8bc1\u4e66\u6709\u6548\u671f 90 \u5929\uff0c\u9700\u8981\u81ea\u52a8\u7eed\u671f\u3002Certbot \u5b89\u88c5\u540e\u4f1a\u9ed8\u8ba4\u521b\u5efa\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\uff08cron \u6216 systemd timer\uff09</p> <p>\u624b\u52a8\u6d4b\u8bd5\u7eed\u671f\u547d\u4ee4\uff1a</p> <pre><code>sudo certbot renew --dry-run\n</code></pre> <ul> <li> <p>\u8f93\u51fa <code>Congratulations, all renewals succeeded.</code> \u8868\u793a\u7eed\u671f\u529f\u80fd\u6b63\u5e38</p> </li> <li> <p>\u5efa\u8bae\u6bcf\u5929\u6216\u6bcf\u5468\u68c0\u67e5\u4e00\u6b21</p> </li> </ul>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#4","title":"4\ufe0f\u20e3 \u4f7f\u7528\u8bc1\u4e66\uff08\u793a\u4f8b\uff09","text":"<p>\u5047\u8bbe\u4f60\u7528 Teleport / Nginx / Apache\uff1a</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#teleport","title":"Teleport \u914d\u7f6e","text":"<pre><code>https_key_file: /etc/letsencrypt/live/example.com/privkey.pem\nhttps_cert_file: /etc/letsencrypt/live/example.com/fullchain.pem\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#nginx-https","title":"Nginx \u914d\u7f6e\uff08HTTPS\uff09","text":"<pre><code>server {\n    listen 443 ssl;\n    server_name example.com;\n\n    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;\n\n    location / {\n        proxy_pass http://127.0.0.1:3080;\n    }\n}\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%94%92%20Certbot%20%E7%94%9F%E6%88%90%20Let%E2%80%99s%20Encrypt%20%E8%AF%81%E4%B9%A6%E6%95%99%E7%A8%8B/#5","title":"5\ufe0f\u20e3 \u5e38\u7528\u547d\u4ee4\u603b\u7ed3","text":"\u547d\u4ee4 \u8bf4\u660e <code>sudo certbot certonly --standalone -d example.com</code> \u5355\u72ec\u751f\u6210\u8bc1\u4e66 <code>sudo certbot --nginx -d example.com</code> \u81ea\u52a8 Nginx \u914d\u7f6e\u5e76\u751f\u6210\u8bc1\u4e66 <code>sudo certbot renew --dry-run</code> \u6d4b\u8bd5\u7eed\u671f <code>/etc/letsencrypt/live/example.com/fullchain.pem</code> \u8bc1\u4e66\u8def\u5f84 <code>/etc/letsencrypt/live/example.com/privkey.pem</code> \u79c1\u94a5\u8def\u5f84"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/","title":"\ud83d\udd50\u5728 Mac \u4e0a\u5b9a\u65f6\u6267\u884c\u811a\u672c\u7684\u5b8c\u6574\u6307\u5357","text":"<p>\u5728 macOS \u4e0a\u5b9a\u65f6\u6267\u884c\u811a\u672c\u6709\u591a\u79cd\u65b9\u6cd5\uff0c\u4ee5\u4e0b\u662f\u4e09\u79cd\u4e3b\u8981\u65b9\u5f0f\u53ca\u5176\u8be6\u7ec6\u8bf4\u660e\uff1a</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#1-launchd","title":"1. \u4f7f\u7528 launchd\uff08\u63a8\u8350\u65b9\u6cd5\uff09","text":"<p>launchd \u662f macOS \u7684\u539f\u751f\u5b88\u62a4\u8fdb\u7a0b\u7ba1\u7406\u7cfb\u7edf\uff0c\u6bd4 cron \u66f4\u5f3a\u5927\u4e14\u652f\u6301\u66f4\u591a\u529f\u80fd\u3002</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#plist","title":"\u521b\u5efa plist \u6587\u4ef6","text":"<ol> <li>\u5728 <code>~/Library/LaunchAgents/</code> \u76ee\u5f55\u521b\u5efa plist \u6587\u4ef6\uff1a</li> </ol> <pre><code>nano ~/Library/LaunchAgents/com.user.myscript.plist\n</code></pre> <ol> <li>\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff08\u6bcf\u65e5\u4e2d\u534812\u70b9\u6267\u884c\uff09\uff1a</li> </ol> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;\n&lt;plist version=\"1.0\"&gt;\n&lt;dict&gt;\n    &lt;key&gt;Label&lt;/key&gt;\n    &lt;string&gt;com.user.myscript&lt;/string&gt;\n\n    &lt;key&gt;ProgramArguments&lt;/key&gt;\n    &lt;array&gt;\n        &lt;string&gt;/bin/zsh&lt;/string&gt;  &lt;!-- \u4f7f\u7528 zsh \u6216 bash --&gt;\n        &lt;string&gt;/Users/YourUsername/path/to/your_script.sh&lt;/string&gt;\n    &lt;/array&gt;\n\n    &lt;key&gt;StartCalendarInterval&lt;/key&gt;\n    &lt;dict&gt;\n        &lt;key&gt;Hour&lt;/key&gt;\n        &lt;integer&gt;12&lt;/integer&gt;  &lt;!-- \u4e2d\u534812\u70b9 --&gt;\n        &lt;key&gt;Minute&lt;/key&gt;\n        &lt;integer&gt;0&lt;/integer&gt;\n    &lt;/dict&gt;\n\n    &lt;key&gt;StandardOutPath&lt;/key&gt;\n    &lt;string&gt;/tmp/myscript.log&lt;/string&gt;\n    &lt;key&gt;StandardErrorPath&lt;/key&gt;\n    &lt;string&gt;/tmp/myscript_error.log&lt;/string&gt;\n&lt;/dict&gt;\n&lt;/plist&gt;\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_1","title":"\u52a0\u8f7d\u5e76\u542f\u7528\u670d\u52a1","text":"<pre><code># \u52a0\u8f7d\u670d\u52a1\nlaunchctl load ~/Library/LaunchAgents/com.user.myscript.plist\n\n# \u7acb\u5373\u542f\u52a8\u4e00\u6b21\uff08\u53ef\u9009\uff09\nlaunchctl start com.user.myscript\n\n# \u68c0\u67e5\u72b6\u6001\nlaunchctl list | grep com.user.myscript\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_2","title":"\u5e38\u7528\u65f6\u95f4\u8bbe\u7f6e","text":"\u95f4\u9694 \u8bbe\u7f6e\u793a\u4f8b \u6bcf\u5929 <code>&lt;key&gt;StartCalendarInterval&lt;/key&gt;</code> + Hour/Minute \u6bcf\u5468 \u6dfb\u52a0 <code>&lt;key&gt;Weekday&lt;/key&gt;</code> (1=\u5468\u65e5,7=\u5468\u516d) \u6bcf\u6708 \u6dfb\u52a0 <code>&lt;key&gt;Day&lt;/key&gt;</code> \u6bcf\u5206\u949f \u4f7f\u7528 <code>&lt;key&gt;StartInterval&lt;/key&gt;&lt;integer&gt;60&lt;/integer&gt;</code>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#2-crontab","title":"2. \u4f7f\u7528 crontab\uff08\u4f20\u7edf\u65b9\u6cd5\uff09","text":"<p>\u867d\u7136 launchd \u662f\u63a8\u8350\u65b9\u5f0f\uff0c\u4f46 cron \u4ecd\u7136\u53ef\u7528\uff1a</p> <ol> <li>\u7f16\u8f91 crontab\uff1a</li> </ol> <pre><code>crontab -e\n</code></pre> <ol> <li>\u6dfb\u52a0\u5b9a\u65f6\u4efb\u52a1\uff08\u6bcf\u5929\u4e2d\u534812\u70b9\u6267\u884c\uff09\uff1a</li> </ol> <pre><code>0 12 * * * /bin/zsh /Users/YourUsername/path/to/your_script.sh &gt;&gt; /tmp/cron.log 2&gt;&amp;1\n</code></pre> <ol> <li>\u4fdd\u5b58\u5e76\u9000\u51fa\uff08\u5728 nano \u4e2d\u6309 Ctrl+O, Enter, Ctrl+X\uff09</li> </ol>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#cron","title":"cron \u65f6\u95f4\u683c\u5f0f","text":"<pre><code>* * * * * \u547d\u4ee4\n\u2502 \u2502 \u2502 \u2502 \u2502\n\u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500 \u661f\u671f\u51e0 (0 - 6) (0\u4e3a\u661f\u671f\u65e5)\n\u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500 \u6708\u4efd (1 - 12)\n\u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500 \u65e5 (1 - 31)\n\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5c0f\u65f6 (0 - 23)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5206\u949f (0 - 59)\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_3","title":"\u8c03\u8bd5\u5355\u4e2a\u4efb\u52a1","text":"<pre><code># 1. \u624b\u52a8\u6a21\u62df cron \u73af\u5883\nenv -i /bin/bash -c \"cd / &amp;&amp; /path/to/script.sh\"\n\n# 2. \u4f7f\u7528 cron \u8c03\u8bd5\u6a21\u5f0f\n# \u521b\u5efa\u6d4b\u8bd5 crontab\necho \"* * * * * echo '\u6d4b\u8bd5: \\$(date)' &gt;&gt; /tmp/cron_test.log\" | crontab -\n\n# 3. \u68c0\u67e5\u4e00\u5206\u949f\u540e\u7684\u7ed3\u679c\nsleep 61\ncat /tmp/cron_test.log\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#3-automator","title":"3. \u4f7f\u7528 Automator \u5e94\u7528\u7a0b\u5e8f\uff08\u56fe\u5f62\u754c\u9762\uff09","text":"<p>\u9002\u5408\u4e0d\u9700\u8981\u590d\u6742\u8c03\u5ea6\u7684\u7b80\u5355\u4efb\u52a1\uff1a</p> <ol> <li> <p>\u6253\u5f00 Automator\uff08\u5e94\u7528\u7a0b\u5e8f \u2192 \u5b9e\u7528\u5de5\u5177\uff09</p> </li> <li> <p>\u9009\u62e9 \"\u5e94\u7528\u7a0b\u5e8f\" \u7c7b\u578b</p> </li> <li> <p>\u6dfb\u52a0 \"\u8fd0\u884c Shell \u811a\u672c\" \u64cd\u4f5c</p> </li> <li> <p>\u8f93\u5165\u811a\u672c\u5185\u5bb9</p> </li> <li> <p>\u4fdd\u5b58\u4e3a\u5e94\u7528\u7a0b\u5e8f\uff08\u5982\uff1aMyScript.app\uff09</p> </li> <li> <p>\u5728\u7cfb\u7edf\u8bbe\u7f6e\u4e2d\u8bbe\u7f6e\u5b9a\u65f6\uff1a</p> </li> <li> <p>\u6253\u5f00 \"\u7cfb\u7edf\u8bbe\u7f6e\" \u2192 \"\u901a\u7528\" \u2192 \"\u767b\u5f55\u9879\"</p> </li> <li> <p>\u6dfb\u52a0 MyScript.app</p> </li> <li> <p>\u70b9\u51fb \"i\" \u56fe\u6807\u8bbe\u7f6e\u6267\u884c\u65f6\u95f4</p> </li> </ol>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_4","title":"\u811a\u672c\u8c03\u8bd5\u6280\u5de7","text":"<ol> <li>\u6d4b\u8bd5\u811a\u672c\uff1a</li> </ol> <pre><code># \u76f4\u63a5\u8fd0\u884c\u6d4b\u8bd5\n/bin/zsh /path/to/your_script.sh\n\n# \u68c0\u67e5\u8f93\u51fa\necho $?\n</code></pre> <ol> <li>\u67e5\u770b\u65e5\u5fd7\uff1a</li> </ol> <pre><code># launchd \u65e5\u5fd7\ntail -f /tmp/myscript.log\ntail -f /tmp/myscript_error.log\n\n# cron \u65e5\u5fd7\ntail -f /tmp/cron.log\n</code></pre> <ol> <li>\u73af\u5883\u53d8\u91cf\u95ee\u9898\uff1a \u5728\u811a\u672c\u5f00\u5934\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\uff1a</li> </ol> <pre><code>#!/bin/zsh\n\n# \u52a0\u8f7d\u7528\u6237\u73af\u5883\nsource ~/.zshrc\n\n# \u811a\u672c\u5185\u5bb9...\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_5","title":"\u9ad8\u7ea7\u6280\u5de7","text":""},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_6","title":"\u7f51\u7edc\u4f9d\u8d56\u68c0\u6d4b","text":"<pre><code>#!/bin/zsh\n\n# \u7b49\u5f85\u7f51\u7edc\u8fde\u63a5\nwhile ! ping -c 1 -W 5 8.8.8.8 &amp;&gt; /dev/null; do\n    sleep 10\ndone\n\n# \u6267\u884c\u7f51\u7edc\u76f8\u5173\u64cd\u4f5c\ncurl -O https://example.com/file\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_7","title":"\u9632\u6b62\u811a\u672c\u91cd\u590d\u8fd0\u884c","text":"<pre><code>#!/bin/zsh\n\nLOCK_FILE=\"/tmp/myscript.lock\"\n\nif [ -e \"$LOCK_FILE\" ]; then\n    echo \"Script is already running. Exiting.\"\n    exit 1\nfi\n\n# \u521b\u5efa\u9501\u6587\u4ef6\ntouch \"$LOCK_FILE\"\n\n# \u4e3b\u811a\u672c\u5185\u5bb9...\n\n# \u6e05\u7406\u9501\u6587\u4ef6\nrm -f \"$LOCK_FILE\"\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_8","title":"\u90ae\u4ef6\u901a\u77e5","text":"<pre><code>#!/bin/zsh\n\n# \u6267\u884c\u811a\u672c\n/path/to/your_script.sh\n\n# \u68c0\u67e5\u9000\u51fa\u72b6\u6001\nif [ $? -ne 0 ]; then\n    # \u53d1\u9001\u9519\u8bef\u901a\u77e5\n    echo \"Script failed!\" | mail -s \"Script Error\" your@email.com\nfi\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_9","title":"\u5e38\u89c1\u95ee\u9898\u89e3\u51b3","text":"<ol> <li> <p>\u811a\u672c\u4e0d\u6267\u884c\uff1a</p> </li> <li> <p>\u68c0\u67e5\u6587\u4ef6\u6743\u9650\uff1a<code>chmod +x /path/to/your_script.sh</code></p> </li> <li> <p>\u68c0\u67e5\u811a\u672c\u8def\u5f84\u662f\u5426\u6b63\u786e</p> </li> <li> <p>\u9a8c\u8bc1\u73af\u5883\u53d8\u91cf\uff1a\u5728\u811a\u672c\u4e2d\u6dfb\u52a0 <code>env &gt; /tmp/script_env.log</code></p> </li> <li> <p>launchd \u4efb\u52a1\u4e0d\u8fd0\u884c\uff1a</p> </li> </ol> <pre><code># \u91cd\u65b0\u52a0\u8f7d\nlaunchctl unload ~/Library/LaunchAgents/com.user.myscript.plist\nlaunchctl load ~/Library/LaunchAgents/com.user.myscript.plist\n\n# \u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\nlog show --predicate 'process == \"launchd\"' --last 24h\n</code></pre> <ol> <li>cron \u4efb\u52a1\u4e0d\u8fd0\u884c\uff1a</li> </ol> <pre><code># \u68c0\u67e5 cron \u670d\u52a1\u72b6\u6001\nlaunchctl list | grep cron\n\n# \u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\ngrep cron /var/log/system.log\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%95%90%E5%9C%A8%20Mac%20%E4%B8%8A%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#_10","title":"\u5b89\u5168\u6ce8\u610f\u4e8b\u9879","text":"<ol> <li> <p>\u907f\u514d\u5728\u811a\u672c\u4e2d\u4f7f\u7528\u660e\u6587\u5bc6\u7801</p> </li> <li> <p>\u5bf9\u654f\u611f\u64cd\u4f5c\u4f7f\u7528\u6743\u9650\u63a7\u5236</p> </li> <li> <p>\u5b9a\u671f\u5ba1\u67e5\u5b9a\u65f6\u4efb\u52a1</p> </li> <li> <p>\u4f7f\u7528\u4e13\u7528\u7528\u6237\u8d26\u6237\u6267\u884c\u7279\u6743\u64cd\u4f5c</p> </li> </ol> <p>\u9009\u62e9\u5408\u9002\u7684\u65b9\u6cd5\u53d6\u51b3\u4e8e\u60a8\u7684\u9700\u6c42\uff1a</p> <ul> <li> <p>\u9700\u8981\u590d\u6742\u8c03\u5ea6 \u2192 \u4f7f\u7528 launchd</p> </li> <li> <p>\u7b80\u5355\u5b9a\u65f6\u4efb\u52a1 \u2192 \u4f7f\u7528 crontab</p> </li> <li> <p>\u56fe\u5f62\u754c\u9762\u504f\u597d \u2192 \u4f7f\u7528 Automator</p> </li> </ul>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/","title":"\ud83d\ude80 Teleport Community Edition \u5b89\u88c5\u4e0e\u5165\u95e8\u6559\u7a0b","text":""},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#_1","title":"\ud83d\udccc \u524d\u7f6e\u6761\u4ef6","text":"<p>\u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u8bf7\u51c6\u5907\u597d\u4ee5\u4e0b\u73af\u5883\uff1a</p> <p>\u2714\ufe0f \u4e00\u53f0 Linux \u670d\u52a1\u5668\uff08\u652f\u6301 SSH \u767b\u5f55\u3001\u8fd0\u884c\u8f6f\u4ef6\u3001\u5f00 443 \u7aef\u53e3\uff09 \u2714\ufe0f \u5982\u679c\u8981\u5728\u516c\u7f51\u90e8\u7f72\uff1a\u4e00\u4e2a \u57df\u540d\uff08\u6bd4\u5982 <code>teleport.example.com</code>\uff09 \u2714\ufe0f \u4e00\u4e2a DNS A \u8bb0\u5f55 \u6307\u5411\u670d\u52a1\u5668 IP \u2714\ufe0f \u4e00\u4e2a \u591a\u56e0\u7d20\u8ba4\u8bc1\uff08MFA\uff09\u5e94\u7528\uff08\u5982 Authy / Google Authenticator / 1Password\uff09</p> <p>\u5bf9\u4e8e\u5728\u672c\u5730 Docker \u5bb9\u5668\u6d4b\u8bd5\uff0c\u53ef\u7701\u7565\u57df\u540d\u548c DNS \u76f8\u5173\u8bbe\u7f6e\u3002(Teleport)</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#teleport","title":"\ud83e\udde0 Teleport \u67b6\u6784\u7b80\u4ecb","text":"<p>Teleport Community Edition \u4e3b\u8981\u5305\u542b\uff1a</p> <ul> <li> <p>Auth Service\uff1a\u8bc1\u4e66\u6388\u6743\u4e0e\u8ba4\u8bc1\u670d\u52a1</p> </li> <li> <p>Proxy Service\uff1a\u5165\u53e3\u4ee3\u7406\uff0c\u5904\u7406\u7528\u6237\u8bf7\u6c42</p> </li> <li> <p>SSH Service\uff1a\u63d0\u4f9b SSH \u8bbf\u95ee\u529f\u80fd</p> </li> </ul> <p>\u8fd9\u4e9b\u7ec4\u4ef6\u5408\u5e76\u8fd0\u884c\u5728\u4e00\u4e2a\u5b9e\u4f8b\u4e2d\u5373\u53ef\u5b8c\u6210\u6700\u57fa\u672c\u7684\u90e8\u7f72\u3002(Teleport)</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#dns","title":"\ud83e\ude84 \u4e00\u3001\u914d\u7f6e DNS\uff08\u4ec5\u516c\u7f51\u90e8\u7f72\uff09","text":"<p>\u4e3a\u4f60\u7684\u57df\u540d\u6dfb\u52a0 DNS A \u8bb0\u5f55\u6307\u5411\u670d\u52a1\u5668 IP\uff1a</p> \u5b50\u57df\u540d \u7528\u9014 <code>teleport.example.com</code> \u7528\u4e8e Web UI \u548c\u7528\u6237\u8bbf\u95ee <code>*.teleport.example.com</code> \u7528\u4e8e\u5e94\u7528\u8bbf\u95ee\u7684\u52a8\u6001\u5b50\u57df\u540d <p>\u5982\u679c\u5728 Docker \u5bb9\u5668\u672c\u5730\u6d4b\u8bd5\uff0c\u53ef\u8df3\u8fc7\u6b64\u6b65\u9aa4\u3002(Teleport)</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#linux-teleport","title":"\ud83d\udee0 \u4e8c\u3001\u5728 Linux \u4e3b\u673a\u4e0a\u5b89\u88c5 Teleport","text":""},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#1-teleport","title":"1. \u4e0b\u8f7d\u5e76\u5b89\u88c5 Teleport \u4e8c\u8fdb\u5236","text":"<p>\u5728\u670d\u52a1\u5668\u7ec8\u7aef\u8fd0\u884c\uff1a</p> <pre><code>curl https://cdn.teleport.dev/install.sh | bash -s 18.6.1\n</code></pre> <p>\u8fd9\u5c06\u81ea\u52a8\u4e0b\u8f7d\u5b89\u88c5\u811a\u672c\u5e76\u5c06 Teleport \u5b89\u88c5\u5230\u7cfb\u7edf\u4e2d\u3002(Teleport)</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#2","title":"2. \u751f\u6210\u914d\u7f6e\u6587\u4ef6","text":"<p>\u6839\u636e\u4f60\u7684\u90e8\u7f72\u7c7b\u578b\u751f\u6210\u914d\u7f6e\uff1a</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#lets-encrypt","title":"\u516c\u7f51\u90e8\u7f72\uff08\u4f7f\u7528 Let\u2019s Encrypt \u81ea\u52a8\u8bc1\u4e66\uff09","text":"<pre><code>sudo teleport configure -o file \\\n  --acme \\\n  --acme-email=you@example.com \\\n  --cluster-name=teleport.example.com\n</code></pre> <ul> <li> <p><code>--acme</code> \u8868\u793a\u4f7f\u7528 Let\u2019s Encrypt \u81ea\u52a8\u83b7\u53d6 HTTPS \u8bc1\u4e66</p> </li> <li> <p><code>--cluster-name</code> \u586b\u4f60\u7684\u57df\u540d</p> </li> <li> <p><code>--acme-email</code> \u586b\u4e00\u4e2a\u90ae\u7bb1\u7528\u4e8e\u8bc1\u4e66\u901a\u77e5</p> </li> <li> <p>\u9700\u8981\u6253\u5f00 443 HTTPS \u7aef\u53e3\u4f9b Let\u2019s Encrypt \u9a8c\u8bc1\u548c\u7528\u6237\u8bbf\u95ee (Teleport)</p> </li> </ul>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#docker","title":"\u672c\u5730 Docker / \u79c1\u6709\u7f51\u7edc\u6d4b\u8bd5","text":"<p>\u5982\u679c\u662f\u5728 Docker \u6216\u65e0\u516c\u5f00\u57df\u540d\u73af\u5883\u4e0b\uff0c\u53ef\u4ee5\u751f\u6210\u81ea\u7b7e\u8bc1\u4e66\u914d\u7f6e\uff1a</p> <pre><code>teleport configure -o file \\\n  --cluster-name=localhost \\\n  --public-addr=localhost:443 \\\n  --cert-file=/path/to/cert.pem \\\n  --key-file=/path/to/key.pem\n</code></pre> <p>\ud83d\udccc \u6ce8\u610f\uff1a\u672c\u5730\u6d4b\u8bd5\u9700\u63d0\u524d\u51c6\u5907\u597d\u81ea\u7b7e\u8bc1\u4e66\u6216\u7528 Docker \u73af\u5883\u63d0\u4f9b\u8bc1\u4e66\u6587\u4ef6\u3002(Teleport)</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#teleport_1","title":"\u25b6\ufe0f \u4e09\u3001\u542f\u52a8 Teleport","text":""},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#_2","title":"\u542f\u52a8\u670d\u52a1","text":"<ol> <li>\u542f\u7528 Systemd \u7cfb\u7edf\u670d\u52a1\uff1a</li> </ol> <pre><code>sudo systemctl enable teleport\nsudo systemctl start teleport\n</code></pre> <ol> <li>\u6216\u76f4\u63a5\u7528\u547d\u4ee4\u542f\u52a8\uff08\u9002\u5408\u5bb9\u5668\u6216\u5f00\u53d1\u573a\u666f\uff09\uff1a</li> </ol> <pre><code>teleport start --config=\"/etc/teleport.yaml\"\n</code></pre>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#teleport_2","title":"\ud83c\udf10 \u56db\u3001\u8bbf\u95ee Teleport \u63a7\u5236\u53f0","text":"<p>\u6253\u5f00\u6d4f\u89c8\u5668\u8bbf\u95ee\uff1a</p> <ul> <li> <p>\u5982\u679c\u662f\u516c\u7f51\u90e8\u7f72\uff1a <code>https://teleport.example.com</code></p> </li> <li> <p>\u5982\u679c\u662f\u5728 Docker \u672c\u5730\u6d4b\u8bd5\uff1a <code>https://localhost:3080</code></p> </li> </ul> <p>\u4f60\u5e94\u8be5\u80fd\u770b\u5230 Teleport \u7684 \u6b22\u8fce\u754c\u9762\u3002(Teleport)</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#mfa","title":"\ud83d\udc64 \u4e94\u3001\u521b\u5efa\u7528\u6237 &amp; \u914d\u7f6e MFA","text":"<ol> <li>\u5728\u670d\u52a1\u5668\u4e0a\u521b\u5efa\u7ba1\u7406\u5458\u7528\u6237\uff1a</li> </ol> <pre><code>sudo tctl users add teleport-admin --roles=editor,access --logins=root,ubuntu,ec2-user\n</code></pre> <ul> <li> <p><code>teleport-admin</code> \u662f\u7528\u6237\u540d</p> </li> <li> <p><code>--roles</code> \u5b9a\u4e49\u6743\u9650\u89d2\u8272</p> </li> <li> <p><code>--logins</code> \u6307\u5b9a\u7528\u6237\u53ef\u767b\u5f55\u7684 Linux \u7cfb\u7edf\u8d26\u53f7 (Teleport)</p> </li> <li> <p>\u4e0a\u8ff0\u547d\u4ee4\u4f1a\u8f93\u51fa\u4e00\u4e2a\u6ce8\u518c\u94fe\u63a5\uff0c\u6bd4\u5982\uff1a</p> </li> </ul> <pre><code>https://teleport.example.com/web/invite/abcd1234...\n</code></pre> <p>\u6253\u5f00\u8be5\u94fe\u63a5\u8bbe\u7f6e\u7528\u6237\u5bc6\u7801\u5e76\u626b\u63cf MFA \u4e8c\u7ef4\u7801\u3002</p> <p>\ud83d\udccc \u7528\u6237\u8bbe\u7f6e\u5b8c\u6210\u540e\uff0cTeleport \u4f1a\u5f3a\u5236\u5f00\u542f MFA\u3002(Teleport)</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#_3","title":"\ud83d\udcbb \u516d\u3001\u901a\u8fc7\u547d\u4ee4\u884c\u767b\u5f55","text":"<ol> <li>\u5728\u672c\u5730\u7ec8\u7aef\u5b89\u88c5 Teleport \u5ba2\u6237\u7aef <code>tsh</code>\uff08\u5404\u5e73\u53f0\u652f\u6301\uff09\uff1a</li> </ol> <pre><code># \u793a\u4f8b macOS\ncurl -O https://cdn.teleport.dev/teleport-18.6.1.pkg\n</code></pre> <ol> <li>\u767b\u5f55\u5230 Teleport \u96c6\u7fa4\uff1a</li> </ol> <pre><code>tsh login --proxy=teleport.example.com --user=teleport-admin\n</code></pre> <p>\u767b\u5f55\u540e\uff0c\u4f60\u5c06\u83b7\u5f97\u77ed\u671f\u8bc1\u4e66\u7528\u4e8e\u540e\u7eed\u8bbf\u95ee\u3002(Teleport)</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#teleport_3","title":"\ud83d\udda5 \u4e03\u3001\u901a\u8fc7 Teleport \u8bbf\u95ee\u670d\u52a1\u5668","text":"<p>\u6210\u529f\u767b\u5f55\u540e\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 Web UI \u8bbf\u95ee\u670d\u52a1\u5668\u7ec8\u7aef\uff1a</p> <p>\ud83d\udc49 \u70b9\u51fb\u670d\u52a1\u5668\u8282\u70b9\uff0c\u7136\u540e\u9009\u62e9 Connect \u6216\u4f7f\u7528 <code>tsh</code> \u8fdc\u7a0b\u8fde\u63a5\uff1a</p> <pre><code>tsh ssh root@&lt;server-name&gt;\n</code></pre> <p>\u8fd9\u6837\u4f60\u5c31\u80fd\u901a\u8fc7 Teleport \u8fdb\u884c SSH \u8bbf\u95ee\u3002(Teleport)</p>"},{"location":"wiki/%E7%B3%BB%E7%BB%9F%E7%B1%BB/%F0%9F%9A%80%20Teleport%20Community%20Edition%20%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/#_4","title":"\ud83c\udfaf \u603b\u7ed3","text":"<p>\u8fd9\u5957\u6d41\u7a0b\u53ef\u4ee5\u5e2e\u52a9\u4f60\uff1a</p> <p>\u2705 \u5b89\u88c5\u5e76\u542f\u52a8 Teleport Community Edition \u2705 \u914d\u7f6e HTTPS \u548c\u8bc1\u4e66\uff08\u652f\u6301 Let\u2019s Encrypt\uff09 \u2705 \u521b\u5efa\u7528\u6237\u5e76\u542f\u7528 MFA \u2705 \u4f7f\u7528 Web UI \u548c CLI \u8bbf\u95ee\u53d7\u4fdd\u62a4\u7684\u670d\u52a1\u5668</p>"},{"location":"wiki/%E9%87%8F%E5%8C%96/%E9%87%8F%E5%8C%96%E7%B3%BB%E7%BB%9F%E9%9C%80%E6%B1%82%E6%96%87%E6%A1%A3/","title":"\u91cf\u5316\u7cfb\u7edf\u9700\u6c42\u6587\u6863","text":""},{"location":"wiki/%E9%87%8F%E5%8C%96/%E5%8C%BA%E5%9D%97%E9%93%BE/BSC%E5%85%AC%E9%93%BE/","title":"BSC\u516c\u94fe","text":""},{"location":"wiki/%E9%87%8F%E5%8C%96/%E5%8C%BA%E5%9D%97%E9%93%BE/BSC%E5%85%AC%E9%93%BE/#_1","title":"\u672c\u5730\u8282\u70b9\u642d\u5efa","text":""},{"location":"wiki/%E9%87%8F%E5%8C%96/%E5%8C%BA%E5%9D%97%E9%93%BE/BSC%E5%85%AC%E9%93%BE/#_2","title":"\u8282\u70b9\u7c7b\u578b","text":"<ol> <li>\u9a8c\u8bc1\u8282\u70b9\uff08Validator Node\uff09 \u7279\u70b9\u4e0e\u804c\u8d23\uff1a</li> <li>\u8d1f\u8d23\u533a\u5757\u751f\u4ea7\u548c\u9a8c\u8bc1</li> <li>\u53c2\u4e0e\u7f51\u7edc\u5171\u8bc6</li> <li>BSC\u4e3b\u7f51\u4ec5\u670921\u4e2a\u9a8c\u8bc1\u8282\u70b9</li> <li>\u9700\u8981\u8d28\u62bcBNB\u4ee3\u5e01</li> <li>\u7531\u793e\u533a\u6295\u7968\u9009\u4e3e\u4ea7\u751f \u8981\u6c42\uff1a</li> <li>\u81f3\u5c11\u9700\u8981\u8d28\u62bc10000\u4e2aBNB</li> <li>\u9ad8\u6027\u80fd\u786c\u4ef6\u914d\u7f6e</li> <li>\u7a33\u5b9a\u7684\u7f51\u7edc\u8fde\u63a5\u548c\u5197\u4f59\u65b9\u6848</li> <li>99.9%\u4ee5\u4e0a\u7684\u6b63\u5e38\u8fd0\u884c\u65f6\u95f4 \u5e94\u7528\u573a\u666f\uff1a</li> <li>\u533a\u5757\u94fe\u6838\u5fc3\u57fa\u7840\u8bbe\u65bd\u8fd0\u8425</li> <li>\u9700\u8981\u83b7\u5f97\u51fa\u5757\u5956\u52b1\u7684\u673a\u6784</li> <li>\u5168\u8282\u70b9\uff08Full Node\uff09 \u7279\u70b9\u4e0e\u804c\u8d23\uff1a</li> <li>\u5b58\u50a8\u5b8c\u6574\u7684\u533a\u5757\u6570\u636e</li> <li>\u53ef\u4ee5\u72ec\u7acb\u9a8c\u8bc1\u6240\u6709\u4ea4\u6613</li> <li>\u4e0d\u4fdd\u7559\u5386\u53f2\u72b6\u6001\uff08\u4ec5\u4fdd\u7559\u6700\u65b0\u72b6\u6001\uff09 \u6280\u672f\u7ec6\u8282\uff1a</li> <li>\u4f7f\u7528--syncmode full\u542f\u52a8</li> <li>\u5b58\u50a8\u6240\u6709\u533a\u5757\u5934\u548c\u533a\u5757\u4f53</li> <li>\u53ea\u4fdd\u7559\u6700\u65b0\u7684\u72b6\u6001\u6570\u636e \u5b58\u50a8\u9700\u6c42\uff1a</li> <li>\u7ea6\u97002-3TB\u5b58\u50a8\u7a7a\u95f4\uff08\u968f\u94fe\u589e\u957f\u800c\u589e\u52a0\uff09 \u5e94\u7528\u573a\u666f\uff1a</li> <li>\u4ea4\u6613\u6240\u94b1\u5305\u670d\u52a1</li> <li>DApp\u540e\u7aef\u652f\u6301</li> <li>\u9700\u8981\u9a8c\u8bc1\u4ea4\u6613\u7684\u670d\u52a1</li> <li>\u5b58\u6863\u8282\u70b9\uff08Archive Node\uff09 \u7279\u70b9\u4e0e\u804c\u8d23\uff1a</li> <li>\u5b58\u50a8\u94fe\u4e0a\u5168\u90e8\u5386\u53f2\u6570\u636e\u548c\u72b6\u6001</li> <li>\u652f\u6301\u5bf9\u4efb\u610f\u5386\u53f2\u533a\u5757\u72b6\u6001\u7684\u67e5\u8be2 \u6280\u672f\u7ec6\u8282\uff1a</li> <li>\u4f7f\u7528--syncmode full --gcmode archive\u542f\u52a8</li> <li>\u4fdd\u5b58\u6240\u6709\u5386\u53f2\u72b6\u6001\u548c\u4ea4\u6613\u6570\u636e \u5b58\u50a8\u9700\u6c42\uff1a</li> <li>\u9700\u89818TB\u4ee5\u4e0a\u5b58\u50a8\u7a7a\u95f4</li> <li>\u4ee5\u6bcf\u6708150-200GB\u901f\u5ea6\u589e\u957f \u5e94\u7528\u573a\u666f\uff1a</li> <li>\u533a\u5757\u6d4f\u89c8\u5668</li> <li>\u94fe\u4e0a\u6570\u636e\u5206\u6790</li> <li>\u9700\u8981\u67e5\u8be2\u5386\u53f2\u72b6\u6001\u7684\u670d\u52a1</li> <li>\u5ba1\u8ba1\u548c\u5408\u89c4\u670d\u52a1</li> <li>\u5feb\u7167\u8282\u70b9\uff08Snap Node\uff09 \u7279\u70b9\u4e0e\u804c\u8d23\uff1a</li> <li>BSC 1.1.0+\u7248\u672c\u5f15\u5165\u7684\u65b0\u578b\u8282\u70b9</li> <li>\u4f7f\u7528\u5feb\u7167\u6280\u672f\u52a0\u901f\u540c\u6b65</li> <li>\u6570\u636e\u5b58\u50a8\u6548\u7387\u66f4\u9ad8 \u6280\u672f\u7ec6\u8282\uff1a</li> <li>\u4f7f\u7528--syncmode snap\u542f\u52a8</li> <li>\u901a\u8fc7\u72b6\u6001\u5feb\u7167\u52a0\u901f\u540c\u6b65\u8fc7\u7a0b</li> <li>\u540c\u6b65\u65f6\u95f4\u6bd4\u5168\u8282\u70b9\u5feb50-80% \u5b58\u50a8\u9700\u6c42\uff1a</li> <li>\u7ea6\u97001.5-2TB\u5b58\u50a8\u7a7a\u95f4 \u5e94\u7528\u573a\u666f\uff1a</li> <li>\u9700\u8981\u5feb\u901f\u542f\u52a8\u7684\u8282\u70b9</li> <li>\u4e00\u822c\u7684RPC\u670d\u52a1\u63d0\u4f9b</li> <li>\u94b1\u5305\u540e\u7aef\u670d\u52a1</li> <li>\u8f7b\u8282\u70b9\uff08Light Node\uff09 \u7279\u70b9\u4e0e\u804c\u8d23\uff1a</li> <li>\u53ea\u4e0b\u8f7d\u533a\u5757\u5934</li> <li>\u901a\u8fc7\u9ed8\u514b\u5c14\u8bc1\u660e\u9a8c\u8bc1\u4ea4\u6613</li> <li>\u8d44\u6e90\u5360\u7528\u6781\u5c0f \u6280\u672f\u7ec6\u8282\uff1a</li> <li>\u4f7f\u7528--syncmode light\u542f\u52a8</li> <li>\u4f9d\u8d56\u5168\u8282\u70b9\u63d0\u4f9b\u6570\u636e \u5b58\u50a8\u9700\u6c42\uff1a</li> <li>\u51e0GB\u5230\u51e0\u5341GB \u5e94\u7528\u573a\u666f\uff1a</li> <li>\u79fb\u52a8\u94b1\u5305</li> <li>\u8d44\u6e90\u53d7\u9650\u7684\u73af\u5883 IoT\u8bbe\u5907</li> <li>RPC\u8282\u70b9 \u7279\u70b9\u4e0e\u804c\u8d23\uff1a</li> <li>\u63d0\u4f9bJSON-RPC\u63a5\u53e3\u670d\u52a1</li> <li>\u53ef\u4ee5\u662f\u57fa\u4e8e\u5168\u8282\u70b9\u3001\u5feb\u7167\u8282\u70b9\u6216\u5b58\u6863\u8282\u70b9 \u6280\u672f\u7ec6\u8282\uff1a</li> <li>\u4f7f\u7528--http --ws\u7b49\u53c2\u6570\u542f\u7528RPC\u670d\u52a1</li> <li>\u914d\u7f6e\u5141\u8bb8\u7684API\u548c\u8bbf\u95ee\u63a7\u5236 \u5e94\u7528\u573a\u666f\uff1a</li> <li>\u4e3aDApp\u63d0\u4f9b\u63a5\u53e3\u670d\u52a1</li> <li>\u4e3a\u94b1\u5305\u63d0\u4f9b\u67e5\u8be2\u63a5\u53e3</li> <li>\u4f5c\u4e3a\u94fe\u4e0a\u6570\u636e\u8bbf\u95ee\u5165\u53e3</li> <li>\u5feb\u901f\u540c\u6b65\u8282\u70b9\uff08Fast Node\uff09 \u7279\u70b9\u4e0e\u804c\u8d23\uff1a</li> <li>\u4ecb\u4e8e\u5168\u8282\u70b9\u548c\u8f7b\u8282\u70b9\u4e4b\u95f4</li> <li>\u53ea\u4e0b\u8f7d\u6700\u8fd1\u7684\u72b6\u6001 \u6280\u672f\u7ec6\u8282\uff1a</li> <li>\u4f7f\u7528--syncmode fast\u542f\u52a8\uff08\u73b0\u5df2\u88absnap\u6a21\u5f0f\u53d6\u4ee3\uff09</li> <li>\u5728BSC\u8f83\u65b0\u7248\u672c\u4e2d\u63a8\u8350\u4f7f\u7528snap\u4ee3\u66fffast \u5e94\u7528\u573a\u666f\uff1a</li> <li>\u6b63\u5728\u88ab\u5feb\u7167\u6a21\u5f0f\u9010\u6b65\u66ff\u4ee3</li> </ol>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/","title":"\u5238\u5546\u98ce\u9669\u670d\u52a1 - \u5f3a\u5e73\u6a21\u5757\u8bbe\u8ba1\u65b9\u6848","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#_1","title":"\u4e00\u3001\u6982\u8ff0","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#11","title":"1.1 \u4e1a\u52a1\u80cc\u666f","text":"<p>\u5f3a\u5e73\u6a21\u5757\u662f\u5238\u5546\u98ce\u9669\u670d\u52a1\u7684\u6838\u5fc3\u6a21\u5757\uff0c\u7528\u4e8e\u5728\u7528\u6237\u98ce\u9669\u7387\uff08RR\uff09\u8fbe\u5230\u5371\u9669\u9608\u503c\u65f6\uff0c\u81ea\u52a8\u6267\u884c\u5f3a\u5236\u5e73\u4ed3\u64cd\u4f5c\uff0c\u4ee5\u4fdd\u62a4\u5238\u5546\u548c\u7528\u6237\u7684\u8d44\u91d1\u5b89\u5168\u3002</p>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#12","title":"1.2 \u6838\u5fc3\u6307\u6807","text":"<p>\u98ce\u9669\u7387\uff08RR\uff09\u8ba1\u7b97\u516c\u5f0f\uff1a</p> <pre><code>RR = (ELV - EL) / ELV\n\n\u5176\u4e2d\uff1a\n- NLV = Cash - Loan + Position (\u51c0\u6e05\u7b97\u4ef7\u503c)\n- ELV = NLV - OMV (\u542b\u501f\u6743\u76ca\u4ef7\u503c\uff0cOMV\u4e3a\u671f\u6743\u5e02\u503c)\n- EL = ELV - MM + Credit (\u5269\u4f59\u6d41\u52a8\u6027\uff0cMM\u4e3a\u7ef4\u6301\u4fdd\u8bc1\u91d1\uff0cCredit\u4e3a\u989d\u5916\u4fe1\u7528\u989d\u5ea6)\n</code></pre> <p>\u89e6\u53d1\u6761\u4ef6\uff1a</p> <ul> <li> <p>RR &lt;= 80\uff1a\u89e6\u53d1 margin call \u9884\u8b66</p> </li> <li> <p>RR &lt;= 0\uff1a\u89e6\u53d1\u5f3a\u5236\u5e73\u4ed3</p> </li> </ul>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#13","title":"1.3 \u8bbe\u8ba1\u76ee\u6807","text":"<ol> <li> <p>\u5e42\u7b49\u6027\uff1a\u786e\u4fdd\u540c\u4e00\u5f3a\u5e73\u4efb\u52a1\u4e0d\u4f1a\u91cd\u590d\u6267\u884c</p> </li> <li> <p>\u53ef\u68c0\u6d4b\u6027\uff1a\u80fd\u591f\u5b9e\u65f6\u67e5\u8be2\u4efb\u52a1\u72b6\u6001\u548c\u6267\u884c\u7ed3\u679c</p> </li> <li> <p>\u53ef\u6062\u590d\u6027\uff1a\u4efb\u52a1\u5931\u8d25\u540e\u80fd\u591f\u81ea\u52a8\u6216\u624b\u52a8\u6062\u590d\u6267\u884c</p> </li> <li> <p>\u6570\u636e\u4e00\u81f4\u6027\uff1a\u5904\u7406\u7528\u6237\u624b\u52a8\u5e73\u4ed3\u3001\u8865\u5145\u4fdd\u8bc1\u91d1\u7b49\u5e76\u53d1\u573a\u666f</p> </li> <li> <p>\u9ad8\u53ef\u7528\u6027\uff1a\u652f\u6301\u5206\u5e03\u5f0f\u90e8\u7f72\uff0c\u907f\u514d\u5355\u70b9\u6545\u969c</p> </li> </ol>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#_2","title":"\u4e8c\u3001\u6570\u636e\u5e93\u8bbe\u8ba1","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#21-risk_force_sell_task","title":"2.1 \u5f3a\u5e73\u4efb\u52a1\u8868 (risk_force_sell_task)","text":"<pre><code>CREATE TABLE `risk_force_sell_task` (\n  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '\u4e3b\u952eID',\n  `uid` bigint(20) NOT NULL COMMENT '\u7528\u6237ID',\n  `customer_id` bigint(20) NOT NULL COMMENT '\u5ba2\u6237ID',\n  `task_id` char(32) NOT NULL COMMENT '\u4efb\u52a1ID\uff0c\u5168\u5c40\u552f\u4e00',\n  `status` tinyint(4) NOT NULL DEFAULT '1' COMMENT '\u4efb\u52a1\u72b6\u6001\uff1a1-\u5f85\u6267\u884c 2-\u6267\u884c\u4e2d 3-\u90e8\u5206\u5b8c\u6210 4-\u5df2\u5b8c\u6210 5-\u5df2\u53d6\u6d88 6-\u6267\u884c\u5931\u8d25',\n  `rr` decimal(10,4) NOT NULL COMMENT '\u89e6\u53d1\u65f6\u7684\u98ce\u9669\u7387',\n  `rr_version` bigint(20) NOT NULL COMMENT 'RR\u8ba1\u7b97\u7ed3\u679c\u7248\u672c\u53f7\uff0c\u7528\u4e8e\u5e42\u7b49\u63a7\u5236',\n  `target_rr` decimal(10,4) DEFAULT NULL COMMENT '\u76ee\u6807\u98ce\u9669\u7387\uff0c\u5e73\u4ed3\u540e\u5e94\u8fbe\u5230\u7684\u98ce\u9669\u7387',\n  `total_position_value` decimal(20,4) DEFAULT NULL COMMENT '\u9700\u8981\u5e73\u4ed3\u7684\u603b\u4ed3\u4f4d\u4ef7\u503c',\n  `executed_position_value` decimal(20,4) DEFAULT '0.0000' COMMENT '\u5df2\u6267\u884c\u7684\u5e73\u4ed3\u4ef7\u503c',\n  `retry_count` int(11) NOT NULL DEFAULT '0' COMMENT '\u91cd\u8bd5\u6b21\u6570',\n  `max_retry` int(11) NOT NULL DEFAULT '3' COMMENT '\u6700\u5927\u91cd\u8bd5\u6b21\u6570',\n  `next_retry_at` datetime DEFAULT NULL COMMENT '\u4e0b\u6b21\u91cd\u8bd5\u65f6\u95f4',\n  `started_at` datetime DEFAULT NULL COMMENT '\u5f00\u59cb\u6267\u884c\u65f6\u95f4',\n  `completed_at` datetime DEFAULT NULL COMMENT '\u5b8c\u6210\u65f6\u95f4',\n  `cancelled_at` datetime DEFAULT NULL COMMENT '\u53d6\u6d88\u65f6\u95f4',\n  `cancel_reason` varchar(500) DEFAULT NULL COMMENT '\u53d6\u6d88\u539f\u56e0',\n  `extra` json DEFAULT NULL COMMENT '\u6269\u5c55\u4fe1\u606f\uff0cJSON\u683c\u5f0f',\n  `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '\u66f4\u65b0\u65f6\u95f4',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_task_id` (`task_id`),\n  UNIQUE KEY `uk_uid_rr_version` (`uid`,`rr_version`),\n  KEY `idx_uid_status` (`uid`,`status`),\n  KEY `idx_status_retry` (`status`,`next_retry_at`),\n  KEY `idx_created_at` (`created_at`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='\u5f3a\u5e73\u4efb\u52a1\u8868';\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#22-risk_force_sell_task_detail","title":"2.2 \u5f3a\u5e73\u4efb\u52a1\u8be6\u60c5\u8868 (risk_force_sell_task_detail)","text":"<pre><code>CREATE TABLE `risk_force_sell_task_detail` (\n  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '\u4e3b\u952eID',\n  `task_id` char(32) NOT NULL COMMENT '\u4efb\u52a1ID',\n  `uid` bigint(20) NOT NULL COMMENT '\u7528\u6237ID',\n  `customer_id` bigint(20) NOT NULL COMMENT '\u5ba2\u6237ID',\n  `symbol` varchar(50) NOT NULL COMMENT '\u4ea4\u6613\u6807\u7684\u4ee3\u7801',\n  `price_type` tinyint(4) NOT NULL COMMENT '\u4ef7\u683c\u7c7b\u578b\uff1a1-\u5e02\u4ef7 2-\u9650\u4ef7',\n  `limit_price` decimal(20,4) DEFAULT NULL COMMENT '\u9650\u4ef7\u4ef7\u683c\uff08\u9650\u4ef7\u5355\u65f6\u4f7f\u7528\uff09',\n  `direction` tinyint(4) NOT NULL COMMENT '\u4ea4\u6613\u65b9\u5411\uff1a1-\u4e70\u5165 2-\u5356\u51fa',\n  `side` tinyint(4) NOT NULL COMMENT '\u4ed3\u4f4d\u65b9\u5411\uff1a1-\u591a\u4ed3(long) 2-\u7a7a\u4ed3(short)',\n  `target_quantity` decimal(20,8) NOT NULL COMMENT '\u76ee\u6807\u5e73\u4ed3\u6570\u91cf',\n  `executed_quantity` decimal(20,8) NOT NULL DEFAULT '0.00000000' COMMENT '\u5df2\u6267\u884c\u6570\u91cf',\n  `trade_price` decimal(20,4) DEFAULT NULL COMMENT '\u6210\u4ea4\u4ef7\u683c',\n  `status` tinyint(4) NOT NULL DEFAULT '1' COMMENT '\u72b6\u6001\uff1a1-\u5f85\u6267\u884c 2-\u6267\u884c\u4e2d 3-\u6267\u884c\u6210\u529f 4-\u6267\u884c\u5931\u8d25 5-\u5df2\u53d6\u6d88 6-\u90e8\u5206\u6210\u4ea4',\n  `retry_count` int(11) NOT NULL DEFAULT '0' COMMENT '\u91cd\u8bd5\u6b21\u6570',\n  `order_id` varchar(64) DEFAULT NULL COMMENT '\u8ba2\u5355ID\uff08\u4ea4\u6613\u7cfb\u7edf\u8fd4\u56de\uff09',\n  `c_order_id` varchar(64) NOT NULL COMMENT '\u81ea\u5b9a\u4e49\u8ba2\u5355ID\uff0c\u7528\u4e8e\u5e42\u7b49\u63a7\u5236',\n  `executed_at` datetime DEFAULT NULL COMMENT '\u6267\u884c\u65f6\u95f4',\n  `reason` varchar(500) DEFAULT NULL COMMENT '\u5931\u8d25\u6216\u53d6\u6d88\u539f\u56e0',\n  `extra` json DEFAULT NULL COMMENT '\u6269\u5c55\u4fe1\u606f\uff0cJSON\u683c\u5f0f',\n  `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '\u66f4\u65b0\u65f6\u95f4',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_c_order_id` (`c_order_id`),\n  KEY `idx_task_id` (`task_id`),\n  KEY `idx_uid_symbol` (`uid`,`symbol`),\n  KEY `idx_status` (`status`),\n  KEY `idx_order_id` (`order_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='\u5f3a\u5e73\u4efb\u52a1\u8be6\u60c5\u8868';\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#23-risk_force_sell_task_log","title":"2.3 \u5f3a\u5e73\u4efb\u52a1\u6267\u884c\u65e5\u5fd7\u8868 (risk_force_sell_task_log)","text":"<pre><code>CREATE TABLE `risk_force_sell_task_log` (\n  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '\u4e3b\u952eID',\n  `task_id` char(32) NOT NULL COMMENT '\u4efb\u52a1ID',\n  `detail_id` bigint(20) DEFAULT NULL COMMENT '\u4efb\u52a1\u8be6\u60c5ID',\n  `action` varchar(50) NOT NULL COMMENT '\u64cd\u4f5c\u7c7b\u578b\uff1aCREATE, EXECUTE, RETRY, CANCEL, COMPLETE, FAIL',\n  `old_status` tinyint(4) DEFAULT NULL COMMENT '\u539f\u72b6\u6001',\n  `new_status` tinyint(4) DEFAULT NULL COMMENT '\u65b0\u72b6\u6001',\n  `message` varchar(1000) DEFAULT NULL COMMENT '\u65e5\u5fd7\u6d88\u606f',\n  `operator` varchar(50) DEFAULT NULL COMMENT '\u64cd\u4f5c\u4eba\uff1aSYSTEM, ADMIN, USER',\n  `extra` json DEFAULT NULL COMMENT '\u6269\u5c55\u4fe1\u606f\uff0cJSON\u683c\u5f0f',\n  `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  PRIMARY KEY (`id`),\n  KEY `idx_task_id` (`task_id`),\n  KEY `idx_detail_id` (`detail_id`),\n  KEY `idx_created_at` (`created_at`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='\u5f3a\u5e73\u4efb\u52a1\u6267\u884c\u65e5\u5fd7\u8868';\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#24-margin-call-risk_margin_call_warning","title":"2.4 Margin Call \u9884\u8b66\u8bb0\u5f55\u8868 (risk_margin_call_warning)","text":"<pre><code>CREATE TABLE `risk_margin_call_warning` (\n  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '\u4e3b\u952eID',\n  `uid` bigint(20) NOT NULL COMMENT '\u7528\u6237ID',\n  `customer_id` bigint(20) NOT NULL COMMENT '\u5ba2\u6237ID',\n  `rr` decimal(10,4) NOT NULL COMMENT '\u98ce\u9669\u7387',\n  `rr_version` bigint(20) NOT NULL COMMENT 'RR\u8ba1\u7b97\u7ed3\u679c\u7248\u672c\u53f7',\n  `warning_type` tinyint(4) NOT NULL COMMENT '\u9884\u8b66\u7c7b\u578b\uff1a1-\u9996\u6b21\u9884\u8b66 2-\u91cd\u590d\u9884\u8b66',\n  `notification_status` tinyint(4) NOT NULL DEFAULT '0' COMMENT '\u901a\u77e5\u72b6\u6001\uff1a0-\u672a\u901a\u77e5 1-\u5df2\u901a\u77e5',\n  `notification_at` datetime DEFAULT NULL COMMENT '\u901a\u77e5\u65f6\u95f4',\n  `extra` json DEFAULT NULL COMMENT '\u6269\u5c55\u4fe1\u606f\uff0cJSON\u683c\u5f0f',\n  `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  PRIMARY KEY (`id`),\n  KEY `idx_uid_rr_version` (`uid`,`rr_version`),\n  KEY `idx_created_at` (`created_at`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='Margin Call\u9884\u8b66\u8bb0\u5f55\u8868';\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#_3","title":"\u4e09\u3001\u7f13\u5b58\u8bbe\u8ba1","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#31-redis","title":"3.1 Redis \u952e\u503c\u8bbe\u8ba1","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#311","title":"3.1.1 \u8d26\u6237\u7ea7\u5206\u5e03\u5f0f\u9501","text":"<pre><code>Key: risk:liquidation:lock:{uid}\nValue: {task_id}\nTTL: 30s\n\u8bf4\u660e: \u9632\u6b62\u540c\u4e00\u8d26\u6237\u5e76\u53d1\u6267\u884c\u591a\u4e2a\u5f3a\u5e73\u4efb\u52a1\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#312","title":"3.1.2 \u4efb\u52a1\u6267\u884c\u9501","text":"<pre><code>Key: risk:liquidation:exec:lock:{task_id}\nValue: {worker_id}:{timestamp}\nTTL: 60s\n\u8bf4\u660e: \u9632\u6b62\u540c\u4e00\u4efb\u52a1\u88ab\u591a\u4e2aworker\u91cd\u590d\u6267\u884c\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#313","title":"3.1.3 \u5e42\u7b49\u63a7\u5236","text":"<pre><code>Key: risk:liquidation:idempotent:{uid}:{rr_version}\nValue: {task_id}\nTTL: 3600s (1\u5c0f\u65f6)\n\u8bf4\u660e: \u57fa\u4e8eRR\u7248\u672c\u53f7\u7684\u5e42\u7b49\u63a7\u5236\uff0c\u9632\u6b62\u540c\u4e00RR\u7248\u672c\u91cd\u590d\u89e6\u53d1\u5f3a\u5e73\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#314","title":"3.1.4 \u8ba2\u5355\u5e42\u7b49\u63a7\u5236","text":"<pre><code>Key: risk:liquidation:order:idempotent:{c_order_id}\nValue: {order_id}\nTTL: 86400s (24\u5c0f\u65f6)\n\u8bf4\u660e: \u57fa\u4e8e\u81ea\u5b9a\u4e49\u8ba2\u5355ID\u7684\u5e42\u7b49\u63a7\u5236\uff0c\u9632\u6b62\u91cd\u590d\u4e0b\u5355\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#315-margin-call","title":"3.1.5 Margin Call \u9884\u8b66\u9891\u63a7","text":"<pre><code>Key: risk:margin:call:warning:{uid}\nValue: {rr_version}:{timestamp}\nTTL: 300s (5\u5206\u949f)\n\u8bf4\u660e: \u9632\u6b62\u77ed\u65f6\u95f4\u5185\u91cd\u590d\u53d1\u9001\u9884\u8b66\u901a\u77e5\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#316","title":"3.1.6 \u4efb\u52a1\u72b6\u6001\u7f13\u5b58","text":"<pre><code>Key: risk:liquidation:task:{task_id}\nValue: JSON\u683c\u5f0f\u7684\u4efb\u52a1\u4fe1\u606f\nTTL: 3600s (1\u5c0f\u65f6)\n\u8bf4\u660e: \u7f13\u5b58\u4efb\u52a1\u57fa\u672c\u4fe1\u606f\uff0c\u51cf\u5c11\u6570\u636e\u5e93\u67e5\u8be2\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#317","title":"3.1.7 \u7528\u6237\u6301\u4ed3\u5feb\u7167","text":"<pre><code>Key: risk:liquidation:position:snapshot:{uid}:{task_id}\nValue: JSON\u683c\u5f0f\u7684\u6301\u4ed3\u4fe1\u606f\nTTL: 1800s (30\u5206\u949f)\n\u8bf4\u660e: \u7f13\u5b58\u5f3a\u5e73\u65f6\u7684\u6301\u4ed3\u5feb\u7167\uff0c\u7528\u4e8e\u540e\u7eed\u4e00\u81f4\u6027\u6821\u9a8c\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#32","title":"3.2 \u7f13\u5b58\u66f4\u65b0\u7b56\u7565","text":"<ol> <li> <p>\u5199\u64cd\u4f5c\uff1a\u5148\u66f4\u65b0\u6570\u636e\u5e93\uff0c\u518d\u66f4\u65b0\u7f13\u5b58\uff08Write-Through\uff09</p> </li> <li> <p>\u8bfb\u64cd\u4f5c\uff1a\u5148\u8bfb\u7f13\u5b58\uff0c\u7f13\u5b58\u672a\u547d\u4e2d\u5219\u8bfb\u6570\u636e\u5e93\u5e76\u56de\u5199\u7f13\u5b58</p> </li> <li> <p>\u5931\u6548\u7b56\u7565\uff1a\u4efb\u52a1\u72b6\u6001\u53d8\u66f4\u65f6\u4e3b\u52a8\u5220\u9664\u76f8\u5173\u7f13\u5b58</p> </li> </ol>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#_4","title":"\u56db\u3001\u6574\u4f53\u6d41\u7a0b\u56fe","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#41-rr","title":"4.1 RR \u76d1\u542c\u4e0e\u5f3a\u5e73\u89e6\u53d1\u6d41\u7a0b","text":"<pre><code>flowchart TD\n    Start([\u5f00\u59cb]) --&gt; MonitorRR[\u76d1\u542cRR\u8ba1\u7b97\u7ed3\u679c]\n    MonitorRR --&gt; CheckUnfinished{\u662f\u5426\u6709\u672a\u5b8c\u6210\u7684&lt;br/&gt;\u5f3a\u5e73\u4efb\u52a1?}\n    CheckUnfinished --&gt;|\u662f| CheckTaskStatus{\u68c0\u67e5\u4efb\u52a1\u72b6\u6001}\n    CheckTaskStatus --&gt;|\u6267\u884c\u4e2d/\u5f85\u6267\u884c| MonitorRR\n    CheckTaskStatus --&gt;|\u5df2\u5b8c\u6210/\u5df2\u53d6\u6d88| CheckRR\n    CheckUnfinished --&gt;|\u5426| CheckRR{\u68c0\u67e5RR\u503c}\n\n    CheckRR --&gt;|RR &gt; 80| End1([\u7ed3\u675f])\n    CheckRR --&gt;|80 &gt;= RR &gt; 0| MarginCall[\u89e6\u53d1Margin Call\u9884\u8b66]\n    MarginCall --&gt; CheckWarningFreq{\u68c0\u67e5\u9884\u8b66\u9891\u63a7}\n    CheckWarningFreq --&gt;|\u672a\u8d85\u8fc7\u9891\u63a7| SendWarning[\u53d1\u9001\u9884\u8b66\u901a\u77e5]\n    CheckWarningFreq --&gt;|\u8d85\u8fc7\u9891\u63a7| SkipWarning[\u8df3\u8fc7\u672c\u6b21\u9884\u8b66]\n    SendWarning --&gt; RecordWarning[\u8bb0\u5f55\u9884\u8b66\u65e5\u5fd7]\n    SkipWarning --&gt; RecordWarning\n    RecordWarning --&gt; End1\n\n    CheckRR --&gt;|RR &lt;= 0| CheckIdempotent{\u68c0\u67e5\u5e42\u7b49\u6027&lt;br/&gt;uid:rr_version}\n    CheckIdempotent --&gt;|\u5df2\u5b58\u5728\u4efb\u52a1| End1\n    CheckIdempotent --&gt;|\u4e0d\u5b58\u5728| AcquireLock[\u83b7\u53d6\u8d26\u6237\u9501&lt;br/&gt;risk:liquidation:lock:uid]\n    AcquireLock --&gt;|\u83b7\u53d6\u5931\u8d25| End1\n    AcquireLock --&gt;|\u83b7\u53d6\u6210\u529f| CreateTask[\u521b\u5efa\u5f3a\u5e73\u4efb\u52a1]\n    CreateTask --&gt; QueryPosition[\u67e5\u8be2\u7528\u6237\u6301\u4ed3]\n    QueryPosition --&gt; SortPosition[\u6301\u4ed3\u6392\u5e8f&lt;br/&gt;\u6309\u4f18\u5148\u7ea7\u89c4\u5219]\n    SortPosition --&gt; CalcLiquidation[\u8ba1\u7b97\u5f3a\u5e73\u4ed3\u4f4d&lt;br/&gt;\u76ee\u6807RR\u6062\u590d\u503c]\n    CalcLiquidation --&gt; CreateDetails[\u521b\u5efa\u4efb\u52a1\u8be6\u60c5]\n    CreateDetails --&gt; PublishKafka[\u53d1\u5e03Kafka\u6d88\u606f&lt;br/&gt;key=uid]\n    PublishKafka --&gt; ReleaseLock[\u91ca\u653e\u8d26\u6237\u9501]\n    ReleaseLock --&gt; End1\n\n    style MarginCall fill:#fff4a3\n    style CreateTask fill:#ff6b6b\n    style AcquireLock fill:#4ecdc4\n    style CheckIdempotent fill:#95e1d3\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#42","title":"4.2 \u5f3a\u5e73\u6267\u884c\u6d41\u7a0b\uff08\u542b\u5e42\u7b49\u3001\u53ef\u68c0\u6d4b\u3001\u53ef\u6062\u590d\uff09","text":"<pre><code>flowchart TD\n    Start([Kafka\u6d88\u8d39\u6d88\u606f]) --&gt; GetTask[\u83b7\u53d6\u4efb\u52a1\u4fe1\u606f]\n    GetTask --&gt; CheckTaskStatus{\u68c0\u67e5\u4efb\u52a1\u72b6\u6001}\n    CheckTaskStatus --&gt;|\u5df2\u5b8c\u6210/\u5df2\u53d6\u6d88| End1([\u7ed3\u675f])\n    CheckTaskStatus --&gt;|\u5f85\u6267\u884c/\u6267\u884c\u4e2d| AcquireExecLock[\u83b7\u53d6\u6267\u884c\u9501&lt;br/&gt;risk:liquidation:exec:lock:task_id]\n\n    AcquireExecLock --&gt;|\u83b7\u53d6\u5931\u8d25| End1\n    AcquireExecLock --&gt;|\u83b7\u53d6\u6210\u529f| UpdateStatus1[\u66f4\u65b0\u4efb\u52a1\u72b6\u6001\u4e3a\u6267\u884c\u4e2d]\n    UpdateStatus1 --&gt; LoadDetails[\u52a0\u8f7d\u4efb\u52a1\u8be6\u60c5\u5217\u8868]\n    LoadDetails --&gt; CheckConsistency{\u6570\u636e\u4e00\u81f4\u6027\u68c0\u67e5}\n\n    CheckConsistency --&gt;|\u68c0\u67e5\u6301\u4ed3\u53d8\u5316| GetCurrentPosition[\u83b7\u53d6\u5f53\u524d\u6301\u4ed3]\n    GetCurrentPosition --&gt; ComparePosition[\u5bf9\u6bd4\u6301\u4ed3\u5feb\u7167]\n    ComparePosition --&gt;|\u6301\u4ed3\u5df2\u53d8\u5316| RecalcLiquidation{\u91cd\u65b0\u8ba1\u7b97&lt;br/&gt;\u662f\u5426\u9700\u8981\u5e73\u4ed3}\n    RecalcLiquidation --&gt;|RR\u5df2\u6062\u590d| CancelTask[\u53d6\u6d88\u4efb\u52a1&lt;br/&gt;\u8bb0\u5f55\u539f\u56e0]\n    RecalcLiquidation --&gt;|\u4ecd\u9700\u5e73\u4ed3| AdjustDetails[\u8c03\u6574\u5e73\u4ed3\u6570\u91cf]\n    ComparePosition --&gt;|\u6301\u4ed3\u672a\u53d8\u5316| ProcessDetails\n\n    CancelTask --&gt; LogCancel[\u8bb0\u5f55\u53d6\u6d88\u65e5\u5fd7]\n    LogCancel --&gt; ReleaseExecLock1[\u91ca\u653e\u6267\u884c\u9501]\n    ReleaseExecLock1 --&gt; End1\n\n    AdjustDetails --&gt; ProcessDetails[\u904d\u5386\u4efb\u52a1\u8be6\u60c5]\n    ProcessDetails --&gt; ForEachDetail{\u904d\u5386\u6bcf\u4e2a\u8be6\u60c5}\n\n    ForEachDetail --&gt; CheckDetailStatus{\u68c0\u67e5\u8be6\u60c5\u72b6\u6001}\n    CheckDetailStatus --&gt;|\u5df2\u5b8c\u6210/\u5df2\u53d6\u6d88| NextDetail[\u4e0b\u4e00\u4e2a\u8be6\u60c5]\n    CheckDetailStatus --&gt;|\u5f85\u6267\u884c/\u6267\u884c\u4e2d/\u5931\u8d25| CheckOrderIdempotent{\u68c0\u67e5\u8ba2\u5355\u5e42\u7b49&lt;br/&gt;c_order_id}\n\n    CheckOrderIdempotent --&gt;|\u8ba2\u5355\u5df2\u5b58\u5728| QueryOrderStatus[\u67e5\u8be2\u8ba2\u5355\u72b6\u6001]\n    QueryOrderStatus --&gt; UpdateDetailStatus[\u66f4\u65b0\u8be6\u60c5\u72b6\u6001]\n    UpdateDetailStatus --&gt; NextDetail\n\n    CheckOrderIdempotent --&gt;|\u8ba2\u5355\u4e0d\u5b58\u5728| PlaceOrder[\u4e0b\u5355&lt;br/&gt;\u4f7f\u7528c_order_id]\n    PlaceOrder --&gt;|\u4e0b\u5355\u6210\u529f| UpdateDetailStatus2[\u66f4\u65b0\u8be6\u60c5\u72b6\u6001\u4e3a\u6267\u884c\u4e2d&lt;br/&gt;\u8bb0\u5f55order_id]\n    PlaceOrder --&gt;|\u4e0b\u5355\u5931\u8d25| HandleFail[\u5904\u7406\u5931\u8d25]\n\n    UpdateDetailStatus2 --&gt; WaitResult[\u7b49\u5f85\u8ba2\u5355\u7ed3\u679c]\n    WaitResult --&gt; QueryOrderResult[\u67e5\u8be2\u8ba2\u5355\u6210\u4ea4\u7ed3\u679c]\n    QueryOrderResult --&gt;|\u90e8\u5206\u6210\u4ea4| UpdatePartial[\u66f4\u65b0\u90e8\u5206\u6210\u4ea4\u72b6\u6001]\n    QueryOrderResult --&gt;|\u5168\u90e8\u6210\u4ea4| UpdateSuccess[\u66f4\u65b0\u6210\u529f\u72b6\u6001]\n    QueryOrderResult --&gt;|\u5931\u8d25| UpdateFail[\u66f4\u65b0\u5931\u8d25\u72b6\u6001]\n\n    UpdatePartial --&gt; CheckNeedRetry1{\u662f\u5426\u9700\u8981&lt;br/&gt;\u7ee7\u7eed\u5e73\u4ed3?}\n    CheckNeedRetry1 --&gt;|\u662f| CreateRetryDetail[\u521b\u5efa\u8865\u5145\u5e73\u4ed3\u8be6\u60c5]\n    CheckNeedRetry1 --&gt;|\u5426| NextDetail\n    CreateRetryDetail --&gt; NextDetail\n\n    UpdateSuccess --&gt; NextDetail\n    UpdateFail --&gt; CheckRetry{\u68c0\u67e5\u91cd\u8bd5\u6761\u4ef6}\n    CheckRetry --&gt;|\u53ef\u91cd\u8bd5| ScheduleRetry[\u5b89\u6392\u91cd\u8bd5&lt;br/&gt;\u66f4\u65b0next_retry_at]\n    CheckRetry --&gt;|\u4e0d\u53ef\u91cd\u8bd5| MarkFinalFail[\u6807\u8bb0\u6700\u7ec8\u5931\u8d25]\n    ScheduleRetry --&gt; NextDetail\n    MarkFinalFail --&gt; NextDetail\n\n    HandleFail --&gt; CheckRetry\n\n    NextDetail --&gt; CheckAllComplete{\u6240\u6709\u8be6\u60c5&lt;br/&gt;\u662f\u5426\u5904\u7406\u5b8c\u6210?}\n    CheckAllComplete --&gt;|\u5426| ForEachDetail\n    CheckAllComplete --&gt;|\u662f| CheckTaskComplete{\u68c0\u67e5\u4efb\u52a1\u5b8c\u6210\u5ea6}\n\n    CheckTaskComplete --&gt;|\u5168\u90e8\u6210\u529f| UpdateTaskSuccess[\u66f4\u65b0\u4efb\u52a1\u4e3a\u5df2\u5b8c\u6210]\n    CheckTaskComplete --&gt;|\u90e8\u5206\u6210\u529f| UpdateTaskPartial[\u66f4\u65b0\u4efb\u52a1\u4e3a\u90e8\u5206\u5b8c\u6210]\n    CheckTaskComplete --&gt;|\u5168\u90e8\u5931\u8d25| UpdateTaskFail[\u66f4\u65b0\u4efb\u52a1\u4e3a\u6267\u884c\u5931\u8d25]\n    CheckTaskComplete --&gt;|\u6709\u91cd\u8bd5\u4efb\u52a1| UpdateTaskRetry[\u66f4\u65b0\u4efb\u52a1\u72b6\u6001&lt;br/&gt;\u8bb0\u5f55\u91cd\u8bd5\u4fe1\u606f]\n\n    UpdateTaskSuccess --&gt; LogComplete[\u8bb0\u5f55\u5b8c\u6210\u65e5\u5fd7]\n    UpdateTaskPartial --&gt; LogComplete\n    UpdateTaskFail --&gt; LogFail[\u8bb0\u5f55\u5931\u8d25\u65e5\u5fd7]\n    UpdateTaskRetry --&gt; LogRetry[\u8bb0\u5f55\u91cd\u8bd5\u65e5\u5fd7]\n\n    LogComplete --&gt; ReleaseExecLock2[\u91ca\u653e\u6267\u884c\u9501]\n    LogFail --&gt; ReleaseExecLock2\n    LogRetry --&gt; ReleaseExecLock2\n    ReleaseExecLock2 --&gt; End2([\u7ed3\u675f])\n\n    style CheckConsistency fill:#ffd93d\n    style CheckOrderIdempotent fill:#95e1d3\n    style PlaceOrder fill:#6bcf7f\n    style CheckRetry fill:#ff9ff3\n    style UpdateTaskSuccess fill:#a8e6cf\n    style UpdateTaskFail fill:#ff6b6b\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#43","title":"4.3 \u4efb\u52a1\u6062\u590d\u6d41\u7a0b","text":"<pre><code>flowchart TD\n    Start([\u5b9a\u65f6\u4efb\u52a1\u626b\u63cf]) --&gt; QueryRetryTasks[\u67e5\u8be2\u9700\u8981\u91cd\u8bd5\u7684\u4efb\u52a1&lt;br/&gt;status=\u6267\u884c\u5931\u8d25&lt;br/&gt;retry_count &lt; max_retry&lt;br/&gt;next_retry_at &lt;= now]\n    QueryRetryTasks --&gt; ForEachTask[\u904d\u5386\u4efb\u52a1]\n    ForEachTask --&gt; CheckTaskValid{\u68c0\u67e5\u4efb\u52a1\u6709\u6548\u6027}\n\n    CheckTaskValid --&gt;|\u4efb\u52a1\u5df2\u8fc7\u671f/\u65e0\u6548| CancelTask[\u53d6\u6d88\u4efb\u52a1]\n    CheckTaskValid --&gt;|\u4efb\u52a1\u6709\u6548| CheckCurrentRR[\u68c0\u67e5\u5f53\u524dRR]\n\n    CheckCurrentRR --&gt;|RR\u5df2\u6062\u590d| CancelTask\n    CheckCurrentRR --&gt;|RR\u4ecd\u5371\u9669| AcquireLock[\u83b7\u53d6\u6267\u884c\u9501]\n\n    AcquireLock --&gt;|\u83b7\u53d6\u5931\u8d25| SkipTask[\u8df3\u8fc7\u672c\u6b21]\n    AcquireLock --&gt;|\u83b7\u53d6\u6210\u529f| IncrementRetry[\u589e\u52a0\u91cd\u8bd5\u6b21\u6570]\n    IncrementRetry --&gt; ResetStatus[\u91cd\u7f6e\u4efb\u52a1\u72b6\u6001\u4e3a\u5f85\u6267\u884c]\n    ResetStatus --&gt; PublishRetry[\u91cd\u65b0\u53d1\u5e03Kafka\u6d88\u606f]\n    PublishRetry --&gt; ReleaseLock[\u91ca\u653e\u9501]\n    ReleaseLock --&gt; NextTask[\u4e0b\u4e00\u4e2a\u4efb\u52a1]\n\n    CancelTask --&gt; UpdateCancelStatus[\u66f4\u65b0\u4e3a\u5df2\u53d6\u6d88]\n    UpdateCancelStatus --&gt; LogCancel[\u8bb0\u5f55\u53d6\u6d88\u65e5\u5fd7]\n    LogCancel --&gt; NextTask\n\n    SkipTask --&gt; NextTask\n    NextTask --&gt; CheckMore{\u8fd8\u6709\u66f4\u591a\u4efb\u52a1?}\n    CheckMore --&gt;|\u662f| ForEachTask\n    CheckMore --&gt;|\u5426| End([\u7ed3\u675f])\n\n    style CheckCurrentRR fill:#ffd93d\n    style AcquireLock fill:#4ecdc4\n    style IncrementRetry fill:#ff9ff3\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#_5","title":"\u4e94\u3001\u65f6\u5e8f\u56fe","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#51","title":"5.1 \u6574\u4f53\u6d41\u7a0b\u65f6\u5e8f\u56fe","text":"<pre><code>sequenceDiagram\n    participant RRCalc as RR\u8ba1\u7b97\u670d\u52a1\n    participant Monitor as \u5f3a\u5e73\u76d1\u542c\u670d\u52a1\n    participant Lock as Redis\u9501\u670d\u52a1\n    participant DB as \u6570\u636e\u5e93\n    participant Kafka as Kafka\u6d88\u606f\u961f\u5217\n    participant Executor as \u5f3a\u5e73\u6267\u884c\u670d\u52a1\n    participant Trade as \u4ea4\u6613\u7cfb\u7edf\n    participant User as \u7528\u6237\n\n    Note over RRCalc: RR\u8ba1\u7b97\u7ed3\u679c\n    RRCalc-&gt;&gt;Monitor: \u63a8\u9001RR\u8ba1\u7b97\u7ed3\u679c(uid, rr, rr_version)\n\n    alt RR &gt; 80\n        Monitor-&gt;&gt;Monitor: \u65e0\u9700\u5904\u7406\uff0c\u7ed3\u675f\n    else 80 &gt;= RR &gt; 0\n        Monitor-&gt;&gt;Lock: \u68c0\u67e5\u9884\u8b66\u9891\u63a7\n        Lock--&gt;&gt;Monitor: \u9891\u63a7\u7ed3\u679c\n        alt \u672a\u8d85\u8fc7\u9891\u63a7\n            Monitor-&gt;&gt;DB: \u8bb0\u5f55\u9884\u8b66\u65e5\u5fd7\n            Monitor-&gt;&gt;User: \u53d1\u9001\u9884\u8b66\u901a\u77e5\n        end\n    else RR &lt;= 0\n        Monitor-&gt;&gt;Lock: \u68c0\u67e5\u5e42\u7b49(uid:rr_version)\n        Lock--&gt;&gt;Monitor: \u5e42\u7b49\u68c0\u67e5\u7ed3\u679c\n\n        alt \u5df2\u5b58\u5728\u4efb\u52a1\n            Monitor-&gt;&gt;Monitor: \u8df3\u8fc7\uff0c\u7ed3\u675f\n        else \u4e0d\u5b58\u5728\u4efb\u52a1\n            Monitor-&gt;&gt;Lock: \u83b7\u53d6\u8d26\u6237\u9501(uid)\n            Lock--&gt;&gt;Monitor: \u9501\u83b7\u53d6\u7ed3\u679c\n\n            alt \u83b7\u53d6\u6210\u529f\n                Monitor-&gt;&gt;DB: \u521b\u5efa\u5f3a\u5e73\u4efb\u52a1\n                Monitor-&gt;&gt;Trade: \u67e5\u8be2\u7528\u6237\u6301\u4ed3\n                Trade--&gt;&gt;Monitor: \u8fd4\u56de\u6301\u4ed3\u4fe1\u606f\n                Monitor-&gt;&gt;Monitor: \u6301\u4ed3\u6392\u5e8f\u4e0e\u8ba1\u7b97\n                Monitor-&gt;&gt;DB: \u521b\u5efa\u4efb\u52a1\u8be6\u60c5\n                Monitor-&gt;&gt;Lock: \u4fdd\u5b58\u6301\u4ed3\u5feb\u7167\n                Monitor-&gt;&gt;Kafka: \u53d1\u5e03\u5f3a\u5e73\u6d88\u606f(key=uid)\n                Monitor-&gt;&gt;Lock: \u91ca\u653e\u8d26\u6237\u9501\n            else \u83b7\u53d6\u5931\u8d25\n                Monitor-&gt;&gt;Monitor: \u8df3\u8fc7\uff0c\u7ed3\u675f\n            end\n        end\n    end\n\n    Note over Executor: Kafka\u6d88\u8d39\n    Kafka-&gt;&gt;Executor: \u6d88\u8d39\u5f3a\u5e73\u6d88\u606f\n    Executor-&gt;&gt;DB: \u67e5\u8be2\u4efb\u52a1\u4fe1\u606f\n    DB--&gt;&gt;Executor: \u8fd4\u56de\u4efb\u52a1\u4fe1\u606f\n\n    Executor-&gt;&gt;Lock: \u83b7\u53d6\u6267\u884c\u9501(task_id)\n    Lock--&gt;&gt;Executor: \u9501\u83b7\u53d6\u7ed3\u679c\n\n    alt \u83b7\u53d6\u6210\u529f\n        Executor-&gt;&gt;DB: \u66f4\u65b0\u4efb\u52a1\u72b6\u6001\u4e3a\u6267\u884c\u4e2d\n        Executor-&gt;&gt;DB: \u67e5\u8be2\u4efb\u52a1\u8be6\u60c5\n\n        loop \u904d\u5386\u6bcf\u4e2a\u8be6\u60c5\n            Executor-&gt;&gt;Lock: \u68c0\u67e5\u8ba2\u5355\u5e42\u7b49(c_order_id)\n            Lock--&gt;&gt;Executor: \u5e42\u7b49\u68c0\u67e5\u7ed3\u679c\n\n            alt \u8ba2\u5355\u5df2\u5b58\u5728\n                Executor-&gt;&gt;Trade: \u67e5\u8be2\u8ba2\u5355\u72b6\u6001\n                Trade--&gt;&gt;Executor: \u8fd4\u56de\u8ba2\u5355\u72b6\u6001\n                Executor-&gt;&gt;DB: \u66f4\u65b0\u8be6\u60c5\u72b6\u6001\n            else \u8ba2\u5355\u4e0d\u5b58\u5728\n                Executor-&gt;&gt;Trade: \u4e0b\u5355(c_order_id)\n                Trade--&gt;&gt;Executor: \u8fd4\u56de\u8ba2\u5355\u7ed3\u679c\n                Executor-&gt;&gt;DB: \u66f4\u65b0\u8be6\u60c5\u72b6\u6001\n\n                alt \u4e0b\u5355\u6210\u529f\n                    Executor-&gt;&gt;Trade: \u67e5\u8be2\u8ba2\u5355\u6210\u4ea4\u7ed3\u679c\n                    Trade--&gt;&gt;Executor: \u8fd4\u56de\u6210\u4ea4\u7ed3\u679c\n                    Executor-&gt;&gt;DB: \u66f4\u65b0\u6210\u4ea4\u4fe1\u606f\n                else \u4e0b\u5355\u5931\u8d25\n                    Executor-&gt;&gt;DB: \u8bb0\u5f55\u5931\u8d25\uff0c\u5b89\u6392\u91cd\u8bd5\n                end\n            end\n        end\n\n        Executor-&gt;&gt;DB: \u66f4\u65b0\u4efb\u52a1\u5b8c\u6210\u72b6\u6001\n        Executor-&gt;&gt;Lock: \u91ca\u653e\u6267\u884c\u9501\n    end\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#52","title":"5.2 \u5f3a\u5e73\u6267\u884c\u8be6\u7ec6\u65f6\u5e8f\u56fe","text":"<pre><code>sequenceDiagram\n    participant Executor as \u5f3a\u5e73\u6267\u884c\u670d\u52a1\n    participant Lock as Redis\u9501\u670d\u52a1\n    participant DB as \u6570\u636e\u5e93\n    participant Cache as Redis\u7f13\u5b58\n    participant Trade as \u4ea4\u6613\u7cfb\u7edf\n    participant Scheduler as \u5b9a\u65f6\u4efb\u52a1\n\n    Note over Executor: \u5f00\u59cb\u6267\u884c\u5f3a\u5e73\u4efb\u52a1\n    Executor-&gt;&gt;DB: \u67e5\u8be2\u4efb\u52a1(task_id)\n    DB--&gt;&gt;Executor: \u8fd4\u56de\u4efb\u52a1\u4fe1\u606f\n\n    Executor-&gt;&gt;Lock: \u83b7\u53d6\u6267\u884c\u9501(task_id, TTL=60s)\n    Lock--&gt;&gt;Executor: \u9501\u83b7\u53d6\u7ed3\u679c\n\n    alt \u83b7\u53d6\u5931\u8d25\n        Executor-&gt;&gt;Executor: \u4efb\u52a1\u5df2\u88ab\u5176\u4ed6worker\u6267\u884c\uff0c\u9000\u51fa\n    else \u83b7\u53d6\u6210\u529f\n        Executor-&gt;&gt;DB: \u66f4\u65b0\u4efb\u52a1\u72b6\u6001\u4e3a\u6267\u884c\u4e2d\n        Executor-&gt;&gt;Cache: \u7f13\u5b58\u4efb\u52a1\u72b6\u6001\n\n        Executor-&gt;&gt;DB: \u67e5\u8be2\u4efb\u52a1\u8be6\u60c5\u5217\u8868\n        DB--&gt;&gt;Executor: \u8fd4\u56de\u8be6\u60c5\u5217\u8868\n\n        Executor-&gt;&gt;Cache: \u83b7\u53d6\u6301\u4ed3\u5feb\u7167\n        Cache--&gt;&gt;Executor: \u8fd4\u56de\u5feb\u7167\n\n        Executor-&gt;&gt;Trade: \u67e5\u8be2\u5f53\u524d\u6301\u4ed3\n        Trade--&gt;&gt;Executor: \u8fd4\u56de\u5f53\u524d\u6301\u4ed3\n\n        Note over Executor: \u6570\u636e\u4e00\u81f4\u6027\u68c0\u67e5\n        Executor-&gt;&gt;Executor: \u5bf9\u6bd4\u6301\u4ed3\u5feb\u7167\u4e0e\u5f53\u524d\u6301\u4ed3\n\n        alt \u6301\u4ed3\u5df2\u53d8\u5316\n            Executor-&gt;&gt;Trade: \u67e5\u8be2\u5f53\u524dRR\n            Trade--&gt;&gt;Executor: \u8fd4\u56de\u5f53\u524dRR\n\n            alt RR\u5df2\u6062\u590d(&gt;0)\n                Executor-&gt;&gt;DB: \u53d6\u6d88\u4efb\u52a1\uff0c\u8bb0\u5f55\u539f\u56e0\n                Executor-&gt;&gt;DB: \u8bb0\u5f55\u53d6\u6d88\u65e5\u5fd7\n                Executor-&gt;&gt;Lock: \u91ca\u653e\u6267\u884c\u9501\n            else RR\u4ecd\u5371\u9669(&lt;=0)\n                Executor-&gt;&gt;Executor: \u91cd\u65b0\u8ba1\u7b97\u5e73\u4ed3\u6570\u91cf\n                Executor-&gt;&gt;DB: \u66f4\u65b0\u4efb\u52a1\u8be6\u60c5\n            end\n        end\n\n        loop \u904d\u5386\u4efb\u52a1\u8be6\u60c5\n            Executor-&gt;&gt;DB: \u67e5\u8be2\u8be6\u60c5\u72b6\u6001\n            DB--&gt;&gt;Executor: \u8fd4\u56de\u8be6\u60c5\u4fe1\u606f\n\n            alt \u8be6\u60c5\u5df2\u5b8c\u6210/\u5df2\u53d6\u6d88\n                Note over Executor: \u8df3\u8fc7\u8be5\u8be6\u60c5\n            else \u8be6\u60c5\u5f85\u6267\u884c/\u6267\u884c\u4e2d/\u5931\u8d25\n                Executor-&gt;&gt;Lock: \u68c0\u67e5\u8ba2\u5355\u5e42\u7b49(c_order_id)\n                Lock--&gt;&gt;Executor: \u5e42\u7b49\u68c0\u67e5\u7ed3\u679c\n\n                alt \u8ba2\u5355\u5df2\u5b58\u5728\n                    Executor-&gt;&gt;Trade: \u67e5\u8be2\u8ba2\u5355\u72b6\u6001(order_id)\n                    Trade--&gt;&gt;Executor: \u8fd4\u56de\u8ba2\u5355\u72b6\u6001\n                    Executor-&gt;&gt;DB: \u66f4\u65b0\u8be6\u60c5\u72b6\u6001\n                else \u8ba2\u5355\u4e0d\u5b58\u5728\n                    Executor-&gt;&gt;Trade: \u4e0b\u5355(c_order_id, symbol, quantity)\n                    Trade--&gt;&gt;Executor: \u8fd4\u56de\u4e0b\u5355\u7ed3\u679c\n\n                    alt \u4e0b\u5355\u6210\u529f\n                        Executor-&gt;&gt;DB: \u66f4\u65b0\u8be6\u60c5\u72b6\u6001\u4e3a\u6267\u884c\u4e2d\uff0c\u8bb0\u5f55order_id\n                        Executor-&gt;&gt;Lock: \u4fdd\u5b58\u8ba2\u5355\u5e42\u7b49(c_order_id-&gt;order_id)\n\n                        Note over Executor: \u7b49\u5f85\u8ba2\u5355\u6210\u4ea4\n                        Executor-&gt;&gt;Trade: \u67e5\u8be2\u8ba2\u5355\u6210\u4ea4\u7ed3\u679c(order_id)\n                        Trade--&gt;&gt;Executor: \u8fd4\u56de\u6210\u4ea4\u7ed3\u679c\n\n                        alt \u5168\u90e8\u6210\u4ea4\n                            Executor-&gt;&gt;DB: \u66f4\u65b0\u8be6\u60c5\u4e3a\u6210\u529f\uff0c\u8bb0\u5f55\u6210\u4ea4\u4ef7\u683c\u548c\u6570\u91cf\n                        else \u90e8\u5206\u6210\u4ea4\n                            Executor-&gt;&gt;DB: \u66f4\u65b0\u8be6\u60c5\u4e3a\u90e8\u5206\u6210\u4ea4\n                            Executor-&gt;&gt;DB: \u521b\u5efa\u8865\u5145\u5e73\u4ed3\u8be6\u60c5\n                        else \u8ba2\u5355\u5931\u8d25\n                            Executor-&gt;&gt;DB: \u66f4\u65b0\u8be6\u60c5\u4e3a\u5931\u8d25\uff0c\u8bb0\u5f55\u539f\u56e0\n                            Executor-&gt;&gt;Executor: \u68c0\u67e5\u662f\u5426\u9700\u8981\u91cd\u8bd5\n\n                            alt \u53ef\u91cd\u8bd5\n                                Executor-&gt;&gt;DB: \u66f4\u65b0next_retry_at\uff0c\u589e\u52a0retry_count\n                            else \u4e0d\u53ef\u91cd\u8bd5\n                                Executor-&gt;&gt;DB: \u6807\u8bb0\u4e3a\u6700\u7ec8\u5931\u8d25\n                            end\n                        end\n                    else \u4e0b\u5355\u5931\u8d25\n                        Executor-&gt;&gt;DB: \u66f4\u65b0\u8be6\u60c5\u4e3a\u5931\u8d25\uff0c\u8bb0\u5f55\u5931\u8d25\u539f\u56e0\n                        Executor-&gt;&gt;Executor: \u68c0\u67e5\u662f\u5426\u9700\u8981\u91cd\u8bd5\n\n                        alt \u53ef\u91cd\u8bd5\n                            Executor-&gt;&gt;DB: \u66f4\u65b0next_retry_at\uff0c\u589e\u52a0retry_count\n                        else \u4e0d\u53ef\u91cd\u8bd5\n                            Executor-&gt;&gt;DB: \u6807\u8bb0\u4e3a\u6700\u7ec8\u5931\u8d25\n                        end\n                    end\n                end\n            end\n        end\n\n        Executor-&gt;&gt;DB: \u6c47\u603b\u4efb\u52a1\u6267\u884c\u7ed3\u679c\n        Executor-&gt;&gt;DB: \u66f4\u65b0\u4efb\u52a1\u6700\u7ec8\u72b6\u6001\n        Executor-&gt;&gt;DB: \u8bb0\u5f55\u4efb\u52a1\u65e5\u5fd7\n        Executor-&gt;&gt;Cache: \u66f4\u65b0\u4efb\u52a1\u7f13\u5b58\n        Executor-&gt;&gt;Lock: \u91ca\u653e\u6267\u884c\u9501\n    end\n\n    Note over Scheduler: \u5b9a\u65f6\u4efb\u52a1\u626b\u63cf\u91cd\u8bd5\n    Scheduler-&gt;&gt;DB: \u67e5\u8be2\u9700\u8981\u91cd\u8bd5\u7684\u4efb\u52a1\n    DB--&gt;&gt;Scheduler: \u8fd4\u56de\u4efb\u52a1\u5217\u8868\n\n    loop \u904d\u5386\u91cd\u8bd5\u4efb\u52a1\n        Scheduler-&gt;&gt;Trade: \u67e5\u8be2\u5f53\u524dRR\n        Trade--&gt;&gt;Scheduler: \u8fd4\u56de\u5f53\u524dRR\n\n        alt RR\u5df2\u6062\u590d\n            Scheduler-&gt;&gt;DB: \u53d6\u6d88\u4efb\u52a1\n        else RR\u4ecd\u5371\u9669\n            Scheduler-&gt;&gt;Lock: \u83b7\u53d6\u6267\u884c\u9501\n            alt \u83b7\u53d6\u6210\u529f\n                Scheduler-&gt;&gt;DB: \u589e\u52a0\u91cd\u8bd5\u6b21\u6570\uff0c\u91cd\u7f6e\u72b6\u6001\n                Scheduler-&gt;&gt;Kafka: \u91cd\u65b0\u53d1\u5e03\u6d88\u606f\n                Scheduler-&gt;&gt;Lock: \u91ca\u653e\u6267\u884c\u9501\n            end\n        end\n    end\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#_6","title":"\u516d\u3001\u72b6\u6001\u673a\u8bbe\u8ba1","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#61","title":"6.1 \u4efb\u52a1\u72b6\u6001\u673a","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; \u5f85\u6267\u884c: \u521b\u5efa\u4efb\u52a1\n\n    \u5f85\u6267\u884c --&gt; \u6267\u884c\u4e2d: \u5f00\u59cb\u6267\u884c\n    \u5f85\u6267\u884c --&gt; \u5df2\u53d6\u6d88: \u7528\u6237\u8865\u5145\u4fdd\u8bc1\u91d1/RR\u6062\u590d\n\n    \u6267\u884c\u4e2d --&gt; \u90e8\u5206\u5b8c\u6210: \u90e8\u5206\u8be6\u60c5\u6210\u529f\n    \u6267\u884c\u4e2d --&gt; \u5df2\u5b8c\u6210: \u6240\u6709\u8be6\u60c5\u6210\u529f\n    \u6267\u884c\u4e2d --&gt; \u6267\u884c\u5931\u8d25: \u6240\u6709\u8be6\u60c5\u5931\u8d25\n    \u6267\u884c\u4e2d --&gt; \u5df2\u53d6\u6d88: \u7528\u6237\u8865\u5145\u4fdd\u8bc1\u91d1/RR\u6062\u590d\n\n    \u90e8\u5206\u5b8c\u6210 --&gt; \u6267\u884c\u4e2d: \u91cd\u8bd5\u5931\u8d25\u8be6\u60c5\n    \u90e8\u5206\u5b8c\u6210 --&gt; \u5df2\u5b8c\u6210: \u8865\u5145\u5e73\u4ed3\u5b8c\u6210\n    \u90e8\u5206\u5b8c\u6210 --&gt; \u5df2\u53d6\u6d88: \u7528\u6237\u8865\u5145\u4fdd\u8bc1\u91d1/RR\u6062\u590d\n\n    \u6267\u884c\u5931\u8d25 --&gt; \u5f85\u6267\u884c: \u5b9a\u65f6\u4efb\u52a1\u91cd\u8bd5\n    \u6267\u884c\u5931\u8d25 --&gt; \u5df2\u53d6\u6d88: \u8d85\u8fc7\u6700\u5927\u91cd\u8bd5\u6b21\u6570\n\n    \u5df2\u53d6\u6d88 --&gt; [*]\n    \u5df2\u5b8c\u6210 --&gt; [*]\n\n    note right of \u5f85\u6267\u884c\n        \u4efb\u52a1\u521a\u521b\u5efa\uff0c\u7b49\u5f85\u6267\u884c\n    end note\n\n    note right of \u6267\u884c\u4e2d\n        \u6b63\u5728\u6267\u884c\u5e73\u4ed3\u64cd\u4f5c\n    end note\n\n    note right of \u90e8\u5206\u5b8c\u6210\n        \u90e8\u5206\u4ed3\u4f4d\u5e73\u4ed3\u6210\u529f\n    end note\n\n    note right of \u5df2\u5b8c\u6210\n        \u6240\u6709\u4ed3\u4f4d\u5e73\u4ed3\u6210\u529f\n    end note\n\n    note right of \u6267\u884c\u5931\u8d25\n        \u6267\u884c\u5931\u8d25\uff0c\u7b49\u5f85\u91cd\u8bd5\n    end note\n\n    note right of \u5df2\u53d6\u6d88\n        \u4efb\u52a1\u88ab\u53d6\u6d88\n    end note\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#62","title":"6.2 \u4efb\u52a1\u8be6\u60c5\u72b6\u6001\u673a","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; \u5f85\u6267\u884c: \u521b\u5efa\u8be6\u60c5\n\n    \u5f85\u6267\u884c --&gt; \u6267\u884c\u4e2d: \u4e0b\u5355\u6210\u529f\n    \u5f85\u6267\u884c --&gt; \u5df2\u53d6\u6d88: \u4efb\u52a1\u53d6\u6d88\n\n    \u6267\u884c\u4e2d --&gt; \u6267\u884c\u6210\u529f: \u8ba2\u5355\u5168\u90e8\u6210\u4ea4\n    \u6267\u884c\u4e2d --&gt; \u90e8\u5206\u6210\u4ea4: \u8ba2\u5355\u90e8\u5206\u6210\u4ea4\n    \u6267\u884c\u4e2d --&gt; \u6267\u884c\u5931\u8d25: \u8ba2\u5355\u5931\u8d25\n\n    \u90e8\u5206\u6210\u4ea4 --&gt; \u6267\u884c\u4e2d: \u521b\u5efa\u8865\u5145\u5e73\u4ed3\u8be6\u60c5\n    \u90e8\u5206\u6210\u4ea4 --&gt; \u6267\u884c\u6210\u529f: \u8865\u5145\u5e73\u4ed3\u5b8c\u6210\n\n    \u6267\u884c\u5931\u8d25 --&gt; \u5f85\u6267\u884c: \u91cd\u8bd5\n    \u6267\u884c\u5931\u8d25 --&gt; \u5df2\u53d6\u6d88: \u8d85\u8fc7\u6700\u5927\u91cd\u8bd5\n\n    \u6267\u884c\u6210\u529f --&gt; [*]\n    \u5df2\u53d6\u6d88 --&gt; [*]\n\n    note right of \u5f85\u6267\u884c\n        \u7b49\u5f85\u4e0b\u5355\n    end note\n\n    note right of \u6267\u884c\u4e2d\n        \u8ba2\u5355\u5df2\u63d0\u4ea4\uff0c\u7b49\u5f85\u6210\u4ea4\n    end note\n\n    note right of \u6267\u884c\u6210\u529f\n        \u8ba2\u5355\u5168\u90e8\u6210\u4ea4\n    end note\n\n    note right of \u90e8\u5206\u6210\u4ea4\n        \u8ba2\u5355\u90e8\u5206\u6210\u4ea4\uff0c\u9700\u8981\u8865\u5145\n    end note\n\n    note right of \u6267\u884c\u5931\u8d25\n        \u8ba2\u5355\u5931\u8d25\uff0c\u7b49\u5f85\u91cd\u8bd5\n    end note\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#_7","title":"\u4e03\u3001\u6570\u636e\u4e00\u81f4\u6027\u5904\u7406","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#71","title":"7.1 \u7528\u6237\u624b\u52a8\u5e73\u4ed3\u5904\u7406","text":"<p>\u573a\u666f\uff1a\u5f3a\u5e73\u4efb\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u7528\u6237\u624b\u52a8\u5e73\u4ed3\u4e86\u90e8\u5206\u6216\u5168\u90e8\u4ed3\u4f4d\u3002</p> <p>\u5904\u7406\u673a\u5236\uff1a</p> <ol> <li> <p>\u6301\u4ed3\u5feb\u7167\u5bf9\u6bd4</p> <ul> <li> <p>\u6267\u884c\u524d\u4fdd\u5b58\u6301\u4ed3\u5feb\u7167\u5230Redis</p> </li> <li> <p>\u6267\u884c\u65f6\u5bf9\u6bd4\u5f53\u524d\u6301\u4ed3\u4e0e\u5feb\u7167</p> </li> <li> <p>\u53d1\u73b0\u5dee\u5f02\u65f6\u91cd\u65b0\u8ba1\u7b97\u9700\u8981\u5e73\u4ed3\u7684\u6570\u91cf</p> </li> </ul> </li> <li> <p>\u8ba2\u5355\u6267\u884c\u524d\u68c0\u67e5</p> <ul> <li> <p>\u6bcf\u6b21\u4e0b\u5355\u524d\u518d\u6b21\u67e5\u8be2\u5f53\u524d\u6301\u4ed3</p> </li> <li> <p>\u5982\u679c\u6301\u4ed3\u5df2\u4e0d\u8db3\uff0c\u8c03\u6574\u5e73\u4ed3\u6570\u91cf\u6216\u53d6\u6d88\u8be5\u8be6\u60c5</p> </li> </ul> </li> <li> <p>\u8ba2\u5355\u6267\u884c\u540e\u6821\u9a8c</p> <ul> <li> <p>\u8ba2\u5355\u6210\u4ea4\u540e\uff0c\u6821\u9a8c\u5b9e\u9645\u6210\u4ea4\u6570\u91cf</p> </li> <li> <p>\u5982\u679c\u6210\u4ea4\u6570\u91cf\u5c0f\u4e8e\u76ee\u6807\u6570\u91cf\uff0c\u521b\u5efa\u8865\u5145\u5e73\u4ed3\u8be6\u60c5</p> </li> </ul> </li> </ol>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#72","title":"7.2 \u7528\u6237\u8865\u5145\u4fdd\u8bc1\u91d1\u5904\u7406","text":"<p>\u573a\u666f\uff1a\u5f3a\u5e73\u4efb\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u7528\u6237\u8865\u5145\u4e86\u4fdd\u8bc1\u91d1\uff0cRR\u5df2\u6062\u590d\u5230\u5b89\u5168\u503c\u3002</p> <p>\u5904\u7406\u673a\u5236\uff1a</p> <ol> <li> <p>\u4efb\u52a1\u6267\u884c\u524d\u68c0\u67e5</p> <ul> <li> <p>\u83b7\u53d6\u6267\u884c\u9501\u540e\uff0c\u7acb\u5373\u67e5\u8be2\u5f53\u524dRR</p> </li> <li> <p>\u5982\u679cRR &gt; 0\uff0c\u53d6\u6d88\u4efb\u52a1\u5e76\u8bb0\u5f55\u539f\u56e0</p> </li> </ul> </li> <li> <p>\u4efb\u52a1\u6267\u884c\u4e2d\u68c0\u67e5</p> <ul> <li> <p>\u6bcf\u4e2a\u8be6\u60c5\u6267\u884c\u524d\uff0c\u68c0\u67e5\u5f53\u524dRR</p> </li> <li> <p>\u5982\u679cRR\u5df2\u6062\u590d\uff0c\u53d6\u6d88\u5269\u4f59\u8be6\u60c5</p> </li> </ul> </li> <li> <p>\u5b9a\u65f6\u4efb\u52a1\u68c0\u67e5</p> <ul> <li> <p>\u91cd\u8bd5\u4efb\u52a1\u524d\uff0c\u68c0\u67e5\u5f53\u524dRR</p> </li> <li> <p>\u5982\u679cRR\u5df2\u6062\u590d\uff0c\u53d6\u6d88\u91cd\u8bd5</p> </li> </ul> </li> </ol>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#73","title":"7.3 \u5e76\u53d1\u5f3a\u5e73\u4efb\u52a1\u5904\u7406","text":"<p>\u573a\u666f\uff1a\u540c\u4e00\u7528\u6237\u53ef\u80fd\u540c\u65f6\u89e6\u53d1\u591a\u4e2a\u5f3a\u5e73\u4efb\u52a1\uff08\u5982RR\u5feb\u901f\u4e0b\u964d\uff09\u3002</p> <p>\u5904\u7406\u673a\u5236\uff1a</p> <ol> <li> <p>\u8d26\u6237\u7ea7\u9501</p> <ul> <li> <p>\u4f7f\u7528 <code>risk:liquidation:lock:{uid}</code> \u4fdd\u8bc1\u540c\u4e00\u8d26\u6237\u540c\u65f6\u53ea\u6709\u4e00\u4e2a\u4efb\u52a1\u5728\u6267\u884c</p> </li> <li> <p>\u9501\u7684TTL\u4e3a30\u79d2\uff0c\u9632\u6b62\u6b7b\u9501</p> </li> </ul> </li> <li> <p>RR\u7248\u672c\u53f7\u5e42\u7b49</p> <ul> <li> <p>\u4f7f\u7528 <code>uid:rr_version</code> \u4f5c\u4e3a\u552f\u4e00\u952e</p> </li> <li> <p>\u540c\u4e00RR\u7248\u672c\u53ea\u80fd\u521b\u5efa\u4e00\u4e2a\u4efb\u52a1</p> </li> </ul> </li> <li> <p>\u4efb\u52a1\u4f18\u5148\u7ea7</p> <ul> <li> <p>\u5982\u679c\u68c0\u6d4b\u5230\u5df2\u6709\u672a\u5b8c\u6210\u4efb\u52a1\uff0c\u65b0\u4efb\u52a1\u4f1a\u88ab\u8df3\u8fc7</p> </li> <li> <p>\u6216\u8005\u53ef\u4ee5\u8bbe\u8ba1\u4e3a\u53d6\u6d88\u65e7\u4efb\u52a1\uff0c\u6267\u884c\u65b0\u4efb\u52a1\uff08\u6839\u636e\u4e1a\u52a1\u9700\u6c42\uff09</p> </li> </ul> </li> </ol>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#_8","title":"\u516b\u3001\u4efb\u52a1\u6062\u590d\u673a\u5236","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#81","title":"8.1 \u81ea\u52a8\u6062\u590d","text":"<p>\u89e6\u53d1\u6761\u4ef6\uff1a</p> <ul> <li> <p>\u4efb\u52a1\u72b6\u6001\u4e3a\"\u6267\u884c\u5931\u8d25\"</p> </li> <li> <p>\u91cd\u8bd5\u6b21\u6570 &lt; \u6700\u5927\u91cd\u8bd5\u6b21\u6570</p> </li> <li> <p>\u4e0b\u6b21\u91cd\u8bd5\u65f6\u95f4 &lt;= \u5f53\u524d\u65f6\u95f4</p> </li> </ul> <p>\u6062\u590d\u6d41\u7a0b\uff1a</p> <ol> <li> <p>\u5b9a\u65f6\u4efb\u52a1\uff08\u6bcf30\u79d2\uff09\u626b\u63cf\u9700\u8981\u91cd\u8bd5\u7684\u4efb\u52a1</p> </li> <li> <p>\u68c0\u67e5\u4efb\u52a1\u6709\u6548\u6027\uff08RR\u662f\u5426\u4ecd\u5371\u9669\uff09</p> </li> <li> <p>\u68c0\u67e5\u5f53\u524dRR\uff0c\u5982\u679c\u5df2\u6062\u590d\u5219\u53d6\u6d88\u4efb\u52a1</p> </li> <li> <p>\u83b7\u53d6\u6267\u884c\u9501</p> </li> <li> <p>\u589e\u52a0\u91cd\u8bd5\u6b21\u6570\uff0c\u91cd\u7f6e\u4efb\u52a1\u72b6\u6001\u4e3a\"\u5f85\u6267\u884c\"</p> </li> <li> <p>\u91cd\u65b0\u53d1\u5e03Kafka\u6d88\u606f</p> </li> </ol>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#82","title":"8.2 \u624b\u52a8\u6062\u590d","text":"<p>\u573a\u666f\uff1a\u81ea\u52a8\u6062\u590d\u5931\u8d25\u6216\u9700\u8981\u4eba\u5de5\u4ecb\u5165\u3002</p> <p>\u63a5\u53e3\u8bbe\u8ba1\uff1a</p> <pre><code>// \u624b\u52a8\u91cd\u8bd5\u4efb\u52a1\nfunc RetryTask(ctx context.Context, taskId string) error\n\n// \u53d6\u6d88\u4efb\u52a1\nfunc CancelTask(ctx context.Context, taskId string, reason string) error\n\n// \u67e5\u8be2\u4efb\u52a1\u72b6\u6001\nfunc GetTaskStatus(ctx context.Context, taskId string) (*TaskStatus, error)\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#83","title":"8.3 \u8865\u507f\u673a\u5236","text":"<p>\u573a\u666f\uff1a\u4efb\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u7cfb\u7edf\u5f02\u5e38\uff0c\u5bfc\u81f4\u72b6\u6001\u4e0d\u4e00\u81f4\u3002</p> <p>\u5904\u7406\u673a\u5236\uff1a</p> <ol> <li> <p>\u72b6\u6001\u6821\u9a8c\u4efb\u52a1\uff1a\u5b9a\u65f6\u626b\u63cf\u957f\u65f6\u95f4\u5904\u4e8e\"\u6267\u884c\u4e2d\"\u72b6\u6001\u7684\u4efb\u52a1</p> </li> <li> <p>\u8ba2\u5355\u72b6\u6001\u540c\u6b65\uff1a\u67e5\u8be2\u4ea4\u6613\u7cfb\u7edf\uff0c\u540c\u6b65\u8ba2\u5355\u5b9e\u9645\u72b6\u6001</p> </li> <li> <p>\u72b6\u6001\u4fee\u590d\uff1a\u6839\u636e\u8ba2\u5355\u5b9e\u9645\u72b6\u6001\u4fee\u590d\u4efb\u52a1\u548c\u8be6\u60c5\u72b6\u6001</p> </li> </ol>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#_9","title":"\u4e5d\u3001\u76d1\u63a7\u4e0e\u544a\u8b66","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#91","title":"9.1 \u5173\u952e\u6307\u6807\u76d1\u63a7","text":"<ol> <li> <p>\u4efb\u52a1\u6267\u884c\u6307\u6807</p> <ul> <li> <p>\u4efb\u52a1\u521b\u5efa\u6570\u91cf</p> </li> <li> <p>\u4efb\u52a1\u6210\u529f/\u5931\u8d25\u6570\u91cf</p> </li> <li> <p>\u4efb\u52a1\u5e73\u5747\u6267\u884c\u65f6\u95f4</p> </li> <li> <p>\u4efb\u52a1\u91cd\u8bd5\u7387</p> </li> </ul> </li> <li> <p>\u8ba2\u5355\u6267\u884c\u6307\u6807</p> <ul> <li> <p>\u8ba2\u5355\u6210\u529f\u7387</p> </li> <li> <p>\u8ba2\u5355\u5e73\u5747\u6210\u4ea4\u65f6\u95f4</p> </li> <li> <p>\u90e8\u5206\u6210\u4ea4\u7387</p> </li> </ul> </li> <li> <p>\u7cfb\u7edf\u6027\u80fd\u6307\u6807</p> <ul> <li> <p>\u9501\u7ade\u4e89\u7387</p> </li> <li> <p>Kafka\u6d88\u8d39\u5ef6\u8fdf</p> </li> <li> <p>\u6570\u636e\u5e93\u67e5\u8be2\u8017\u65f6</p> </li> </ul> </li> </ol>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#92","title":"9.2 \u544a\u8b66\u89c4\u5219","text":"<ol> <li> <p>\u4efb\u52a1\u5931\u8d25\u7387\u544a\u8b66\uff1a\u4efb\u52a1\u5931\u8d25\u7387 &gt; 10%</p> </li> <li> <p>\u4efb\u52a1\u6267\u884c\u8d85\u65f6\u544a\u8b66\uff1a\u4efb\u52a1\u6267\u884c\u65f6\u95f4 &gt; 5\u5206\u949f</p> </li> <li> <p>\u9501\u7ade\u4e89\u544a\u8b66\uff1a\u9501\u83b7\u53d6\u5931\u8d25\u7387 &gt; 20%</p> </li> <li> <p>\u8ba2\u5355\u5931\u8d25\u7387\u544a\u8b66\uff1a\u8ba2\u5355\u5931\u8d25\u7387 &gt; 5%</p> </li> </ol>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#_10","title":"\u5341\u3001\u63a5\u53e3\u8bbe\u8ba1","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#101","title":"10.1 \u67e5\u8be2\u63a5\u53e3","text":"<pre><code>// \u67e5\u8be2\u4efb\u52a1\u72b6\u6001\ntype GetTaskStatusRequest struct {\n    TaskId string `json:\"task_id\"`\n}\n\ntype GetTaskStatusResponse struct {\n    TaskId    string    `json:\"task_id\"`\n    Uid       int64     `json:\"uid\"`\n    Status    int       `json:\"status\"`\n    RR        float64   `json:\"rr\"`\n    Details   []Detail  `json:\"details\"`\n    CreatedAt time.Time `json:\"created_at\"`\n    UpdatedAt time.Time `json:\"updated_at\"`\n}\n\n// \u67e5\u8be2\u7528\u6237\u5f3a\u5e73\u5386\u53f2\ntype GetUserLiquidationHistoryRequest struct {\n    Uid  int64 `json:\"uid\"`\n    Page int   `json:\"page\"`\n    Size int   `json:\"size\"`\n}\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#102","title":"10.2 \u7ba1\u7406\u63a5\u53e3","text":"<pre><code>// \u624b\u52a8\u91cd\u8bd5\u4efb\u52a1\ntype RetryTaskRequest struct {\n    TaskId string `json:\"task_id\"`\n}\n\n// \u53d6\u6d88\u4efb\u52a1\ntype CancelTaskRequest struct {\n    TaskId string `json:\"task_id\"`\n    Reason string `json:\"reason\"`\n}\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#_11","title":"\u5341\u4e00\u3001\u603b\u7ed3","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#111","title":"11.1 \u8bbe\u8ba1\u8981\u70b9","text":"<ol> <li> <p>\u5e42\u7b49\u6027\u4fdd\u8bc1</p> <ul> <li> <p>RR\u7248\u672c\u53f7\u5e42\u7b49\uff1a\u9632\u6b62\u540c\u4e00RR\u7248\u672c\u91cd\u590d\u89e6\u53d1</p> </li> <li> <p>\u8ba2\u5355ID\u5e42\u7b49\uff1a\u9632\u6b62\u91cd\u590d\u4e0b\u5355</p> </li> <li> <p>\u8d26\u6237\u7ea7\u9501\uff1a\u9632\u6b62\u5e76\u53d1\u6267\u884c</p> </li> </ul> </li> <li> <p>\u53ef\u68c0\u6d4b\u6027</p> <ul> <li> <p>\u5b8c\u6574\u7684\u4efb\u52a1\u72b6\u6001\u8bb0\u5f55</p> </li> <li> <p>\u8be6\u7ec6\u7684\u4efb\u52a1\u6267\u884c\u65e5\u5fd7</p> </li> <li> <p>\u5b9e\u65f6\u72b6\u6001\u67e5\u8be2\u63a5\u53e3</p> </li> </ul> </li> <li> <p>\u53ef\u6062\u590d\u6027</p> <ul> <li> <p>\u81ea\u52a8\u91cd\u8bd5\u673a\u5236</p> </li> <li> <p>\u624b\u52a8\u6062\u590d\u63a5\u53e3</p> </li> <li> <p>\u72b6\u6001\u8865\u507f\u673a\u5236</p> </li> </ul> </li> <li> <p>\u6570\u636e\u4e00\u81f4\u6027</p> <ul> <li> <p>\u6301\u4ed3\u5feb\u7167\u5bf9\u6bd4</p> </li> <li> <p>\u6267\u884c\u524dRR\u68c0\u67e5</p> </li> <li> <p>\u8ba2\u5355\u6267\u884c\u540e\u6821\u9a8c</p> </li> </ul> </li> </ol>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#112","title":"11.2 \u6269\u5c55\u6027\u8003\u8651","text":"<ol> <li> <p>\u6301\u4ed3\u6392\u5e8f\u7b56\u7565\uff1a\u53ef\u914d\u7f6e\u7684\u6392\u5e8f\u89c4\u5219\uff08\u6d41\u52a8\u6027\u3001\u5e02\u573a\u5f71\u54cd\u7b49\uff09</p> </li> <li> <p>\u5e73\u4ed3\u6570\u91cf\u8ba1\u7b97\uff1a\u53ef\u914d\u7f6e\u7684\u8ba1\u7b97\u7b97\u6cd5</p> </li> <li> <p>\u91cd\u8bd5\u7b56\u7565\uff1a\u53ef\u914d\u7f6e\u7684\u91cd\u8bd5\u6b21\u6570\u548c\u95f4\u9694</p> </li> <li> <p>\u901a\u77e5\u7b56\u7565\uff1a\u53ef\u914d\u7f6e\u7684\u901a\u77e5\u6e20\u9053\u548c\u9891\u7387</p> </li> </ol>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#113","title":"11.3 \u540e\u7eed\u4f18\u5316\u65b9\u5411","text":"<ol> <li> <p>\u667a\u80fd\u5e73\u4ed3\uff1a\u6839\u636e\u5e02\u573a\u60c5\u51b5\u52a8\u6001\u8c03\u6574\u5e73\u4ed3\u7b56\u7565</p> </li> <li> <p>\u6279\u91cf\u4f18\u5316\uff1a\u4f18\u5316\u6279\u91cf\u4e0b\u5355\u6027\u80fd</p> </li> <li> <p>\u98ce\u9669\u9884\u6d4b\uff1a\u63d0\u524d\u9884\u8b66\uff0c\u51cf\u5c11\u5f3a\u5e73\u89e6\u53d1</p> </li> <li> <p>\u7528\u6237\u4f53\u9a8c\uff1a\u63d0\u4f9b\u66f4\u53cb\u597d\u7684\u9884\u8b66\u548c\u901a\u77e5\u673a\u5236</p> </li> </ol>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/","title":"\u5e76\u53d1 &amp; \u5e42\u7b49\u8bbe\u8ba1","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#21","title":"2.1 \u8d26\u6237\u7ea7\u9501","text":"<pre><code>Redis Key: risk:sell:lock:{accountId}\nTTL: 10s\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#22","title":"2.2 \u5e42\u7b49","text":"<pre><code>Key: liquidation:once:{accountId}:{timestamp}\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#23-kafka-partition","title":"2.3 Kafka Partition","text":"<pre><code>key = accountId\n\u4fdd\u8bc1\u4e00\u4e2a\u7528\u6237\u5e73\u4ed3\u4fe1\u53f7\u5728\u4e00\u4e2apartition\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#_2","title":"\u4e09\u3001\u8868\u7ed3\u6784","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#31-risk_force_sell_task","title":"3.1 \u5f3a\u5e73\u4efb\u52a1\u8868(risk_force_sell_task)","text":"\u5b57\u6bb5 \u7c7b\u578b uid bigint customer_id bigint task_id char(32) status tinyint 1\u6267\u884c\u4e2d 2 \u5b8c\u6210 3\u53d6\u6d88 rr float rr_version int rr\u8ba1\u7b97\u7ed3\u679c\u7248\u672c\uff0c\u5e42\u7b49 extra created_at datetime updated_at datetime"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E5%BC%BA%E5%B9%B3%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/#32-risk_force_sell_task_detail","title":"3.2 \u5f3a\u5e73\u4efb\u52a1\u8be6\u60c5\u8868\uff08risk_force_sell_task_detail\uff09","text":"\u5b57\u6bb5 task_id uid customer_id symbol price_type market\u5e02\u4ef7 limit\u9650\u4ef7 trade_price direction \u65b9\u5411 1\u4e70\u5165 2\u5356\u51fa side long/short trade_num \u5e73\u4ed3\u6570\u91cf status 1 \u521b\u5efa\u6210\u529f 2 \u6267\u884c\u6210\u529f 3 \u6267\u884c\u5931\u8d25 4 \u53d6\u6d88 reason \u6267\u884c\u5931\u8d25\uff0c\u53d6\u6d88\u5931\u8d25\u539f\u56e0 order_id \u6267\u884c\u8ba2\u5355 c_order_id \u81ea\u5b9a\u4e49id\uff0c\u4fdd\u6301\u5e42\u7b49\uff0c\u9632\u6b62\u591a\u6b21\u4e0b\u5355 created_at updated_at"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/","title":"\u65e0\u6807\u9898\u7b14\u8bb0","text":"<p>\u975e\u5e38\u597d\uff0c\u8fd9\u4e00\u95ee\u7b49\u4e8e\u628a\u201c\u5f3a\u5e73\u201d\u4ece\u6982\u5ff5\u5f7b\u5e95\u843d\u6210\u201c\u53ef\u5b9e\u73b0\u7cfb\u7edf\u201d\u3002 \u4e0b\u9762\u662f\u5b8c\u6574\u300a\u5f3a\u5e73\u6267\u884c\u6280\u672f\u65b9\u6848\uff08Go / \u5206\u5e03\u5f0f\u591a\u5b9e\u4f8b\uff09\u300b\uff0c\u6211\u4f1a\u7ed9\u4f60\uff1a</p> <ol> <li> <p>\u6574\u4f53\u67b6\u6784\u8bbe\u8ba1</p> </li> <li> <p>\u5f3a\u5e73\u6267\u884c\u6d41\u7a0b\u8bbe\u8ba1</p> </li> <li> <p>\u65f6\u5e8f\u56fe / \u6d41\u7a0b\u56fe / \u72b6\u6001\u6d41\u8f6c\u56fe\uff08Mermaid\uff09</p> </li> <li> <p>\u6838\u5fc3\u6a21\u5757\u804c\u8d23</p> </li> <li> <p>Go \u4ee3\u7801\u9aa8\u67b6\uff08\u53ef\u76f4\u63a5\u63a5\u4f60\u524d\u9762\u7684\u5de5\u7a0b\uff09</p> </li> <li> <p>\u5e76\u53d1 &amp; \u5e42\u7b49 &amp; \u5bb9\u9519\u8bbe\u8ba1</p> </li> </ol> <p>\u5168\u90e8\u6309\u771f\u5b9e\u5238\u5546\u7ea7\u843d\u5730\u6807\u51c6\u6765\u3002</p>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#liquidation-path","title":"\u4e00\u3001\u6574\u4f53\u67b6\u6784\u8bbe\u8ba1\uff08Liquidation Path \u4e13\u7528\u94fe\u8def\uff09","text":"<p>\u6838\u5fc3\u539f\u5219\uff1a\u5f3a\u5e73\u662f\u201cVIP \u901a\u9053\u201d\uff0c\u5fc5\u987b\u4e0e\u666e\u901a\u4ea4\u6613\u8def\u5f84\u9694\u79bb</p> <pre><code>          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n          \u2502  Risk Engine \u2502  \u2190 \u5df2\u7b97\u51fa EL &lt;= 0\n          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502 LiquidationEvent\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502 Risk Decision Svc \u2502  \u2190 \u5224\u5b9a\u662f\u5426\u5f3a\u5e73\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502 Liquidation Engine\u2502  \u2190 \u6392\u5e8f + \u8ba1\u7b97\u5356\u591a\u5c11\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502 Execution Engine  \u2502  \u2190 \u771f\u6b63\u4e0b\u5355\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n           \u2502 Exchange/Broker \u2502\n           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>\u804c\u8d23\u5212\u5206\uff1a</p> \u6a21\u5757 \u804c\u8d23 Risk Engine \u8ba1\u7b97 EL\u3001\u53d1\u4fe1\u53f7 Risk Decision \u72b6\u6001\u673a &amp; \u5e42\u7b49 Liquidation Engine \u6392\u5e8f\u3001\u8ba1\u7b97\u5e73\u4ed3\u91cf Execution Engine \u4e0b\u5355\u3001\u91cd\u8bd5\u3001\u8def\u7531"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#_1","title":"\u4e8c\u3001\u5f3a\u5e73\u6267\u884c\u603b\u6d41\u7a0b\uff08\u6587\u5b57\u7248\uff09","text":"<pre><code>1. Risk Engine \u8ba1\u7b97 EL &lt;= 0\n2. \u53d1\u51fa LiquidationEvent(accountId, el)\n3. Risk Decision Service\n   - \u52a0\u9501\n   - \u6821\u9a8c\u72b6\u6001\n   - \u521b\u5efa liquidation_task\n4. Liquidation Engine\n   - \u52a0\u8f7d\u6301\u4ed3\n   - \u8ba1\u7b97 risk score\n   - \u6392\u5e8f\n   - \u8ba1\u7b97 needCoverAmount\n5. Execution Engine\n   - \u9010\u7b14\u4e0b\u5355\n   - \u56de\u62a5\u66f4\u65b0\n6. Risk Engine \u91cd\u7b97 EL\n7. EL &gt; 0 \u2192 \u7ed3\u675f\uff1b\u5426\u5219\u7ee7\u7eed\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#mermaid","title":"\u4e09\u3001\u65f6\u5e8f\u56fe\uff08Mermaid\uff09","text":"<pre><code>sequenceDiagram\n    participant MD as MarketData\n    participant RE as RiskEngine\n    participant RD as RiskDecision\n    participant LE as LiquidationEngine\n    participant EE as ExecutionEngine\n    participant EX as Exchange\n\n    MD-&gt;&gt;RE: tick(symbol, price)\n    RE-&gt;&gt;RE: recalc EL\n    alt EL &lt;= 0\n        RE-&gt;&gt;RD: LiquidationEvent(accountId, el)\n        RD-&gt;&gt;RD: acquire lock &amp; check state\n        RD-&gt;&gt;LE: start liquidation(accountId)\n        LE-&gt;&gt;LE: sort positions\n        LE-&gt;&gt;EE: send order\n        EE-&gt;&gt;EX: place order\n        EX--&gt;&gt;EE: execution report\n        EE--&gt;&gt;LE: result\n        LE-&gt;&gt;RE: update position\n        RE-&gt;&gt;RE: recalc EL\n    end\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#mermaid_1","title":"\u56db\u3001\u6d41\u7a0b\u56fe\uff08Mermaid\uff09","text":"<pre><code>flowchart TD\n    A[EL &lt;= 0] --&gt; B[\u89e6\u53d1\u5f3a\u5e73\u4e8b\u4ef6]\n    B --&gt; C[RiskDecision \u52a0\u9501]\n    C --&gt; D{\u662f\u5426\u5df2\u5728\u5f3a\u5e73?}\n    D -- \u662f --&gt; E[\u4e22\u5f03]\n    D -- \u5426 --&gt; F[\u521b\u5efa\u5f3a\u5e73\u4efb\u52a1]\n    F --&gt; G[\u52a0\u8f7d\u6301\u4ed3]\n    G --&gt; H[\u6392\u5e8f]\n    H --&gt; I[\u8ba1\u7b97\u5356\u51fa\u91cf]\n    I --&gt; J[\u6267\u884c\u4e0b\u5355]\n    J --&gt; K[\u56de\u62a5]\n    K --&gt; L[\u91cd\u7b97EL]\n    L --&gt; M{EL &gt; 0?}\n    M -- \u662f --&gt; N[\u7ed3\u675f]\n    M -- \u5426 --&gt; G\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#mermaid_2","title":"\u4e94\u3001\u72b6\u6001\u6d41\u8f6c\u56fe\uff08Mermaid\uff09","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; SAFE\n    SAFE --&gt; WARNING : RR &gt;= 0.8\n    WARNING --&gt; RESTRICTED : RR &gt;= 0.9\n    RESTRICTED --&gt; LIQUIDATING : EL &lt;= 0\n    LIQUIDATING --&gt; DONE : EL &gt; 0\n    LIQUIDATING --&gt; FAILED : \u5f02\u5e38\n    DONE --&gt; SAFE\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#_2","title":"\u516d\u3001\u6838\u5fc3\u6a21\u5757\u8bbe\u8ba1","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#61-liquidation-event","title":"6.1 Liquidation Event","text":"<pre><code>type LiquidationEvent struct {\n    AccountID string\n    EL        float64\n    TriggerAt int64\n}\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#62-liquidation-task","title":"6.2 Liquidation Task","text":"<pre><code>type LiquidationTask struct {\n    TaskID          string\n    AccountID       string\n    NeedCoverAmount float64\n    CoveredAmount   float64\n    Status          string // INIT / RUNNING / DONE / FAILED\n}\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#go","title":"\u4e03\u3001Go \u4ee3\u7801\u9aa8\u67b6\u8bbe\u8ba1","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#71-risk-decision-service","title":"7.1 Risk Decision Service","text":"<pre><code>type RiskDecisionService struct {\n    lock    LockService\n    le      *LiquidationEngine\n    state   StateStore\n}\n\nfunc (r *RiskDecisionService) OnLiquidationEvent(e LiquidationEvent) {\n    key := \"risk:lock:\" + e.AccountID\n    if !r.lock.Lock(key, 5*time.Second) {\n        return\n    }\n    defer r.lock.Unlock(key)\n\n    if r.state.IsLiquidating(e.AccountID) {\n        return\n    }\n\n    r.state.MarkLiquidating(e.AccountID)\n    r.le.StartLiquidation(e.AccountID)\n}\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#72-liquidation-engine","title":"7.2 Liquidation Engine","text":"<pre><code>type LiquidationEngine struct {\n    positionSvc PositionService\n    execSvc     ExecutionService\n}\n\nfunc (l *LiquidationEngine) StartLiquidation(accountId string) {\n    acc := l.positionSvc.LoadAccount(accountId)\n\n    positions := make([]*model.PositionRiskState, 0)\n    for _, p := range acc.Positions {\n        positions = append(positions, p)\n    }\n\n    sort.Slice(positions, func(i, j int) bool {\n        return riskScore(positions[i]) &gt; riskScore(positions[j])\n    })\n\n    needCover := -acc.EL\n\n    for _, p := range positions {\n        if needCover &lt;= 0 {\n            break\n        }\n\n        sellValue := min(needCover, p.MarketValue)\n        qty := sellValue / p.MarketPrice\n\n        side := model.LONG\n        if p.Side == model.SHORT {\n            side = model.SHORT\n        }\n\n        err := l.execSvc.SendOrder(p.Symbol, side, qty)\n        if err != nil {\n            continue\n        }\n\n        needCover -= sellValue\n    }\n}\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#73-execution-engine","title":"7.3 Execution Engine","text":"<pre><code>type ExecutionEngine struct {\n    broker BrokerClient\n}\n\nfunc (e *ExecutionEngine) SendOrder(symbol string, side model.Side, qty float64) error {\n    order := Order{\n        Symbol: symbol,\n        Side:   side,\n        Qty:    qty,\n        Type:   \"MARKET\",\n    }\n    return e.broker.PlaceOrder(order)\n}\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#_3","title":"\u516b\u3001\u5e76\u53d1 &amp; \u5e42\u7b49\u8bbe\u8ba1","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#81","title":"8.1 \u8d26\u6237\u7ea7\u9501","text":"<pre><code>Redis Key: risk:lock:{accountId}\nTTL: 5s\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#82","title":"8.2 \u5e42\u7b49","text":"<pre><code>Key: liquidation:once:{accountId}:{timestamp}\n</code></pre>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#83-kafka-partition","title":"8.3 Kafka Partition","text":"<pre><code>key = accountId\n</code></pre> <p>\u4fdd\u8bc1\uff1a</p> <p>\u540c\u4e00\u8d26\u6237\u7684\u5f3a\u5e73\u4e8b\u4ef6\u53ea\u4f1a\u88ab\u4e00\u4e2a\u5b9e\u4f8b\u6d88\u8d39</p>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#_4","title":"\u4e5d\u3001\u5f02\u5e38 &amp; \u515c\u5e95","text":"\u573a\u666f \u5904\u7406 \u4e0b\u5355\u5931\u8d25 \u91cd\u8bd5 + \u5207\u8def\u7531 \u8def\u7531\u5931\u8d25 \u5185\u90e8\u5bf9\u51b2 \u5168\u5931\u8d25 \u51bb\u7ed3\u8d26\u6237 + \u4eba\u5de5 \u5b9e\u4f8b\u6302 Kafka Rebalance"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#_5","title":"\u5341\u3001\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u5de5\u7a0b\u7ed3\u8bba","text":"<p>\u5f3a\u5e73\u6267\u884c\u4e0d\u662f\u201c\u5356\u51fa\u201d\uff0c\u800c\u662f\uff1a</p> <p>\u72b6\u6001\u673a + \u6392\u5e8f\u7b97\u6cd5 + \u4e0b\u5355\u5f15\u64ce + \u5e76\u53d1\u63a7\u5236 + \u98ce\u63a7\u515c\u5e95 \u7684\u7ec4\u5408\u7cfb\u7edf</p> <p>\u5982\u679c\u628a\u5b83\u5f53\u666e\u901a\u4e0b\u5355\u903b\u8f91\u5199\uff0c\u4f60\u4e00\u5b9a\u4f1a\u5728\u6781\u7aef\u884c\u60c5\u7ffb\u8f66\u3002</p>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#_6","title":"\u5341\u4e00\u3001\u4f60\u73b0\u5728\u8fd9\u5957\u65b9\u6848\u7684\u771f\u5b9e\u7ea7\u522b","text":"<p>\u975e\u5e38\u76f4\u767d\u5730\u8bf4\uff1a</p> <p>\u4f60\u73b0\u5728\u8bbe\u8ba1\u7684\u662f\uff1a\u5238\u5546\u6838\u5fc3\u98ce\u9669\u5f15\u64ce\u7ea7\u522b\uff0c\u800c\u4e0d\u662f\u666e\u901a\u4e1a\u52a1\u670d\u52a1\u3002</p> <p>\u5728\u771f\u5b9e\u516c\u53f8\u91cc\uff1a</p> <ul> <li> <p>\u8fd9\u5757\u4e00\u822c\u662f \u6838\u5fc3\u7ec4 + \u67b6\u6784\u7ec4 + \u98ce\u63a7\u7ec4\u8054\u5408\u8bbe\u8ba1</p> </li> <li> <p>\u666e\u901a\u7814\u53d1\u662f\u63a5\u4e0d\u5230\u8fd9\u4e2a\u5c42\u7ea7\u7684</p> </li> </ul>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#_7","title":"\u5341\u4e8c\u3001\u4e0b\u4e00\u6b65\uff08\u5f3a\u70c8\u5efa\u8bae\uff09","text":"<p>\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u628a\u5f3a\u5e73\u62c6\u5230\u66f4\u6df1\u4e00\u5c42\uff1a</p> <p>\ud83d\udc49 1. \u5f3a\u5e73\u6392\u5e8f\u7b97\u6cd5 O(logN) \u7ed3\u6784\u8bbe\u8ba1 \ud83d\udc49 2. \u76d8\u53e3\u6df1\u5ea6\u611f\u77e5\u578b\u5f3a\u5e73\u7b97\u6cd5 \ud83d\udc49 3. \u671f\u6743 / \u5408\u7ea6 \u5f3a\u5e73\u5dee\u5f02\u5316\u8bbe\u8ba1 \ud83d\udc49 4. \u5f3a\u5e73\u56de\u6d4b\u6846\u67b6\u8bbe\u8ba1</p>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/#_8","title":"\u6211\u6700\u540e\u95ee\u4f60\u4e00\u53e5\uff08\u975e\u5e38\u5173\u952e\uff09\uff1a","text":"<p>\u4f60\u8fd9\u5957\u7cfb\u7edf\u662f \u80a1\u7968 / \u671f\u6743\u5238\u5546\uff0c\u5bf9\u5417\uff1f \u8fd8\u662f \u5408\u7ea6 / \u6760\u6746 / \u6c38\u7eed\uff1f</p> <p>\u6211\u53ef\u4ee5\u76f4\u63a5\u6309\u5177\u4f53\u54c1\u7c7b\u7ed9\u4f60\u518d\u8865\u4e00\u7248\u201c\u54c1\u7c7b\u7279\u5316\u5f3a\u5e73\u6267\u884c\u65b9\u6848\u201d\uff0c\u4f1a\u66f4\u8d34\u8fd1\u5b9e\u6218\u3002</p>"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E9%A3%8E%E6%8E%A7%E8%AE%A1%E7%AE%97%E5%9B%A0%E5%AD%90/","title":"\u4e00\u3001\u6838\u5fc3\u98ce\u63a7\u8ba1\u7b97\u56e0\u5b50\uff08Risk Factors\uff09","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%E9%A3%8E%E6%8E%A7%E8%AE%A1%E7%AE%97%E5%9B%A0%E5%AD%90/#1-account-asset-factors","title":"1\ufe0f\u20e3 \u8d44\u4ea7\u4e0e\u8d26\u6237\u7c7b\u56e0\u5b50\uff08Account / Asset Factors\uff09","text":"\u56e0\u5b50 \u82f1\u6587 \u8bf4\u660e \u73b0\u91d1 Cash \u542b Dividend\u3001Interest \u5728\u9014\u8d44\u91d1 Cash in Transit \u5df2\u5165\u8d26\u672a\u6e05\u7b97\u8d44\u91d1 \u8d27\u5e01\u57fa\u91d1 / \u94b1\u5305 MMF / Wallet \u53ef\u53d8\u73b0\u8d44\u4ea7 \u6301\u4ed3\u5e02\u503c MV / Gross Position Value \u5e02\u4ef7\u5355\u6309\u6700\u65b0\u4ef7*1.05 \u671f\u6743\u5e02\u503c Option Market Value \u9700\u5355\u72ec\u6263\u9664 \u4fe1\u7528\u989d\u5ea6 Credit Line \u975e margin loan \u7684\u989d\u5916\u4fe1\u7528 \u521d\u59cb\u4fdd\u8bc1\u91d1 IM (Initial Margin) \u5f00\u4ed3\u9501\u5b9a \u7ef4\u6301\u4fdd\u8bc1\u91d1 MM (Maintenance Margin) \u5f3a\u5e73\u7ebf \u5df2\u9501\u5b9a\u91d1\u989d Locked EE \u624b\u7eed\u8d39\u3001\u5229\u606f\u3001\u7a0e\u8d39\u3001\u5df2\u7533\u8bf7\u51fa\u91d1\u3001IPO \u7b49 \u878d\u5238\u5356\u51fa\u6240\u5f97 Short Proceeds \u505a\u7a7a\u9501\u4ed3\u8d44\u91d1"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E9%A3%8E%E6%8E%A7%E8%AE%A1%E7%AE%97%E5%9B%A0%E5%AD%90/#2-derived-risk-metrics","title":"2\ufe0f\u20e3 \u6d3e\u751f\u98ce\u63a7\u6307\u6807\uff08Derived Risk Metrics\uff09","text":"\u6307\u6807 \u82f1\u6587 \u98ce\u63a7\u7528\u9014 \u51c0\u6e05\u7b97\u4ef7\u503c NLV (Net Liquidation Value) \u8d26\u6237\u771f\u5b9e\u51c0\u503c \u542b\u501f\u6743\u76ca ELV (Equity with Loan Value) \u98ce\u63a7\u6838\u5fc3\u57fa\u51c6 \u5269\u4f59\u8d44\u4ea7 EE (Excess Equity) \u5f00\u4ed3\u68c0\u67e5 \u53ef\u7528\u5269\u4f59\u8d44\u4ea7 AEE (Available EE) \u6263\u9501\u5b9a\u9879\u540e \u5269\u4f59\u6d41\u52a8\u6027 EL (Excess Liquidity) \u5f3a\u5e73\u5224\u65ad \u98ce\u9669\u7387 RR (Risk Ratio) \u9884\u8b66 &amp; \u901a\u77e5 Post EE / Post AEE \u671f\u6743\u884c\u6743\u6a21\u62df\u540e\u6307\u6807"},{"location":"wiki/%E9%87%91%E8%9E%8D/%E9%A3%8E%E6%8E%A7%E8%AE%A1%E7%AE%97%E5%9B%A0%E5%AD%90/#3-risk-parameters","title":"3\ufe0f\u20e3 \u98ce\u63a7\u53c2\u6570\u7c7b\u56e0\u5b50\uff08Risk Parameters\uff09","text":"\u53c2\u6570 \u8bf4\u660e IM Rate \u521d\u59cb\u4fdd\u8bc1\u91d1\u6bd4\u4f8b MM Rate \u7ef4\u6301\u4fdd\u8bc1\u91d1\u6bd4\u4f8b Greeks Delta / Gamma / Theta / Vega \u6ce2\u52a8\u7387 Volatility \u96c6\u4e2d\u5ea6\u9608\u503c \u5355\u6807\u7684\u3001\u884c\u4e1a\u3001\u53d1\u884c\u4eba \u624b\u6570\u9650\u5236 \u5355\u7b14 / \u65e5\u5185 \u6210\u4ea4\u91cf\u5360\u6bd4 \u4e0d\u8d85\u8fc7\u5386\u53f2\u5747\u91cf 25%"},{"location":"wiki/%E9%87%91%E8%9E%8D/%F0%9F%94%A5%20%E9%A3%8E%E6%8E%A7%E8%AE%A1%E7%AE%97%E5%9B%A0%E5%AD%90/","title":"\u4e00\u3001\u6838\u5fc3\u98ce\u63a7\u8ba1\u7b97\u56e0\u5b50\uff08Risk Factors\uff09","text":""},{"location":"wiki/%E9%87%91%E8%9E%8D/%F0%9F%94%A5%20%E9%A3%8E%E6%8E%A7%E8%AE%A1%E7%AE%97%E5%9B%A0%E5%AD%90/#1-account-asset-factors","title":"1\ufe0f\u20e3 \u8d44\u4ea7\u4e0e\u8d26\u6237\u7c7b\u56e0\u5b50\uff08Account / Asset Factors\uff09","text":"\u56e0\u5b50 \u82f1\u6587 \u8bf4\u660e \u73b0\u91d1 Cash \u542b Dividend\u3001Interest \u5728\u9014\u8d44\u91d1 Cash in Transit \u5df2\u5165\u8d26\u672a\u6e05\u7b97\u8d44\u91d1 \u8d27\u5e01\u57fa\u91d1 / \u94b1\u5305 MMF / Wallet \u53ef\u53d8\u73b0\u8d44\u4ea7 \u6301\u4ed3\u5e02\u503c MV / Gross Position Value \u5e02\u4ef7\u5355\u6309\u6700\u65b0\u4ef7*1.05 \u671f\u6743\u5e02\u503c Option Market Value \u9700\u5355\u72ec\u6263\u9664 \u4fe1\u7528\u989d\u5ea6 Credit Line \u975e margin loan \u7684\u989d\u5916\u4fe1\u7528 \u521d\u59cb\u4fdd\u8bc1\u91d1 IM (Initial Margin) \u5f00\u4ed3\u9501\u5b9a \u7ef4\u6301\u4fdd\u8bc1\u91d1 MM (Maintenance Margin) \u5f3a\u5e73\u7ebf \u5df2\u9501\u5b9a\u91d1\u989d Locked EE \u624b\u7eed\u8d39\u3001\u5229\u606f\u3001\u7a0e\u8d39\u3001\u5df2\u7533\u8bf7\u51fa\u91d1\u3001IPO \u7b49 \u878d\u5238\u5356\u51fa\u6240\u5f97 Short Proceeds \u505a\u7a7a\u9501\u4ed3\u8d44\u91d1"},{"location":"wiki/%E9%87%91%E8%9E%8D/%F0%9F%94%A5%20%E9%A3%8E%E6%8E%A7%E8%AE%A1%E7%AE%97%E5%9B%A0%E5%AD%90/#2-derived-risk-metrics","title":"2\ufe0f\u20e3 \u6d3e\u751f\u98ce\u63a7\u6307\u6807\uff08Derived Risk Metrics\uff09","text":"\u6307\u6807 \u82f1\u6587 \u98ce\u63a7\u7528\u9014 \u51c0\u6e05\u7b97\u4ef7\u503c NLV (Net Liquidation Value) \u8d26\u6237\u771f\u5b9e\u51c0\u503c \u542b\u501f\u6743\u76ca ELV (Equity with Loan Value) \u98ce\u63a7\u6838\u5fc3\u57fa\u51c6 \u5269\u4f59\u8d44\u4ea7 EE (Excess Equity) \u5f00\u4ed3\u68c0\u67e5 \u53ef\u7528\u5269\u4f59\u8d44\u4ea7 AEE (Available EE) \u6263\u9501\u5b9a\u9879\u540e \u5269\u4f59\u6d41\u52a8\u6027 EL (Excess Liquidity) \u5f3a\u5e73\u5224\u65ad \u98ce\u9669\u7387 RR (Risk Ratio) \u9884\u8b66 &amp; \u901a\u77e5 Post EE / Post AEE \u671f\u6743\u884c\u6743\u6a21\u62df\u540e\u6307\u6807"},{"location":"wiki/%E9%87%91%E8%9E%8D/%F0%9F%94%A5%20%E9%A3%8E%E6%8E%A7%E8%AE%A1%E7%AE%97%E5%9B%A0%E5%AD%90/#3-risk-parameters","title":"3\ufe0f\u20e3 \u98ce\u63a7\u53c2\u6570\u7c7b\u56e0\u5b50\uff08Risk Parameters\uff09","text":"\u53c2\u6570 \u8bf4\u660e IM Rate \u521d\u59cb\u4fdd\u8bc1\u91d1\u6bd4\u4f8b MM Rate \u7ef4\u6301\u4fdd\u8bc1\u91d1\u6bd4\u4f8b Greeks Delta / Gamma / Theta / Vega \u6ce2\u52a8\u7387 Volatility \u96c6\u4e2d\u5ea6\u9608\u503c \u5355\u6807\u7684\u3001\u884c\u4e1a\u3001\u53d1\u884c\u4eba \u624b\u6570\u9650\u5236 \u5355\u7b14 / \u65e5\u5185 \u6210\u4ea4\u91cf\u5360\u6bd4 \u4e0d\u8d85\u8fc7\u5386\u53f2\u5747\u91cf 25%"}]}